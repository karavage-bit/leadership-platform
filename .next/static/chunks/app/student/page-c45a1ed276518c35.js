(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[921],{7052:function(e,s,t){Promise.resolve().then(t.bind(t,5435))},5435:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return ef}});var a=t(8357),l=t(921),i=t(1374),r=t(1808),n=t(609),c=t(840),o=t(8556),d=t(6682),x=t(7384),u=t(8267),m=t(9085),h=t(6520),p=t(4525),f=t(7796),v=t(9596),j=t(7925),g=t(6829),b=t(4020),y=t(8844),w=t(2412),N=t(9235),_=t(8288),C=t(5088),k=t(8235),S=t(340),E=t(2389),I=t(6694),D=t(4615),Z=t(5049);let z={1:"courage",2:"care",3:"community",4:"creation"};function q(e){let{lesson:s,progress:t,world:l,onDoNowClick:r,onScenarioClick:n,onChallengeClick:c,onTextAnchorComplete:d,onMediaComplete:x}=e,m=(null==t?void 0:t.do_now_complete)&&(null==t?void 0:t.text_anchor_complete)&&(null==t?void 0:t.media_complete)&&(null==t?void 0:t.scenario_complete)&&(null==t?void 0:t.challenge_complete),h=[],p=[];return(null==t?void 0:t.do_now_complete)?p.push({type:"do_now",label:"Do Now"}):h.push({type:"do_now",label:"Complete Do Now for today's lesson"}),!(null==t?void 0:t.scenario_complete)&&(null==t?void 0:t.media_complete)?h.push({type:"scenario",label:"Socratic Scenario - Apply your knowledge"}):(null==t?void 0:t.scenario_complete)&&p.push({type:"scenario",label:"Socratic Scenario"}),!(null==t?void 0:t.challenge_complete)&&(null==t?void 0:t.scenario_complete)?h.push({type:"challenge",label:"Real-World Challenge - Prove it in action"}):(null==t?void 0:t.challenge_complete)&&p.push({type:"challenge",label:"Real-World Challenge"}),(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[!(null==t?void 0:t.do_now_complete)&&(0,a.jsxs)(i.E.div,{className:"card p-6 bg-gradient-to-r from-primary-900/40 to-surface-900 border-primary-700/50 relative overflow-hidden",whileHover:{scale:1.01},children:[(0,a.jsx)("div",{className:"absolute top-0 right-0 w-64 h-64 bg-primary-500/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2"}),(0,a.jsx)("div",{className:"relative",children:(0,a.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-primary-400 text-sm font-semibold mb-3",children:[(0,a.jsx)(i.E.div,{animate:{scale:[1,1.2,1]},transition:{duration:2,repeat:1/0},children:(0,a.jsx)(b.Z,{size:18})}),"START HERE — TODAY'S DO NOW"]}),(0,a.jsxs)("h2",{className:"text-xl font-bold text-surface-100 mb-2",children:['"',null==s?void 0:s.compelling_question,'"']}),(0,a.jsx)("p",{className:"text-surface-400 text-sm",children:"5-minute Socratic conversation to prime your brain for today's skill."})]}),(0,a.jsxs)(i.E.button,{onClick:r,className:"px-4 py-2 bg-primary-600 hover:bg-primary-500 text-white rounded-xl font-medium flex items-center gap-2 whitespace-nowrap",whileHover:{scale:1.05},whileTap:{scale:.95},children:["Begin ",(0,a.jsx)(y.Z,{size:18})]})]})})]}),(0,a.jsxs)("div",{className:"card p-6 phase-".concat(null==s?void 0:s.phase_id),children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center bg-".concat(z[null==s?void 0:s.phase_id],"/20"),children:(0,a.jsx)(w.Z,{className:"text-".concat(z[null==s?void 0:s.phase_id]),size:24})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"inline-block px-2 py-0.5 rounded-full text-xs font-medium bg-".concat(z[null==s?void 0:s.phase_id],"/20 text-").concat(z[null==s?void 0:s.phase_id]),children:["Lesson ",null==s?void 0:s.id," of 45"]}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-surface-100 mt-1",children:null==s?void 0:s.skill_name})]})]}),(0,a.jsx)("p",{className:"text-surface-400",children:null==s?void 0:s.lesson_objective})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-surface-200 flex items-center gap-2",children:[(0,a.jsx)(N.Z,{size:20,className:"text-primary-400"}),"Your Pathway"]}),(0,a.jsx)(T,{icon:b.Z,title:"Do Now",subtitle:"Warm up your brain",complete:(null==t?void 0:t.do_now_complete)||!1,locked:!1,reward:"\uD83C\uDF38 Flower",onClick:r}),(0,a.jsx)(T,{icon:_.Z,title:(null==s?void 0:s.text_anchor_title)||"Text Anchor",subtitle:"Read ".concat((null==s?void 0:s.text_anchor_chapter)||"Chapter"),complete:(null==t?void 0:t.text_anchor_complete)||!1,locked:!(null==t?void 0:t.do_now_complete),reward:"\uD83E\uDEA8 Stone",onClick:d}),(0,a.jsx)(T,{icon:C.Z,title:(null==s?void 0:s.media_title)||"Media",subtitle:"Watch & reflect",complete:(null==t?void 0:t.media_complete)||!1,locked:!(null==t?void 0:t.text_anchor_complete),reward:"\uD83E\uDEA8 Stone",onClick:x,mediaUrl:null==s?void 0:s.media_url}),(0,a.jsx)(T,{icon:k.Z,title:"Socratic Scenario",subtitle:"Apply your knowledge",complete:(null==t?void 0:t.scenario_complete)||!1,locked:!(null==t?void 0:t.media_complete),reward:"\uD83C\uDF32 Tree",onClick:n}),(0,a.jsx)(T,{icon:S.Z,title:"Real-World Challenge",subtitle:"Prove it in action",complete:(null==t?void 0:t.challenge_complete)||!1,locked:!(null==t?void 0:t.scenario_complete),reward:"\uD83C\uDFDB️ Tower",onClick:c})]}),m&&(0,a.jsxs)(i.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"card p-8 text-center bg-gradient-to-br from-green-900/30 to-surface-900 border-green-500/30",children:[(0,a.jsx)("div",{className:"flex justify-center mb-4",children:(0,a.jsx)(E.Z,{className:"w-16 h-16 text-green-400"})}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-white mb-2",children:"Great! You are all caught up!"}),(0,a.jsx)("p",{className:"text-surface-400 mb-6",children:"You've completed all tasks for this lesson. Here's what you can do next:"}),(0,a.jsxs)("div",{className:"grid gap-3",children:[(0,a.jsxs)(Z.default,{href:"#",className:"flex items-center gap-3 p-4 bg-surface-800/50 rounded-xl hover:bg-surface-700/50 transition-colors text-left",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-lg bg-purple-500/20 flex items-center justify-center",children:(0,a.jsx)(f.Z,{className:"text-purple-400",size:20})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-white",children:"Create your own challenge"}),(0,a.jsx)("p",{className:"text-sm text-surface-500",children:"Design a leadership challenge for classmates"})]})]}),(0,a.jsxs)(Z.default,{href:"#",className:"flex items-center gap-3 p-4 bg-surface-800/50 rounded-xl hover:bg-surface-700/50 transition-colors text-left",onClick:()=>window.dispatchEvent(new CustomEvent("switchTab",{detail:"world"})),children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-lg bg-primary-500/20 flex items-center justify-center",children:(0,a.jsx)(o.Z,{className:"text-primary-400",size:20})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-white",children:"Explore your world"}),(0,a.jsx)("p",{className:"text-sm text-surface-500",children:"Build and customize your leadership world"})]})]}),(0,a.jsxs)(Z.default,{href:"#",className:"flex items-center gap-3 p-4 bg-surface-800/50 rounded-xl hover:bg-surface-700/50 transition-colors text-left",onClick:()=>window.dispatchEvent(new CustomEvent("switchTab",{detail:"commons"})),children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-lg bg-care/20 flex items-center justify-center",children:(0,a.jsx)(u.Z,{className:"text-care",size:20})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-white",children:"Check help requests"}),(0,a.jsx)("p",{className:"text-sm text-surface-500",children:"Help classmates with their challenges"})]})]})]})]}),h.length>0&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-surface-200 flex items-center gap-2",children:[(0,a.jsx)(k.Z,{size:20,className:"text-primary-400"}),"Active Tasks"]}),h.map(e=>(0,a.jsxs)(i.E.button,{onClick:()=>{"do_now"===e.type?r():"scenario"===e.type?n():"challenge"===e.type&&c()},className:"w-full p-4 rounded-xl border bg-primary-900/20 border-primary-500/30 flex items-center gap-4 transition-all text-left hover:border-primary-400",whileHover:{scale:1.01},whileTap:{scale:.99},children:[(0,a.jsxs)("div",{className:"w-10 h-10 rounded-lg bg-primary-500/20 text-primary-400 flex items-center justify-center",children:["do_now"===e.type&&(0,a.jsx)(b.Z,{size:20}),"scenario"===e.type&&(0,a.jsx)(k.Z,{size:20}),"challenge"===e.type&&(0,a.jsx)(S.Z,{size:20})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h4",{className:"font-medium text-white",children:e.label}),(0,a.jsx)("p",{className:"text-xs text-surface-500",children:"Click to start"})]}),(0,a.jsx)(y.Z,{size:18,className:"text-primary-400"})]},e.type))]}),p.length>0&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-surface-500 flex items-center gap-2",children:[(0,a.jsx)(I.Z,{size:20}),"Completed"]}),p.map(e=>(0,a.jsxs)("div",{className:"w-full p-4 rounded-xl border bg-surface-800/30 border-surface-700/50 flex items-center gap-4 opacity-60",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-lg bg-green-500/20 text-green-400 flex items-center justify-center",children:(0,a.jsx)(I.Z,{size:20})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h4",{className:"font-medium text-surface-400 line-through",children:e.label}),(0,a.jsx)("p",{className:"text-xs text-surface-600",children:"Completed"})]}),(0,a.jsx)("span",{className:"px-2 py-1 bg-green-500/20 text-green-400 text-xs rounded-full",children:"Done"})]},e.type))]}),(0,a.jsxs)("div",{className:"card p-4",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-surface-300 mb-3",children:"Today's Progress"}),(0,a.jsxs)("div",{className:"grid grid-cols-5 gap-2 text-center",children:[(0,a.jsx)(L,{label:"Trees",value:(null==l?void 0:l.trees)||0,icon:"tree"}),(0,a.jsx)(L,{label:"Flowers",value:(null==l?void 0:l.flowers)||0,icon:"flower"}),(0,a.jsx)(L,{label:"Stones",value:(null==l?void 0:l.stones)||0,icon:"stone"}),(0,a.jsx)(L,{label:"Tower",value:(null==l?void 0:l.tower)||0,icon:"tower"}),(0,a.jsx)(L,{label:"Helped",value:(null==l?void 0:l.help_given)||0,icon:"help"})]})]})]},"home")}function T(e){let{icon:s,title:t,subtitle:l,complete:r,locked:n,reward:c,onClick:o,mediaUrl:d}=e;return(0,a.jsxs)(i.E.button,{onClick:()=>{if(!r&&!n){if(d){window.open(d,"_blank"),o();return}o()}},disabled:n,className:"w-full p-4 rounded-xl border flex items-center gap-4 transition-all text-left ".concat(r?"bg-green-500/10 border-green-500/30":n?"bg-surface-800/50 border-surface-700 opacity-50 cursor-not-allowed":"bg-surface-800/50 border-surface-700 hover:border-primary-500/50 hover:bg-surface-800"),whileHover:n||r?{}:{scale:1.01},whileTap:n||r?{}:{scale:.99},children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center ".concat(r?"bg-green-500/20 text-green-400":n?"bg-surface-700 text-surface-500":"bg-primary-500/20 text-primary-400"),children:r?(0,a.jsx)(I.Z,{size:20}):n?(0,a.jsx)(D.Z,{size:20}):(0,a.jsx)(s,{size:20})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h4",{className:"font-medium ".concat(r?"text-green-400":"text-surface-200"),children:t}),(0,a.jsx)("p",{className:"text-xs text-surface-500",children:l})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("span",{className:"text-lg",children:c.split(" ")[0]}),(0,a.jsx)("p",{className:"text-xs text-surface-500",children:c.split(" ")[1]})]}),!r&&!n&&(0,a.jsx)(y.Z,{size:18,className:"text-surface-500"})]})}function L(e){let{label:s,value:t,icon:l}=e;return(0,a.jsxs)("div",{className:"p-2 bg-surface-800/50 rounded-lg",children:[(0,a.jsx)("div",{className:"flex justify-center mb-1",children:(()=>{switch(l){case"tree":return(0,a.jsx)("svg",{className:"w-6 h-6 text-green-400",fill:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{d:"M12 2L4 12h4v8h8v-8h4L12 2z"})});case"flower":return(0,a.jsxs)("svg",{className:"w-6 h-6 text-pink-400",fill:"currentColor",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{cx:"12",cy:"12",r:"3"}),(0,a.jsx)("circle",{cx:"12",cy:"6",r:"2"}),(0,a.jsx)("circle",{cx:"18",cy:"12",r:"2"}),(0,a.jsx)("circle",{cx:"12",cy:"18",r:"2"}),(0,a.jsx)("circle",{cx:"6",cy:"12",r:"2"})]});case"stone":return(0,a.jsx)("svg",{className:"w-6 h-6 text-gray-400",fill:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("ellipse",{cx:"12",cy:"14",rx:"8",ry:"6"})});case"tower":return(0,a.jsx)("svg",{className:"w-6 h-6 text-yellow-400",fill:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{d:"M12 2L8 8h2v6H8v6h8v-6h-2V8h2L12 2z"})});case"help":return(0,a.jsx)(u.Z,{className:"w-6 h-6 text-blue-400"});default:return null}})()}),(0,a.jsx)("div",{className:"text-lg font-bold text-white",children:t}),(0,a.jsx)("div",{className:"text-xs text-surface-500",children:s})]})}var P=t(4307),O=t(4428),A=t(2113),H=t(9045),B=t(795),F=t(9496),M=t(1701),R=t(2294);let W=(0,v.default)(()=>Promise.all([t.e(375),t.e(356),t.e(601),t.e(737)]).then(t.bind(t,1737)),{loadableGenerated:{webpack:()=>[1737]},ssr:!1,loading:()=>(0,a.jsx)("div",{className:"w-full aspect-video bg-surface-900 rounded-2xl flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-surface-400 animate-pulse",children:"Loading 3D World..."})})});function G(e){let{world:s,userName:t,placedItems:l,inventoryItems:r,discoveredSecrets:n,onItemPlace:c,onBrainstormOpen:o}=e,d=((null==s?void 0:s.trees)||0)+((null==s?void 0:s.flowers)||0)+((null==s?void 0:s.tower)||0)+((null==s?void 0:s.bridge)||0);return(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(W,{world:s,userName:t,placedItems:l,discoveredSecrets:n,inventoryItems:r,onItemPlace:c,onOpenBrainstorm:o}),(0,a.jsxs)("div",{className:"absolute top-4 left-4 bg-black/60 backdrop-blur-sm rounded-lg px-3 py-2 text-xs text-white",children:[(0,a.jsxs)("div",{className:"font-semibold mb-1",children:[t,"'s World"]}),(0,a.jsxs)("div",{className:"text-surface-300",children:[d," items placed"]})]}),(0,a.jsxs)("div",{className:"absolute bottom-4 right-4 bg-black/60 backdrop-blur-sm rounded-lg px-3 py-2 text-xs text-surface-300",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 mb-1",children:[(0,a.jsx)(P.Z,{size:12}),(0,a.jsx)("span",{children:"Controls"})]}),(0,a.jsx)("div",{children:"WASD - Move"}),(0,a.jsx)("div",{children:"P - Place items"}),(0,a.jsx)("div",{children:"E - Interact"}),(0,a.jsx)("div",{children:"B - Brainstorm"})]})]}),r.length>0&&(0,a.jsxs)(i.E.div,{className:"card p-4 border-yellow-500/30 bg-gradient-to-r from-yellow-900/20 to-surface-900",initial:{opacity:0,y:10},animate:{opacity:1,y:0},children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("h3",{className:"text-sm font-semibold text-yellow-400 flex items-center gap-2",children:[(0,a.jsx)(O.Z,{size:16}),"Items Ready to Place"]}),(0,a.jsx)("div",{className:"text-xs text-surface-400",children:"Press P in world to build"})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:r.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 bg-surface-800 rounded-lg",children:[(0,a.jsxs)("span",{className:"text-lg",children:["tree"===e.type&&"\uD83C\uDF32","flower"===e.type&&"\uD83C\uDF38","tower"===e.type&&"\uD83C\uDFDB️","crystal"===e.type&&"\uD83D\uDC8E","stone"===e.type&&"\uD83E\uDEA8"]}),(0,a.jsxs)("span",{className:"font-bold text-white",children:["\xd7",e.count]})]},s))})]}),0===r.length&&(0,a.jsxs)("div",{className:"card p-4 border-dashed border-surface-600 text-center",children:[(0,a.jsx)(A.Z,{size:24,className:"mx-auto mb-2 text-surface-500"}),(0,a.jsx)("p",{className:"text-surface-400 text-sm",children:"Complete activities to earn building items!"}),(0,a.jsx)("p",{className:"text-surface-500 text-xs mt-1",children:"Do Nows → Flowers | Scenarios → Trees | Challenges → Towers"})]}),(0,a.jsxs)("div",{className:"card p-4",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-surface-300 mb-3",children:"Your Resources"}),(0,a.jsxs)("div",{className:"grid grid-cols-5 gap-3",children:[(0,a.jsx)(J,{icon:H.Z,count:(null==s?void 0:s.trees)||0,label:"Trees",color:"text-green-400",bgColor:"bg-green-500/20"}),(0,a.jsx)(J,{icon:B.Z,count:(null==s?void 0:s.flowers)||0,label:"Flowers",color:"text-pink-400",bgColor:"bg-pink-500/20"}),(0,a.jsx)(J,{icon:F.Z,count:(null==s?void 0:s.tower)||0,label:"Tower",color:"text-blue-400",bgColor:"bg-blue-500/20"}),(0,a.jsx)(J,{icon:M.Z,count:(null==s?void 0:s.bridge)||0,label:"Bridge",color:"text-purple-400",bgColor:"bg-purple-500/20"}),(0,a.jsx)(J,{icon:R.Z,count:(null==s?void 0:s.crystals)||0,label:"Crystals",color:"text-cyan-400",bgColor:"bg-cyan-500/20"})]})]}),(0,a.jsxs)("div",{className:"card p-4",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-surface-300 mb-3",children:"Journey Progress"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(Y,{label:"Self-Leadership",progress:(null==s?void 0:s.phase1_progress)||0,color:"bg-courage"}),(0,a.jsx)(Y,{label:"Team Leadership",progress:(null==s?void 0:s.phase2_progress)||0,color:"bg-care"}),(0,a.jsx)(Y,{label:"Community Leadership",progress:(null==s?void 0:s.phase3_progress)||0,color:"bg-community"}),(0,a.jsx)(Y,{label:"Legacy Leadership",progress:(null==s?void 0:s.phase4_progress)||0,color:"bg-creation"})]})]}),n.length>0&&(0,a.jsxs)("div",{className:"card p-4",children:[(0,a.jsxs)("h3",{className:"text-sm font-semibold text-surface-300 mb-3",children:["\uD83D\uDD2E Secrets Discovered (",n.length,")"]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:n.map((e,s)=>(0,a.jsx)("span",{className:"px-2 py-1 bg-purple-500/20 text-purple-300 rounded-full text-xs",children:e},s))})]})]},"world")}function J(e){let{icon:s,count:t,label:l,color:i,bgColor:r}=e;return(0,a.jsxs)("div",{className:"text-center p-3 bg-surface-800/50 rounded-xl",children:[(0,a.jsx)("div",{className:"w-10 h-10 mx-auto mb-2 rounded-lg ".concat(r," flex items-center justify-center"),children:(0,a.jsx)(s,{className:i,size:20})}),(0,a.jsx)("div",{className:"text-xl font-bold text-white",children:t}),(0,a.jsx)("div",{className:"text-xs text-surface-500",children:l})]})}function Y(e){let{label:s,progress:t,color:l}=e;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,a.jsx)("span",{className:"text-surface-400",children:s}),(0,a.jsxs)("span",{className:"text-surface-300 font-medium",children:[t,"%"]})]}),(0,a.jsx)("div",{className:"h-2 bg-surface-800 rounded-full overflow-hidden",children:(0,a.jsx)(i.E.div,{className:"h-full ".concat(l," rounded-full"),initial:{width:0},animate:{width:"".concat(t,"%")},transition:{duration:.5,ease:"easeOut"}})})]})}var U=t(5698),V=t(9701),X=t(732),K=t(3836);let Q={academic:_.Z,technical:U.Z,creative:f.Z,personal:V.Z,other:P.Z},$={academic:"text-blue-400 bg-blue-500/20",technical:"text-green-400 bg-green-500/20",creative:"text-purple-400 bg-purple-500/20",personal:"text-pink-400 bg-pink-500/20",other:"text-gray-400 bg-gray-500/20"};function ee(e){let{helpRequests:s,userId:t,classId:n,onRefresh:c}=e,[o,d]=(0,l.useState)(!1),x=(0,j.e)(),m=async e=>{await x.from("help_requests").update({helper_id:t,status:"in_progress"}).eq("id",e),t&&(await x.rpc("increment_help_given",{p_student_id:t}),await x.rpc("increment_bridge",{p_student_id:t})),c()};return(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[(0,a.jsx)(u.Z,{className:"text-purple-400"}),"The Commons"]}),(0,a.jsx)("p",{className:"text-sm text-surface-400",children:"Help others, grow together"})]}),(0,a.jsxs)(i.E.button,{onClick:()=>d(!0),className:"px-4 py-2 bg-primary-600 hover:bg-primary-500 text-white rounded-xl font-medium flex items-center gap-2",whileHover:{scale:1.05},whileTap:{scale:.95},children:[(0,a.jsx)(X.Z,{size:18}),"Ask for Help"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,a.jsxs)("div",{className:"card p-3 text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-white",children:s.length}),(0,a.jsx)("div",{className:"text-xs text-surface-400",children:"Open Requests"})]}),(0,a.jsxs)("div",{className:"card p-3 text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-pink-400",children:"0"}),(0,a.jsx)("div",{className:"text-xs text-surface-400",children:"You've Helped"})]}),(0,a.jsxs)("div",{className:"card p-3 text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-purple-400",children:"0"}),(0,a.jsx)("div",{className:"text-xs text-surface-400",children:"Helped You"})]})]}),(0,a.jsx)("div",{className:"space-y-3",children:0===s.length?(0,a.jsxs)("div",{className:"card p-8 text-center",children:[(0,a.jsx)(V.Z,{className:"mx-auto mb-3 text-surface-500",size:40}),(0,a.jsx)("h3",{className:"font-semibold text-surface-300 mb-1",children:"No open requests"}),(0,a.jsx)("p",{className:"text-sm text-surface-500",children:"When classmates need help, their requests will appear here."})]}):s.map(e=>{let s=Q[e.category]||P.Z,t=$[e.category]||$.other;return(0,a.jsx)(i.E.div,{className:"card p-4",initial:{opacity:0,y:10},animate:{opacity:1,y:0},children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"p-2 rounded-lg ".concat(t),children:(0,a.jsx)(s,{size:20})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsxs)("span",{className:"text-sm font-medium text-surface-300",children:["\uD83C\uDFAD ",e.anonymous_name]}),(0,a.jsxs)("span",{className:"text-xs text-surface-500",children:[(0,a.jsx)(p.Z,{size:12,className:"inline mr-1"}),new Date(e.created_at).toLocaleDateString()]})]}),(0,a.jsx)("h4",{className:"font-semibold text-white mb-1",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-surface-400",children:e.description})]}),(0,a.jsxs)(i.E.button,{onClick:()=>m(e.id),className:"px-3 py-2 bg-pink-500/20 hover:bg-pink-500/30 text-pink-400 rounded-lg text-sm font-medium flex items-center gap-1",whileHover:{scale:1.05},whileTap:{scale:.95},children:[(0,a.jsx)(V.Z,{size:14}),"Help"]})]})},e.id)})}),(0,a.jsx)(r.M,{children:o&&(0,a.jsx)(es,{userId:t,classId:n,onClose:()=>d(!1),onSuccess:()=>{d(!1),c()}})})]},"commons")}function es(e){let{userId:s,classId:t,onClose:r,onSuccess:n}=e,[c,o]=(0,l.useState)(""),[d,x]=(0,l.useState)(""),[u,m]=(0,l.useState)("academic"),[h,p]=(0,l.useState)(!1),v=(0,j.e)(),g=async e=>{e.preventDefault(),p(!0);let a=["Swift","Bright","Calm","Noble","Wise","Kind","Bold","Gentle"],l=["Phoenix","Eagle","Oak","River","Star","Mountain","Wave","Wind"],i="".concat(a[Math.floor(Math.random()*a.length)]," ").concat(l[Math.floor(Math.random()*l.length)]);await v.from("help_requests").insert({requester_id:s,class_id:t,title:c,description:d,category:u,anonymous_name:i}),p(!1),n()},b=[{id:"academic",label:"Academic",icon:_.Z},{id:"technical",label:"Technical",icon:U.Z},{id:"creative",label:"Creative",icon:f.Z},{id:"personal",label:"Personal",icon:V.Z},{id:"other",label:"Other",icon:P.Z}];return(0,a.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)(i.E.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-surface-900 rounded-2xl w-full max-w-md",children:[(0,a.jsxs)("div",{className:"p-4 border-b border-surface-800 flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"font-semibold text-white",children:"Ask for Help"}),(0,a.jsx)("button",{onClick:r,className:"text-surface-400 hover:text-white",children:(0,a.jsx)(K.Z,{size:20})})]}),(0,a.jsxs)("form",{onSubmit:g,className:"p-4 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-surface-300 mb-1",children:"What do you need help with?"}),(0,a.jsx)("input",{type:"text",value:c,onChange:e=>o(e.target.value),placeholder:"Brief title...",className:"w-full bg-surface-800 border border-surface-700 rounded-xl px-4 py-2 text-white placeholder:text-surface-500 focus:border-primary-500 outline-none",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-surface-300 mb-1",children:"Category"}),(0,a.jsx)("div",{className:"grid grid-cols-5 gap-2",children:b.map(e=>(0,a.jsxs)("button",{type:"button",onClick:()=>m(e.id),className:"p-2 rounded-lg flex flex-col items-center gap-1 transition-colors ".concat(u===e.id?"bg-primary-500/20 border border-primary-500":"bg-surface-800 border border-transparent hover:border-surface-600"),children:[(0,a.jsx)(e.icon,{size:18,className:u===e.id?"text-primary-400":"text-surface-400"}),(0,a.jsx)("span",{className:"text-xs",children:e.label})]},e.id))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-surface-300 mb-1",children:"Details"}),(0,a.jsx)("textarea",{value:d,onChange:e=>x(e.target.value),placeholder:"Describe what you're struggling with...",className:"w-full h-24 bg-surface-800 border border-surface-700 rounded-xl px-4 py-2 text-white placeholder:text-surface-500 focus:border-primary-500 outline-none resize-none",required:!0})]}),(0,a.jsx)("div",{className:"bg-surface-800/50 rounded-lg p-3 text-sm text-surface-400",children:"\uD83D\uDCA1 Your request will be posted anonymously. Someone who can help will reach out!"}),(0,a.jsx)("button",{type:"submit",disabled:h||!c||!d,className:"w-full py-3 bg-primary-600 hover:bg-primary-500 disabled:bg-surface-700 text-white rounded-xl font-medium transition-colors",children:h?"Posting...":"Post Request"})]})]})})}let et=(0,v.default)(()=>t.e(917).then(t.bind(t,7917)),{loadableGenerated:{webpack:()=>[7917]},ssr:!1}),ea=(0,v.default)(()=>t.e(322).then(t.bind(t,5322)),{loadableGenerated:{webpack:()=>[5322]},ssr:!1});function el(e){let{teacherChallenges:s,discoveries:t,userId:l,classId:r,onChallengeSubmit:n,onDiscoveryPost:c,onDiscoveryVote:o}=e;return(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[(0,a.jsx)(m.Z,{className:"text-yellow-400"}),"Discover"]}),(0,a.jsx)("p",{className:"text-sm text-surface-400",children:"Teacher challenges & student discoveries"})]}),(0,a.jsx)(et,{challenges:s,onSubmitResponse:n}),(0,a.jsx)(ea,{discoveries:t,onPost:c,onVote:o,onComment:()=>{}})]},"discover")}var ei=t(2926);let er=(0,v.default)(()=>t.e(846).then(t.bind(t,1846)),{loadableGenerated:{webpack:()=>[1846]},ssr:!1}),en=(0,v.default)(()=>t.e(631).then(t.bind(t,2631)),{loadableGenerated:{webpack:()=>[2631]},ssr:!1});function ec(e){let{world:s,currentLesson:t,journalData:r,connectionMapData:n,userId:c}=e,[o,d]=(0,l.useState)("overview");return"journal"===o?(0,a.jsxs)(i.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},children:[(0,a.jsx)("button",{onClick:()=>d("overview"),className:"mb-4 text-sm text-primary-400 hover:text-primary-300 flex items-center gap-1",children:"← Back to Progress"}),(0,a.jsx)(er,{weeks:(null==r?void 0:r.weeks)||[],totalDaysActive:(null==r?void 0:r.totalDaysActive)||0,longestStreak:(null==r?void 0:r.longestStreak)||0,totalRipples:(null==r?void 0:r.totalRipples)||0,skillsLearned:(null==r?void 0:r.skillsLearned)||[]})]},"journal"):"connections"===o?(0,a.jsxs)(i.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},children:[(0,a.jsx)("button",{onClick:()=>d("overview"),className:"mb-4 text-sm text-primary-400 hover:text-primary-300 flex items-center gap-1",children:"← Back to Progress"}),(0,a.jsx)(en,{students:(null==n?void 0:n.students)||[],connections:(null==n?void 0:n.connections)||[],currentUserId:c||"",classStats:(null==n?void 0:n.stats)||{totalConnections:0,totalRipples:0,averageHelpPerStudent:0}})]},"connections"):(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[(0,a.jsx)(h.Z,{className:"text-yellow-400"}),"Your Progress"]}),(0,a.jsx)("p",{className:"text-sm text-surface-400",children:"Track your leadership journey"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{className:"card p-4 text-center",children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-white",children:t}),(0,a.jsx)("div",{className:"text-sm text-surface-400",children:"Lessons Complete"})]}),(0,a.jsxs)("div",{className:"card p-4 text-center",children:[(0,a.jsxs)("div",{className:"text-3xl font-bold text-primary-400",children:[Math.round((t-1)/45*100),"%"]}),(0,a.jsx)("div",{className:"text-sm text-surface-400",children:"Journey Progress"})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(eo,{phase:1,name:"Self-Leadership",description:"Understanding yourself as a leader",progress:(null==s?void 0:s.phase1_progress)||0,lessons:"1-12",color:"courage",currentLesson:t}),(0,a.jsx)(eo,{phase:2,name:"Team Leadership",description:"Leading and collaborating with others",progress:(null==s?void 0:s.phase2_progress)||0,lessons:"13-24",color:"care",currentLesson:t}),(0,a.jsx)(eo,{phase:3,name:"Community Leadership",description:"Making impact beyond your circle",progress:(null==s?void 0:s.phase3_progress)||0,lessons:"25-36",color:"community",currentLesson:t}),(0,a.jsx)(eo,{phase:4,name:"Legacy Leadership",description:"Creating lasting change",progress:(null==s?void 0:s.phase4_progress)||0,lessons:"37-45",color:"creation",currentLesson:t})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-surface-300",children:"Deep Dive"}),(0,a.jsxs)("button",{onClick:()=>d("journal"),className:"w-full card p-4 flex items-center justify-between hover:border-primary-500/50 transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-lg bg-purple-500/20 flex items-center justify-center",children:(0,a.jsx)(_.Z,{className:"text-purple-400",size:20})}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("h4",{className:"font-medium text-white",children:"Growth Journal"}),(0,a.jsx)("p",{className:"text-xs text-surface-400",children:"Your complete journey timeline"})]})]}),(0,a.jsx)(y.Z,{className:"text-surface-500",size:20})]}),(0,a.jsxs)("button",{onClick:()=>d("connections"),className:"w-full card p-4 flex items-center justify-between hover:border-primary-500/50 transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-lg bg-cyan-500/20 flex items-center justify-center",children:(0,a.jsx)(ei.Z,{className:"text-cyan-400",size:20})}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("h4",{className:"font-medium text-white",children:"Class Connections"}),(0,a.jsx)("p",{className:"text-xs text-surface-400",children:"See how the class is connected"})]})]}),(0,a.jsx)(y.Z,{className:"text-surface-500",size:20})]})]})]},"progress")}function eo(e){let{phase:s,name:t,description:l,progress:r,lessons:n,color:c,currentLesson:o}=e,d=n.split("-").map(Number),x=o>=d[0]&&o<=d[1],u=o<d[0];return(0,a.jsxs)("div",{className:"card p-4 ".concat(x?"border-".concat(c,"/50"):""," ").concat(u?"opacity-50":""),children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-lg bg-".concat(c,"/20 flex items-center justify-center text-lg font-bold text-").concat(c),children:s}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h3",{className:"font-semibold text-white",children:t}),r>=100&&(0,a.jsx)("span",{className:"text-green-400",children:"✓"}),x&&(0,a.jsx)("span",{className:"text-xs px-2 py-0.5 bg-primary-500/20 text-primary-400 rounded-full",children:"Current"})]}),(0,a.jsx)("p",{className:"text-xs text-surface-400",children:l})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"text-lg font-bold text-white",children:[r,"%"]}),(0,a.jsxs)("div",{className:"text-xs text-surface-500",children:["Lessons ",n]})]})]}),(0,a.jsx)("div",{className:"h-2 bg-surface-800 rounded-full overflow-hidden",children:(0,a.jsx)(i.E.div,{className:"h-full bg-".concat(c," rounded-full"),initial:{width:0},animate:{width:"".concat(r,"%")},transition:{duration:.5}})})]})}let ed=(0,v.default)(()=>t.e(171).then(t.bind(t,9171)),{loadableGenerated:{webpack:()=>[9171]},ssr:!1}),ex=(0,v.default)(()=>t.e(674).then(t.bind(t,7674)),{loadableGenerated:{webpack:()=>[7674]},ssr:!1}),eu=(0,v.default)(()=>t.e(178).then(t.bind(t,178)),{loadableGenerated:{webpack:()=>[178]},ssr:!1}),em=(0,v.default)(()=>t.e(999).then(t.bind(t,999)),{loadableGenerated:{webpack:()=>[999]},ssr:!1}),eh=(0,v.default)(()=>t.e(481).then(t.bind(t,9481)),{loadableGenerated:{webpack:()=>[9481]},ssr:!1}),ep={1:"Self-Leadership",2:"Team Leadership",3:"Community Leadership",4:"Legacy Leadership"};function ef(){var e,s;let{user:t,lesson:v,progress:b,world:y,helpRequests:w,teacherChallenges:N,discoveries:_,journalData:C,connectionMapData:k,placedItems:S,inventoryItems:E,discoveredSecrets:I,gatewayComplete:D,dailyUnmaskData:Z,studentSkills:z,loading:T,isOnline:L,error:P,loadData:O,handleLogout:A,refreshHelpRequests:H,markTextAnchorComplete:B,markMediaComplete:F,updateWorld:M,updateProgress:R}=function(){let e=(0,g.useRouter)(),s=(0,j.e)(),[t,a]=(0,l.useState)(null),[i,r]=(0,l.useState)(null),[n,c]=(0,l.useState)(null),[o,d]=(0,l.useState)(null),[x,u]=(0,l.useState)([]),[m,h]=(0,l.useState)([]),[p,f]=(0,l.useState)([]),[v,b]=(0,l.useState)([]),[y,w]=(0,l.useState)(null),[N,_]=(0,l.useState)(null),[C,k]=(0,l.useState)([]),[S,E]=(0,l.useState)([]),[I,D]=(0,l.useState)([]),[Z,z]=(0,l.useState)(!1),[q,T]=(0,l.useState)(null),[L,P]=(0,l.useState)([]),[O,A]=(0,l.useState)(!0),[H,B]=(0,l.useState)(!0),[F,M]=(0,l.useState)(null);(0,l.useEffect)(()=>{let e=()=>B(!0),s=()=>B(!1);return window.addEventListener("online",e),window.addEventListener("offline",s),B(navigator.onLine),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",s)}},[]);let R=(0,l.useCallback)(async(e,s)=>{try{let t=await fetch("/api/challenges/teacher?classId=".concat(e,"&studentId=").concat(s));if(!t.ok)throw Error("Failed to load challenges");let a=await t.json();f(a.challenges||[])}catch(e){console.error("Error loading teacher challenges:",e)}},[]),W=(0,l.useCallback)(async(e,s)=>{try{let t=s?"/api/discoveries?classId=".concat(e,"&studentId=").concat(s):"/api/discoveries?classId=".concat(e),a=await fetch(t);if(!a.ok)throw Error("Failed to load discoveries");let l=await a.json();b(l.discoveries||[])}catch(e){console.error("Error loading discoveries:",e)}},[]),G=(0,l.useCallback)(async e=>{try{let s=await fetch("/api/journal?studentId=".concat(e));if(!s.ok)throw Error("Failed to load journal");let t=await s.json();w(t),P(t.skillsLearned||[])}catch(e){console.error("Error loading journal:",e)}},[]),J=(0,l.useCallback)(async e=>{try{let{data:t}=await s.from("placement_inventory").select("item_type, quantity").eq("student_id",e).gt("quantity",0);t&&E(t.map(e=>({type:e.item_type,count:e.quantity})))}catch(e){console.error("Error loading inventory:",e)}},[s]),Y=(0,l.useCallback)(async e=>{try{let{data:t}=await s.from("world_placements").select("*").eq("student_id",e);t&&k(t.map(e=>({id:e.id,type:e.item_type,variant:e.item_variant||0,x:e.pos_x,y:e.pos_y,z:e.pos_z,rotation:e.rotation_y||0,memory:e.earned_description,earnedFrom:e.earned_from})))}catch(e){console.error("Error loading placed items:",e)}},[s]),U=(0,l.useCallback)(async e=>{try{let{data:t}=await s.from("discovered_secrets").select("secret_name").eq("student_id",e);t&&D(t.map(e=>e.secret_name))}catch(e){console.error("Error loading secrets:",e)}},[s]),V=(0,l.useCallback)(async(e,t)=>{try{let{data:t}=await s.from("users").select("id, name, anonymous_name, is_unmasked").eq("class_id",e).eq("role","student"),{data:a}=await s.from("world_states").select("student_id, help_given").in("student_id",(null==t?void 0:t.map(e=>e.id))||[]),l=(null==t?void 0:t.map(e=>{let s=null==a?void 0:a.find(s=>s.student_id===e.id);return{id:e.id,name:e.name,anonymousName:e.anonymous_name||"Anonymous",isUnmasked:e.is_unmasked||!1,ripplesStarted:0,helpGiven:(null==s?void 0:s.help_given)||0,tier:1}}))||[],{data:i}=await s.from("help_requests").select("requester_id, helper_id").eq("class_id",e).eq("status","completed"),r=(null==i?void 0:i.map(e=>({from:e.helper_id,to:e.requester_id,strength:1,type:"help"})))||[];_({students:l,connections:r,stats:{totalConnections:r.length,totalRipples:0,averageHelpPerStudent:l.length>0?l.reduce((e,s)=>e+s.helpGiven,0)/l.length:0}})}catch(e){console.error("Error loading connection map:",e)}},[s]),X=(0,l.useCallback)(async()=>{M(null);try{let{data:{user:t}}=await s.auth.getUser();if(t){let{data:a}=await s.from("teachers").select("id").eq("auth_user_id",t.id).single();if(a){e.push("/teacher");return}}let l=localStorage.getItem("leadership_user_id"),i=localStorage.getItem("leadership_user_name"),n=localStorage.getItem("leadership_class_id"),o=l,x=null;if(l&&i&&n){let{data:t}=await s.from("users").select("*").eq("id",l).single();if(t)x=t,o=t.id;else{localStorage.removeItem("leadership_user_id"),localStorage.removeItem("leadership_user_name"),localStorage.removeItem("leadership_class_id"),e.push("/");return}}else{let{data:{user:t}}=await s.auth.getUser();if(!t){e.push("/");return}let{data:a}=await s.from("users").select("*").eq("id",t.id).single();if(!a||"student"!==a.role){e.push("/");return}x=a,o=a.id,localStorage.setItem("leadership_user_id",a.id),localStorage.setItem("leadership_user_name",a.name),localStorage.setItem("leadership_class_id",a.class_id)}a(x),z((null==x?void 0:x.gateway_complete)||!1);let{data:m}=await s.from("classes").select("current_lesson_id").eq("id",x.class_id).single(),p=(null==m?void 0:m.current_lesson_id)||1,{data:f}=await s.from("lessons").select("*").eq("id",p).single();r(f);let{data:v}=await s.from("student_lessons").select("*").eq("student_id",o).eq("lesson_id",p).single();if(!v){let{data:e}=await s.from("student_lessons").insert({student_id:o,lesson_id:p,class_id:x.class_id,status:"available"}).select().single();v=e}c(v);let{data:j}=await s.from("world_states").select("*").eq("student_id",o).single();if(!j){let{data:e}=await s.from("world_states").insert({student_id:o}).select().single();j=e}d(j);let{data:g}=await s.from("help_requests").select("*").eq("class_id",x.class_id).eq("status","open").order("created_at",{ascending:!1}).limit(10);u(g||[]);let{data:b}=await s.from("civic_events").select("*").eq("class_id",x.class_id).order("created_at",{ascending:!1}).limit(10);h(b||[]),await Promise.all([R(x.class_id,o),W(x.class_id,o),G(o),V(x.class_id,o),J(o),Y(o),U(o)])}catch(e){console.error("Error loading data:",e),M("Failed to load data. Please refresh.")}finally{A(!1)}},[e,s,R,W,G,V,J,Y,U]),K=(0,l.useCallback)(async()=>{localStorage.removeItem("leadership_user_id"),localStorage.removeItem("leadership_user_name"),localStorage.removeItem("leadership_class_id"),localStorage.removeItem("leadership_draft_conversation"),await s.auth.signOut(),e.push("/")},[e,s]),Q=(0,l.useCallback)(async()=>{if(!t)return;let{data:e}=await s.from("help_requests").select("*").eq("class_id",t.class_id).eq("status","open").order("created_at",{ascending:!1}).limit(10);u(e||[])},[t,s]),$=(0,l.useCallback)(async()=>{t&&await W(t.class_id,t.id)},[t,W]),ee=(0,l.useCallback)(async()=>{n&&t&&i&&(await s.from("student_lessons").update({text_anchor_complete:!0,text_anchor_at:new Date().toISOString(),status:"in_progress"}).eq("student_id",t.id).eq("lesson_id",i.id),await s.from("world_states").update({stones:((null==o?void 0:o.stones)||0)+1,updated_at:new Date().toISOString()}).eq("student_id",t.id),c({...n,text_anchor_complete:!0,status:"in_progress"}),d(e=>e?{...e,stones:(e.stones||0)+1}:null))},[n,t,i,o,s]),es=(0,l.useCallback)(async()=>{n&&t&&i&&(await s.from("student_lessons").update({media_complete:!0,media_at:new Date().toISOString()}).eq("student_id",t.id).eq("lesson_id",i.id),await s.from("world_states").update({stones:((null==o?void 0:o.stones)||0)+1,updated_at:new Date().toISOString()}).eq("student_id",t.id),c({...n,media_complete:!0}),d(e=>e?{...e,stones:(e.stones||0)+1}:null))},[n,t,i,o,s]),et=(0,l.useCallback)(e=>{d(s=>s?{...s,...e}:null)},[]),ea=(0,l.useCallback)(e=>{c(s=>s?{...s,...e}:null)},[]);return(0,l.useEffect)(()=>{X()},[X]),{user:t,lesson:i,progress:n,world:o,helpRequests:x,civicEvents:m,teacherChallenges:p,discoveries:v,journalData:y,connectionMapData:N,placedItems:C,inventoryItems:S,discoveredSecrets:I,gatewayComplete:Z,dailyUnmaskData:q,studentSkills:L,loading:O,isOnline:H,error:F,loadData:X,handleLogout:K,refreshHelpRequests:Q,refreshDiscoveries:$,markTextAnchorComplete:ee,markMediaComplete:es,updateWorld:et,updateProgress:ea}}(),[W,J]=(0,l.useState)("home"),[Y,U]=(0,l.useState)(!1);l.useEffect(()=>{"true"===localStorage.getItem("leadership_show_welcome")&&(null==t?void 0:t.name)&&(U(!0),localStorage.removeItem("leadership_show_welcome"))},[t]);let[V,X]=(0,l.useState)(!1),[K,Q]=(0,l.useState)(!1),[$,es]=(0,l.useState)(!1),[et,ea]=(0,l.useState)(!1),[ei,er]=(0,l.useState)(!1),[en,eo]=(0,l.useState)(!1),[ef,ej]=(0,l.useState)(!1),eg=async e=>{if(null==t?void 0:t.id)try{(await fetch("/api/inventory",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:t.id,itemType:e,earnedFrom:"lesson_completion",earnedDescription:"Completed ".concat((null==v?void 0:v.skill_name)||"activity")})})).ok&&O()}catch(e){console.error("Failed to add inventory:",e)}},eb=async()=>{R({do_now_complete:!0,status:"in_progress"}),M({flowers:((null==y?void 0:y.flowers)||0)+1}),await eg("flower"),X(!1)},ey=async()=>{R({scenario_complete:!0}),M({trees:((null==y?void 0:y.trees)||0)+1}),await eg("tree"),es(!1),ea(!0)},ew=((null==y?void 0:y.trees)||0)+((null==y?void 0:y.flowers)||0)+((null==y?void 0:y.tower)||0)+((null==y?void 0:y.bridge)||0);return T?(0,a.jsx)("div",{className:"min-h-screen bg-surface-950 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(i.E.div,{className:"text-6xl mb-6",animate:{scale:[1,1.2,1],rotate:[0,10,-10,0]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"},children:"\uD83C\uDF31"}),(0,a.jsxs)("div",{className:"loading-dots justify-center mb-4",children:[(0,a.jsx)("span",{}),(0,a.jsx)("span",{}),(0,a.jsx)("span",{})]}),(0,a.jsx)("p",{className:"text-surface-400 gradient-text font-medium",children:"Loading your journey..."})]})}):P?(0,a.jsx)("div",{className:"min-h-screen bg-surface-950 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"card p-8 max-w-md text-center",children:[(0,a.jsx)("div",{className:"text-4xl mb-4",children:"⚠️"}),(0,a.jsx)("h2",{className:"text-xl font-bold text-white mb-2",children:"Something went wrong"}),(0,a.jsx)("p",{className:"text-surface-400 mb-4",children:P}),(0,a.jsx)("button",{onClick:O,className:"px-6 py-2 bg-primary-600 hover:bg-primary-500 text-white rounded-xl",children:"Try Again"})]})}):(0,a.jsxs)("div",{className:"min-h-screen bg-surface-950",children:[(0,a.jsx)("header",{className:"sticky top-0 z-40 glass-card rounded-none border-t-0 border-x-0",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-3 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(i.E.div,{className:"text-3xl",animate:{rotate:[0,10,-10,0]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:"\uD83C\uDF31"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"font-bold text-surface-100 text-lg",children:"Leadership 2.0"}),(0,a.jsxs)("p",{className:"text-xs text-surface-500",children:["Phase ",null==v?void 0:v.phase_id,": ",ep[null==v?void 0:v.phase_id]]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1.5 px-2.5 py-1.5 rounded-lg text-xs font-medium ".concat(L?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"),children:[L?(0,a.jsx)(n.Z,{size:14}):(0,a.jsx)(c.Z,{size:14}),L?"Online":"Offline"]}),(0,a.jsxs)("div",{className:"streak-counter text-xs",children:[(0,a.jsx)(o.Z,{size:14,className:"streak-fire"}),(0,a.jsx)("span",{className:"font-bold",children:ew})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-primary-500 to-purple-500 flex items-center justify-center text-white font-bold text-sm",children:null==t?void 0:null===(s=t.name)||void 0===s?void 0:null===(e=s[0])||void 0===e?void 0:e.toUpperCase()}),(0,a.jsx)("span",{className:"text-sm font-medium text-surface-200 hidden sm:block",children:null==t?void 0:t.name})]}),(0,a.jsx)("button",{onClick:A,className:"p-2 text-surface-400 hover:text-surface-200 rounded-lg hover:bg-surface-800 transition-colors",children:(0,a.jsx)(d.Z,{size:18})})]})]})}),(0,a.jsx)("main",{className:"max-w-6xl mx-auto px-4 py-6 pb-24",children:(0,a.jsxs)(r.M,{mode:"wait",children:["home"===W&&(0,a.jsx)(q,{lesson:v,progress:b,world:y,onDoNowClick:()=>X(!0),onScenarioClick:()=>es(!0),onChallengeClick:()=>ea(!0),onTextAnchorComplete:B,onMediaComplete:F}),"world"===W&&(0,a.jsx)(G,{world:y,userName:(null==t?void 0:t.name)||"Student",placedItems:S,inventoryItems:E,discoveredSecrets:I,onBrainstormOpen:()=>eo(!0)}),"commons"===W&&(0,a.jsx)(ee,{helpRequests:w,userId:null==t?void 0:t.id,classId:null==t?void 0:t.class_id,onRefresh:H}),"discover"===W&&(0,a.jsx)(el,{teacherChallenges:N,discoveries:_,userId:null==t?void 0:t.id,classId:null==t?void 0:t.class_id,onChallengeSubmit:async(e,s,a,l)=>{await fetch("/api/challenges/teacher/response",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({challengeId:e,studentId:null==t?void 0:t.id,classId:null==t?void 0:t.class_id,responseText:s,personalConnection:a,shareWithClass:l})}),O()},onDiscoveryPost:async e=>{await fetch("/api/discoveries",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:null==t?void 0:t.id,classId:null==t?void 0:t.class_id,...e})}),O()},onDiscoveryVote:async e=>{await fetch("/api/discoveries",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({discoveryId:e,studentId:null==t?void 0:t.id,action:"vote"})}),O()}}),"progress"===W&&(0,a.jsx)(ec,{world:y,currentLesson:(null==v?void 0:v.id)||1,journalData:C,connectionMapData:k,userId:null==t?void 0:t.id})]})}),(0,a.jsx)("nav",{className:"fixed bottom-0 left-0 right-0 bg-surface-900/95 backdrop-blur-md border-t border-surface-800 z-50",children:(0,a.jsx)("div",{className:"max-w-6xl mx-auto px-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-around py-2",children:[(0,a.jsx)(ev,{icon:x.Z,label:"Home",active:"home"===W,onClick:()=>J("home")}),(0,a.jsx)(ev,{icon:o.Z,label:"World",active:"world"===W,onClick:()=>J("world")}),(0,a.jsx)(ev,{icon:u.Z,label:"Commons",active:"commons"===W,onClick:()=>J("commons"),badge:w.length}),(0,a.jsx)(ev,{icon:m.Z,label:"Discover",active:"discover"===W,onClick:()=>J("discover")}),(0,a.jsx)(ev,{icon:h.Z,label:"Progress",active:"progress"===W,onClick:()=>J("progress")})]})})}),(0,a.jsxs)(i.E.button,{onClick:()=>Q(!0),className:"fixed bottom-20 right-4 px-4 py-2 bg-surface-800 hover:bg-surface-700 text-white rounded-xl shadow-lg z-40 flex items-center gap-2",whileHover:{scale:1.05},whileTap:{scale:.95},children:[(0,a.jsx)(p.Z,{size:16}),"Exit Ticket"]}),(0,a.jsx)(i.E.button,{onClick:()=>eo(!0),className:"fixed bottom-20 left-4 p-3 bg-purple-600 hover:bg-purple-500 text-white rounded-full shadow-lg z-40",whileHover:{scale:1.1},whileTap:{scale:.95},title:"Brainstorm Ideas",children:(0,a.jsx)(f.Z,{size:20})}),(0,a.jsxs)(r.M,{children:[V&&(0,a.jsx)(ed,{type:"do_now",lesson:v,userId:null==t?void 0:t.id,classId:null==t?void 0:t.class_id,userName:null==t?void 0:t.name,onClose:()=>X(!1),onComplete:eb}),$&&(0,a.jsx)(ed,{type:"scenario",lesson:v,userId:null==t?void 0:t.id,classId:null==t?void 0:t.class_id,userName:null==t?void 0:t.name,onClose:()=>es(!1),onScenarioComplete:ey}),K&&(0,a.jsx)(ed,{type:"exit_ticket",lesson:v,userId:null==t?void 0:t.id,classId:null==t?void 0:t.class_id,userName:null==t?void 0:t.name,onClose:()=>Q(!1)}),et&&(0,a.jsx)(ex,{lesson:v,userId:null==t?void 0:t.id,classId:null==t?void 0:t.class_id,onClose:()=>{ea(!1),O()}})]}),ei&&(0,a.jsx)(eu,{onComplete:async e=>{await fetch("/api/gateway",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:null==t?void 0:t.id,...e})}),er(!1),O()}}),ef&&Z&&(0,a.jsx)(em,{anonymousName:Z.anonymousName,realName:Z.realName,reason:Z.reason,rippleCount:Z.rippleCount,onContinue:()=>ej(!1)}),(0,a.jsx)(eh,{isOpen:en,onClose:()=>eo(!1),studentSkills:z,onActionPlan:e=>{console.log("Action plan committed:",e),eo(!1)}}),(0,a.jsx)(r.M,{children:Y&&(0,a.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>U(!1),children:(0,a.jsxs)(i.E.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},className:"bg-gradient-to-br from-surface-800 to-surface-900 rounded-2xl p-8 max-w-md text-center border border-surface-700 shadow-2xl",onClick:e=>e.stopPropagation(),children:[(0,a.jsx)(i.E.div,{className:"text-6xl mb-4",animate:{scale:[1,1.2,1],rotate:[0,10,-10,0]},transition:{duration:1.5,repeat:2},children:(0,a.jsx)(o.Z,{className:"w-16 h-16 mx-auto text-primary-400"})}),(0,a.jsxs)("h2",{className:"text-3xl font-bold text-white mb-2",children:["Hello ",null==t?void 0:t.name,"!"]}),(0,a.jsx)("p",{className:"text-xl text-primary-400 mb-6",children:"Welcome back!"}),(0,a.jsx)("p",{className:"text-surface-400 mb-6",children:"Ready to continue your leadership journey?"}),(0,a.jsx)(i.E.button,{onClick:()=>U(!1),className:"px-8 py-3 bg-primary-600 hover:bg-primary-500 text-white rounded-xl font-semibold",whileHover:{scale:1.05},whileTap:{scale:.95},children:"Let's Go!"})]})})})]})}function ev(e){let{icon:s,label:t,active:l,onClick:i,badge:r}=e;return(0,a.jsxs)("button",{onClick:i,className:"flex flex-col items-center gap-1 px-4 py-2 rounded-xl transition-all relative hover-scale ".concat(l?"text-primary-400 bg-primary-500/10 tab-glow-active":"text-surface-500 hover:text-surface-300"),children:[(0,a.jsx)(s,{size:22}),(0,a.jsx)("span",{className:"text-xs font-medium",children:t}),r&&r>0&&(0,a.jsx)("span",{className:"notification-badge",children:r})]})}},7925:function(e,s,t){"use strict";t.d(s,{e:function(){return i}});var a=t(9982);let l=null;function i(){if(l)return l;let e="https://apakkhzuydsfzvypewwa.supabase.co",s="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFwYWtraHp1eWRzZnp2eXBld3dhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg1MDEyODQsImV4cCI6MjA4NDA3NzI4NH0.c3hiZOEKMIXMP7aB0SVgrbQH58nwxseycVmeH23KsNQ";if(!e||!s)throw Error("Missing Supabase environment variables. Please ensure NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY are set.");return l=(0,a.createBrowserClient)(e,s)}}},function(e){e.O(0,[194,619,741,564,744],function(){return e(e.s=7052)}),_N_E=e.O()}]);