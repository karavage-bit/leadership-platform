(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[921],{9617:function(e,s,t){Promise.resolve().then(t.bind(t,108))},108:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return ex}});var a=t(7437),l=t(2265),i=t(1344),r=t(8614),n=t(2926),c=t(5395),o=t(2023),d=t(7692),u=t(4938),x=t(5805),m=t(6595),p=t(9474),h=t(1723),f=t(5846),v=t(166),j=t(8933),b=t(9376),g=t(3417),y=t(407),N=t(8896),w=t(2048),_=t(1769),C=t(3276),k=t(1239),S=t(3327),D=t(401),E=t(6337);let I={1:"courage",2:"care",3:"community",4:"creation"};function Z(e){let{lesson:s,progress:t,world:l,onDoNowClick:r,onScenarioClick:n,onChallengeClick:c,onTextAnchorComplete:o,onMediaComplete:d}=e;return(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[!(null==t?void 0:t.do_now_complete)&&(0,a.jsxs)(i.E.div,{className:"card p-6 bg-gradient-to-r from-primary-900/40 to-surface-900 border-primary-700/50 relative overflow-hidden",whileHover:{scale:1.01},children:[(0,a.jsx)("div",{className:"absolute top-0 right-0 w-64 h-64 bg-primary-500/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2"}),(0,a.jsx)("div",{className:"relative",children:(0,a.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-primary-400 text-sm font-semibold mb-3",children:[(0,a.jsx)(i.E.div,{animate:{scale:[1,1.2,1]},transition:{duration:2,repeat:1/0},children:(0,a.jsx)(g.Z,{size:18})}),"START HERE — TODAY'S DO NOW"]}),(0,a.jsxs)("h2",{className:"text-xl font-bold text-surface-100 mb-2",children:['"',null==s?void 0:s.compelling_question,'"']}),(0,a.jsx)("p",{className:"text-surface-400 text-sm",children:"5-minute Socratic conversation to prime your brain for today's skill."})]}),(0,a.jsxs)(i.E.button,{onClick:r,className:"px-4 py-2 bg-primary-600 hover:bg-primary-500 text-white rounded-xl font-medium flex items-center gap-2 whitespace-nowrap",whileHover:{scale:1.05},whileTap:{scale:.95},children:["Begin ",(0,a.jsx)(y.Z,{size:18})]})]})})]}),(0,a.jsxs)("div",{className:"card p-6 phase-".concat(null==s?void 0:s.phase_id),children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center bg-".concat(I[null==s?void 0:s.phase_id],"/20"),children:(0,a.jsx)(N.Z,{className:"text-".concat(I[null==s?void 0:s.phase_id]),size:24})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"inline-block px-2 py-0.5 rounded-full text-xs font-medium bg-".concat(I[null==s?void 0:s.phase_id],"/20 text-").concat(I[null==s?void 0:s.phase_id]),children:["Lesson ",null==s?void 0:s.id," of 45"]}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-surface-100 mt-1",children:null==s?void 0:s.skill_name})]})]}),(0,a.jsx)("p",{className:"text-surface-400",children:null==s?void 0:s.lesson_objective})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-surface-200 flex items-center gap-2",children:[(0,a.jsx)(w.Z,{size:20,className:"text-primary-400"}),"Your Pathway"]}),(0,a.jsx)(L,{icon:g.Z,title:"Do Now",subtitle:"Warm up your brain",complete:(null==t?void 0:t.do_now_complete)||!1,locked:!1,reward:"\uD83C\uDF38 Flower",onClick:r}),(0,a.jsx)(L,{icon:_.Z,title:(null==s?void 0:s.text_anchor_title)||"Text Anchor",subtitle:"Read ".concat((null==s?void 0:s.text_anchor_chapter)||"Chapter"),complete:(null==t?void 0:t.text_anchor_complete)||!1,locked:!(null==t?void 0:t.do_now_complete),reward:"\uD83E\uDEA8 Stone",onClick:o}),(0,a.jsx)(L,{icon:C.Z,title:(null==s?void 0:s.media_title)||"Media",subtitle:"Watch & reflect",complete:(null==t?void 0:t.media_complete)||!1,locked:!(null==t?void 0:t.text_anchor_complete),reward:"\uD83E\uDEA8 Stone",onClick:d,mediaUrl:null==s?void 0:s.media_url}),(0,a.jsx)(L,{icon:k.Z,title:"Socratic Scenario",subtitle:"Apply your knowledge",complete:(null==t?void 0:t.scenario_complete)||!1,locked:!(null==t?void 0:t.media_complete),reward:"\uD83C\uDF32 Tree",onClick:n}),(0,a.jsx)(L,{icon:S.Z,title:"Real-World Challenge",subtitle:"Prove it in action",complete:(null==t?void 0:t.challenge_complete)||!1,locked:!(null==t?void 0:t.scenario_complete),reward:"\uD83C\uDFDB️ Tower",onClick:c})]}),(0,a.jsxs)("div",{className:"card p-4",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-surface-300 mb-3",children:"Today's Progress"}),(0,a.jsxs)("div",{className:"grid grid-cols-5 gap-2 text-center",children:[(0,a.jsx)(q,{label:"Trees",value:(null==l?void 0:l.trees)||0,emoji:"\uD83C\uDF32"}),(0,a.jsx)(q,{label:"Flowers",value:(null==l?void 0:l.flowers)||0,emoji:"\uD83C\uDF38"}),(0,a.jsx)(q,{label:"Stones",value:(null==l?void 0:l.stones)||0,emoji:"\uD83E\uDEA8"}),(0,a.jsx)(q,{label:"Tower",value:(null==l?void 0:l.tower)||0,emoji:"\uD83C\uDFDB️"}),(0,a.jsx)(q,{label:"Helped",value:(null==l?void 0:l.help_given)||0,emoji:"\uD83E\uDD1D"})]})]})]},"home")}function L(e){let{icon:s,title:t,subtitle:l,complete:r,locked:n,reward:c,onClick:o,mediaUrl:d}=e;return(0,a.jsxs)(i.E.button,{onClick:()=>{if(!r&&!n){if(d){window.open(d,"_blank"),o();return}o()}},disabled:n,className:"w-full p-4 rounded-xl border flex items-center gap-4 transition-all text-left ".concat(r?"bg-green-500/10 border-green-500/30":n?"bg-surface-800/50 border-surface-700 opacity-50 cursor-not-allowed":"bg-surface-800/50 border-surface-700 hover:border-primary-500/50 hover:bg-surface-800"),whileHover:n||r?{}:{scale:1.01},whileTap:n||r?{}:{scale:.99},children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center ".concat(r?"bg-green-500/20 text-green-400":n?"bg-surface-700 text-surface-500":"bg-primary-500/20 text-primary-400"),children:r?(0,a.jsx)(D.Z,{size:20}):n?(0,a.jsx)(E.Z,{size:20}):(0,a.jsx)(s,{size:20})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h4",{className:"font-medium ".concat(r?"text-green-400":"text-surface-200"),children:t}),(0,a.jsx)("p",{className:"text-xs text-surface-500",children:l})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("span",{className:"text-lg",children:c.split(" ")[0]}),(0,a.jsx)("p",{className:"text-xs text-surface-500",children:c.split(" ")[1]})]}),!r&&!n&&(0,a.jsx)(y.Z,{size:18,className:"text-surface-500"})]})}function q(e){let{label:s,value:t,emoji:l}=e;return(0,a.jsxs)("div",{className:"p-2 bg-surface-800/50 rounded-lg",children:[(0,a.jsx)("div",{className:"text-xl mb-1",children:l}),(0,a.jsx)("div",{className:"text-lg font-bold text-white",children:t}),(0,a.jsx)("div",{className:"text-xs text-surface-500",children:s})]})}var T=t(5368),P=t(3057),z=t(9646),A=t(8420),O=t(9985),B=t(1476);let H=(0,v.default)(()=>Promise.all([t.e(689),t.e(918),t.e(366),t.e(113)]).then(t.bind(t,2113)),{loadableGenerated:{webpack:()=>[2113]},ssr:!1,loading:()=>(0,a.jsx)("div",{className:"w-full aspect-video bg-surface-900 rounded-2xl flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-surface-400 animate-pulse",children:"Loading 3D World..."})})});function R(e){let{world:s,userName:t,placedItems:l,inventoryItems:r,discoveredSecrets:n,onItemPlace:c,onBrainstormOpen:o}=e,d=((null==s?void 0:s.trees)||0)+((null==s?void 0:s.flowers)||0)+((null==s?void 0:s.tower)||0)+((null==s?void 0:s.bridge)||0);return(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(H,{world:s,userName:t,placedItems:l,discoveredSecrets:n,inventoryItems:r,onItemPlace:c,onOpenBrainstorm:o}),(0,a.jsxs)("div",{className:"absolute top-4 left-4 bg-black/60 backdrop-blur-sm rounded-lg px-3 py-2 text-xs text-white",children:[(0,a.jsxs)("div",{className:"font-semibold mb-1",children:[t,"'s World"]}),(0,a.jsxs)("div",{className:"text-surface-300",children:[d," items placed"]})]}),(0,a.jsxs)("div",{className:"absolute bottom-4 right-4 bg-black/60 backdrop-blur-sm rounded-lg px-3 py-2 text-xs text-surface-300",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 mb-1",children:[(0,a.jsx)(T.Z,{size:12}),(0,a.jsx)("span",{children:"Controls"})]}),(0,a.jsx)("div",{children:"WASD - Move"}),(0,a.jsx)("div",{children:"P - Place items"}),(0,a.jsx)("div",{children:"E - Interact"}),(0,a.jsx)("div",{children:"B - Brainstorm"})]})]}),(0,a.jsxs)("div",{className:"card p-4",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-surface-300 mb-3",children:"Your Resources"}),(0,a.jsxs)("div",{className:"grid grid-cols-5 gap-3",children:[(0,a.jsx)(F,{icon:P.Z,count:(null==s?void 0:s.trees)||0,label:"Trees",color:"text-green-400",bgColor:"bg-green-500/20"}),(0,a.jsx)(F,{icon:z.Z,count:(null==s?void 0:s.flowers)||0,label:"Flowers",color:"text-pink-400",bgColor:"bg-pink-500/20"}),(0,a.jsx)(F,{icon:A.Z,count:(null==s?void 0:s.tower)||0,label:"Tower",color:"text-blue-400",bgColor:"bg-blue-500/20"}),(0,a.jsx)(F,{icon:O.Z,count:(null==s?void 0:s.bridge)||0,label:"Bridge",color:"text-purple-400",bgColor:"bg-purple-500/20"}),(0,a.jsx)(F,{icon:B.Z,count:(null==s?void 0:s.crystals)||0,label:"Crystals",color:"text-cyan-400",bgColor:"bg-cyan-500/20"})]})]}),(0,a.jsxs)("div",{className:"card p-4",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-surface-300 mb-3",children:"Journey Progress"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(U,{label:"Self-Leadership",progress:(null==s?void 0:s.phase1_progress)||0,color:"bg-courage"}),(0,a.jsx)(U,{label:"Team Leadership",progress:(null==s?void 0:s.phase2_progress)||0,color:"bg-care"}),(0,a.jsx)(U,{label:"Community Leadership",progress:(null==s?void 0:s.phase3_progress)||0,color:"bg-community"}),(0,a.jsx)(U,{label:"Legacy Leadership",progress:(null==s?void 0:s.phase4_progress)||0,color:"bg-creation"})]})]}),n.length>0&&(0,a.jsxs)("div",{className:"card p-4",children:[(0,a.jsxs)("h3",{className:"text-sm font-semibold text-surface-300 mb-3",children:["\uD83D\uDD2E Secrets Discovered (",n.length,")"]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:n.map((e,s)=>(0,a.jsx)("span",{className:"px-2 py-1 bg-purple-500/20 text-purple-300 rounded-full text-xs",children:e},s))})]})]},"world")}function F(e){let{icon:s,count:t,label:l,color:i,bgColor:r}=e;return(0,a.jsxs)("div",{className:"text-center p-3 bg-surface-800/50 rounded-xl",children:[(0,a.jsx)("div",{className:"w-10 h-10 mx-auto mb-2 rounded-lg ".concat(r," flex items-center justify-center"),children:(0,a.jsx)(s,{className:i,size:20})}),(0,a.jsx)("div",{className:"text-xl font-bold text-white",children:t}),(0,a.jsx)("div",{className:"text-xs text-surface-500",children:l})]})}function U(e){let{label:s,progress:t,color:l}=e;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,a.jsx)("span",{className:"text-surface-400",children:s}),(0,a.jsxs)("span",{className:"text-surface-300 font-medium",children:[t,"%"]})]}),(0,a.jsx)("div",{className:"h-2 bg-surface-800 rounded-full overflow-hidden",children:(0,a.jsx)(i.E.div,{className:"h-full ".concat(l," rounded-full"),initial:{width:0},animate:{width:"".concat(t,"%")},transition:{duration:.5,ease:"easeOut"}})})]})}var M=t(4935),G=t(8997),W=t(9397),Y=t(2489);let J={academic:_.Z,technical:M.Z,creative:f.Z,personal:G.Z,other:T.Z},X={academic:"text-blue-400 bg-blue-500/20",technical:"text-green-400 bg-green-500/20",creative:"text-purple-400 bg-purple-500/20",personal:"text-pink-400 bg-pink-500/20",other:"text-gray-400 bg-gray-500/20"};function K(e){let{helpRequests:s,userId:t,classId:n,onRefresh:c}=e,[o,d]=(0,l.useState)(!1),u=(0,j.e)(),m=async e=>{await u.from("help_requests").update({helper_id:t,status:"in_progress"}).eq("id",e),t&&(await u.rpc("increment_help_given",{p_student_id:t}),await u.rpc("increment_bridge",{p_student_id:t})),c()};return(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[(0,a.jsx)(x.Z,{className:"text-purple-400"}),"The Commons"]}),(0,a.jsx)("p",{className:"text-sm text-surface-400",children:"Help others, grow together"})]}),(0,a.jsxs)(i.E.button,{onClick:()=>d(!0),className:"px-4 py-2 bg-primary-600 hover:bg-primary-500 text-white rounded-xl font-medium flex items-center gap-2",whileHover:{scale:1.05},whileTap:{scale:.95},children:[(0,a.jsx)(W.Z,{size:18}),"Ask for Help"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,a.jsxs)("div",{className:"card p-3 text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-white",children:s.length}),(0,a.jsx)("div",{className:"text-xs text-surface-400",children:"Open Requests"})]}),(0,a.jsxs)("div",{className:"card p-3 text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-pink-400",children:"0"}),(0,a.jsx)("div",{className:"text-xs text-surface-400",children:"You've Helped"})]}),(0,a.jsxs)("div",{className:"card p-3 text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-purple-400",children:"0"}),(0,a.jsx)("div",{className:"text-xs text-surface-400",children:"Helped You"})]})]}),(0,a.jsx)("div",{className:"space-y-3",children:0===s.length?(0,a.jsxs)("div",{className:"card p-8 text-center",children:[(0,a.jsx)(G.Z,{className:"mx-auto mb-3 text-surface-500",size:40}),(0,a.jsx)("h3",{className:"font-semibold text-surface-300 mb-1",children:"No open requests"}),(0,a.jsx)("p",{className:"text-sm text-surface-500",children:"When classmates need help, their requests will appear here."})]}):s.map(e=>{let s=J[e.category]||T.Z,t=X[e.category]||X.other;return(0,a.jsx)(i.E.div,{className:"card p-4",initial:{opacity:0,y:10},animate:{opacity:1,y:0},children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"p-2 rounded-lg ".concat(t),children:(0,a.jsx)(s,{size:20})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsxs)("span",{className:"text-sm font-medium text-surface-300",children:["\uD83C\uDFAD ",e.anonymous_name]}),(0,a.jsxs)("span",{className:"text-xs text-surface-500",children:[(0,a.jsx)(h.Z,{size:12,className:"inline mr-1"}),new Date(e.created_at).toLocaleDateString()]})]}),(0,a.jsx)("h4",{className:"font-semibold text-white mb-1",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-surface-400",children:e.description})]}),(0,a.jsxs)(i.E.button,{onClick:()=>m(e.id),className:"px-3 py-2 bg-pink-500/20 hover:bg-pink-500/30 text-pink-400 rounded-lg text-sm font-medium flex items-center gap-1",whileHover:{scale:1.05},whileTap:{scale:.95},children:[(0,a.jsx)(G.Z,{size:14}),"Help"]})]})},e.id)})}),(0,a.jsx)(r.M,{children:o&&(0,a.jsx)(V,{userId:t,classId:n,onClose:()=>d(!1),onSuccess:()=>{d(!1),c()}})})]},"commons")}function V(e){let{userId:s,classId:t,onClose:r,onSuccess:n}=e,[c,o]=(0,l.useState)(""),[d,u]=(0,l.useState)(""),[x,m]=(0,l.useState)("academic"),[p,h]=(0,l.useState)(!1),v=(0,j.e)(),b=async e=>{e.preventDefault(),h(!0);let a=["Swift","Bright","Calm","Noble","Wise","Kind","Bold","Gentle"],l=["Phoenix","Eagle","Oak","River","Star","Mountain","Wave","Wind"],i="".concat(a[Math.floor(Math.random()*a.length)]," ").concat(l[Math.floor(Math.random()*l.length)]);await v.from("help_requests").insert({requester_id:s,class_id:t,title:c,description:d,category:x,anonymous_name:i}),h(!1),n()},g=[{id:"academic",label:"Academic",icon:_.Z},{id:"technical",label:"Technical",icon:M.Z},{id:"creative",label:"Creative",icon:f.Z},{id:"personal",label:"Personal",icon:G.Z},{id:"other",label:"Other",icon:T.Z}];return(0,a.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)(i.E.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-surface-900 rounded-2xl w-full max-w-md",children:[(0,a.jsxs)("div",{className:"p-4 border-b border-surface-800 flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"font-semibold text-white",children:"Ask for Help"}),(0,a.jsx)("button",{onClick:r,className:"text-surface-400 hover:text-white",children:(0,a.jsx)(Y.Z,{size:20})})]}),(0,a.jsxs)("form",{onSubmit:b,className:"p-4 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-surface-300 mb-1",children:"What do you need help with?"}),(0,a.jsx)("input",{type:"text",value:c,onChange:e=>o(e.target.value),placeholder:"Brief title...",className:"w-full bg-surface-800 border border-surface-700 rounded-xl px-4 py-2 text-white placeholder:text-surface-500 focus:border-primary-500 outline-none",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-surface-300 mb-1",children:"Category"}),(0,a.jsx)("div",{className:"grid grid-cols-5 gap-2",children:g.map(e=>(0,a.jsxs)("button",{type:"button",onClick:()=>m(e.id),className:"p-2 rounded-lg flex flex-col items-center gap-1 transition-colors ".concat(x===e.id?"bg-primary-500/20 border border-primary-500":"bg-surface-800 border border-transparent hover:border-surface-600"),children:[(0,a.jsx)(e.icon,{size:18,className:x===e.id?"text-primary-400":"text-surface-400"}),(0,a.jsx)("span",{className:"text-xs",children:e.label})]},e.id))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-surface-300 mb-1",children:"Details"}),(0,a.jsx)("textarea",{value:d,onChange:e=>u(e.target.value),placeholder:"Describe what you're struggling with...",className:"w-full h-24 bg-surface-800 border border-surface-700 rounded-xl px-4 py-2 text-white placeholder:text-surface-500 focus:border-primary-500 outline-none resize-none",required:!0})]}),(0,a.jsx)("div",{className:"bg-surface-800/50 rounded-lg p-3 text-sm text-surface-400",children:"\uD83D\uDCA1 Your request will be posted anonymously. Someone who can help will reach out!"}),(0,a.jsx)("button",{type:"submit",disabled:p||!c||!d,className:"w-full py-3 bg-primary-600 hover:bg-primary-500 disabled:bg-surface-700 text-white rounded-xl font-medium transition-colors",children:p?"Posting...":"Post Request"})]})]})})}let Q=(0,v.default)(()=>t.e(522).then(t.bind(t,1522)),{loadableGenerated:{webpack:()=>[1522]},ssr:!1}),$=(0,v.default)(()=>t.e(298).then(t.bind(t,8298)),{loadableGenerated:{webpack:()=>[8298]},ssr:!1});function ee(e){let{teacherChallenges:s,discoveries:t,userId:l,classId:r,onChallengeSubmit:n,onDiscoveryPost:c,onDiscoveryVote:o}=e;return(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[(0,a.jsx)(m.Z,{className:"text-yellow-400"}),"Discover"]}),(0,a.jsx)("p",{className:"text-sm text-surface-400",children:"Teacher challenges & student discoveries"})]}),(0,a.jsx)(Q,{challenges:s,onSubmitResponse:n}),(0,a.jsx)($,{discoveries:t,onPost:c,onVote:o,onComment:()=>{}})]},"discover")}var es=t(3420);let et=(0,v.default)(()=>t.e(945).then(t.bind(t,8945)),{loadableGenerated:{webpack:()=>[8945]},ssr:!1}),ea=(0,v.default)(()=>t.e(116).then(t.bind(t,8116)),{loadableGenerated:{webpack:()=>[8116]},ssr:!1});function el(e){let{world:s,currentLesson:t,journalData:r,connectionMapData:n,userId:c}=e,[o,d]=(0,l.useState)("overview");return"journal"===o?(0,a.jsxs)(i.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},children:[(0,a.jsx)("button",{onClick:()=>d("overview"),className:"mb-4 text-sm text-primary-400 hover:text-primary-300 flex items-center gap-1",children:"← Back to Progress"}),(0,a.jsx)(et,{weeks:(null==r?void 0:r.weeks)||[],totalDaysActive:(null==r?void 0:r.totalDaysActive)||0,longestStreak:(null==r?void 0:r.longestStreak)||0,totalRipples:(null==r?void 0:r.totalRipples)||0,skillsLearned:(null==r?void 0:r.skillsLearned)||[]})]},"journal"):"connections"===o?(0,a.jsxs)(i.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},children:[(0,a.jsx)("button",{onClick:()=>d("overview"),className:"mb-4 text-sm text-primary-400 hover:text-primary-300 flex items-center gap-1",children:"← Back to Progress"}),(0,a.jsx)(ea,{students:(null==n?void 0:n.students)||[],connections:(null==n?void 0:n.connections)||[],currentUserId:c||"",classStats:(null==n?void 0:n.stats)||{totalConnections:0,totalRipples:0,averageHelpPerStudent:0}})]},"connections"):(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[(0,a.jsx)(p.Z,{className:"text-yellow-400"}),"Your Progress"]}),(0,a.jsx)("p",{className:"text-sm text-surface-400",children:"Track your leadership journey"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{className:"card p-4 text-center",children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-white",children:t}),(0,a.jsx)("div",{className:"text-sm text-surface-400",children:"Lessons Complete"})]}),(0,a.jsxs)("div",{className:"card p-4 text-center",children:[(0,a.jsxs)("div",{className:"text-3xl font-bold text-primary-400",children:[Math.round((t-1)/45*100),"%"]}),(0,a.jsx)("div",{className:"text-sm text-surface-400",children:"Journey Progress"})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(ei,{phase:1,name:"Self-Leadership",description:"Understanding yourself as a leader",progress:(null==s?void 0:s.phase1_progress)||0,lessons:"1-12",color:"courage",currentLesson:t}),(0,a.jsx)(ei,{phase:2,name:"Team Leadership",description:"Leading and collaborating with others",progress:(null==s?void 0:s.phase2_progress)||0,lessons:"13-24",color:"care",currentLesson:t}),(0,a.jsx)(ei,{phase:3,name:"Community Leadership",description:"Making impact beyond your circle",progress:(null==s?void 0:s.phase3_progress)||0,lessons:"25-36",color:"community",currentLesson:t}),(0,a.jsx)(ei,{phase:4,name:"Legacy Leadership",description:"Creating lasting change",progress:(null==s?void 0:s.phase4_progress)||0,lessons:"37-45",color:"creation",currentLesson:t})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-surface-300",children:"Deep Dive"}),(0,a.jsxs)("button",{onClick:()=>d("journal"),className:"w-full card p-4 flex items-center justify-between hover:border-primary-500/50 transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-lg bg-purple-500/20 flex items-center justify-center",children:(0,a.jsx)(_.Z,{className:"text-purple-400",size:20})}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("h4",{className:"font-medium text-white",children:"Growth Journal"}),(0,a.jsx)("p",{className:"text-xs text-surface-400",children:"Your complete journey timeline"})]})]}),(0,a.jsx)(y.Z,{className:"text-surface-500",size:20})]}),(0,a.jsxs)("button",{onClick:()=>d("connections"),className:"w-full card p-4 flex items-center justify-between hover:border-primary-500/50 transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-lg bg-cyan-500/20 flex items-center justify-center",children:(0,a.jsx)(es.Z,{className:"text-cyan-400",size:20})}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("h4",{className:"font-medium text-white",children:"Class Connections"}),(0,a.jsx)("p",{className:"text-xs text-surface-400",children:"See how the class is connected"})]})]}),(0,a.jsx)(y.Z,{className:"text-surface-500",size:20})]})]})]},"progress")}function ei(e){let{phase:s,name:t,description:l,progress:r,lessons:n,color:c,currentLesson:o}=e,d=n.split("-").map(Number),u=o>=d[0]&&o<=d[1],x=o<d[0];return(0,a.jsxs)("div",{className:"card p-4 ".concat(u?"border-".concat(c,"/50"):""," ").concat(x?"opacity-50":""),children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-lg bg-".concat(c,"/20 flex items-center justify-center text-lg font-bold text-").concat(c),children:s}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h3",{className:"font-semibold text-white",children:t}),r>=100&&(0,a.jsx)("span",{className:"text-green-400",children:"✓"}),u&&(0,a.jsx)("span",{className:"text-xs px-2 py-0.5 bg-primary-500/20 text-primary-400 rounded-full",children:"Current"})]}),(0,a.jsx)("p",{className:"text-xs text-surface-400",children:l})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"text-lg font-bold text-white",children:[r,"%"]}),(0,a.jsxs)("div",{className:"text-xs text-surface-500",children:["Lessons ",n]})]})]}),(0,a.jsx)("div",{className:"h-2 bg-surface-800 rounded-full overflow-hidden",children:(0,a.jsx)(i.E.div,{className:"h-full bg-".concat(c," rounded-full"),initial:{width:0},animate:{width:"".concat(r,"%")},transition:{duration:.5}})})]})}let er=(0,v.default)(()=>t.e(731).then(t.bind(t,1731)),{loadableGenerated:{webpack:()=>[1731]},ssr:!1}),en=(0,v.default)(()=>t.e(519).then(t.bind(t,9519)),{loadableGenerated:{webpack:()=>[9519]},ssr:!1}),ec=(0,v.default)(()=>t.e(236).then(t.bind(t,4236)),{loadableGenerated:{webpack:()=>[4236]},ssr:!1}),eo=(0,v.default)(()=>t.e(753).then(t.bind(t,3753)),{loadableGenerated:{webpack:()=>[3753]},ssr:!1}),ed=(0,v.default)(()=>t.e(74).then(t.bind(t,3074)),{loadableGenerated:{webpack:()=>[3074]},ssr:!1}),eu={1:"Self-Leadership",2:"Team Leadership",3:"Community Leadership",4:"Legacy Leadership"};function ex(){var e,s;let{user:t,lesson:v,progress:g,world:y,helpRequests:N,teacherChallenges:w,discoveries:_,journalData:C,connectionMapData:k,placedItems:S,inventoryItems:D,discoveredSecrets:E,gatewayComplete:I,dailyUnmaskData:L,studentSkills:q,loading:T,isOnline:P,error:z,loadData:A,handleLogout:O,refreshHelpRequests:B,markTextAnchorComplete:H,markMediaComplete:F,updateWorld:U,updateProgress:M}=function(){let e=(0,b.useRouter)(),s=(0,j.e)(),[t,a]=(0,l.useState)(null),[i,r]=(0,l.useState)(null),[n,c]=(0,l.useState)(null),[o,d]=(0,l.useState)(null),[u,x]=(0,l.useState)([]),[m,p]=(0,l.useState)([]),[h,f]=(0,l.useState)([]),[v,g]=(0,l.useState)([]),[y,N]=(0,l.useState)(null),[w,_]=(0,l.useState)(null),[C,k]=(0,l.useState)([]),[S,D]=(0,l.useState)([]),[E,I]=(0,l.useState)([]),[Z,L]=(0,l.useState)(!1),[q,T]=(0,l.useState)(null),[P,z]=(0,l.useState)([]),[A,O]=(0,l.useState)(!0),[B,H]=(0,l.useState)(!0),[R,F]=(0,l.useState)(null);(0,l.useEffect)(()=>{let e=()=>H(!0),s=()=>H(!1);return window.addEventListener("online",e),window.addEventListener("offline",s),H(navigator.onLine),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",s)}},[]);let U=(0,l.useCallback)(async(e,s)=>{try{let t=await fetch("/api/challenges/teacher?classId=".concat(e,"&studentId=").concat(s));if(!t.ok)throw Error("Failed to load challenges");let a=await t.json();f(a.challenges||[])}catch(e){console.error("Error loading teacher challenges:",e)}},[]),M=(0,l.useCallback)(async(e,s)=>{try{let t=s?"/api/discoveries?classId=".concat(e,"&studentId=").concat(s):"/api/discoveries?classId=".concat(e),a=await fetch(t);if(!a.ok)throw Error("Failed to load discoveries");let l=await a.json();g(l.discoveries||[])}catch(e){console.error("Error loading discoveries:",e)}},[]),G=(0,l.useCallback)(async e=>{try{let s=await fetch("/api/journal?studentId=".concat(e));if(!s.ok)throw Error("Failed to load journal");let t=await s.json();N(t),z(t.skillsLearned||[])}catch(e){console.error("Error loading journal:",e)}},[]),W=(0,l.useCallback)(async(e,t)=>{try{let{data:t}=await s.from("users").select("id, name, anonymous_name, is_unmasked").eq("class_id",e).eq("role","student"),{data:a}=await s.from("world_states").select("student_id, help_given").in("student_id",(null==t?void 0:t.map(e=>e.id))||[]),l=(null==t?void 0:t.map(e=>{let s=null==a?void 0:a.find(s=>s.student_id===e.id);return{id:e.id,name:e.name,anonymousName:e.anonymous_name||"Anonymous",isUnmasked:e.is_unmasked||!1,ripplesStarted:0,helpGiven:(null==s?void 0:s.help_given)||0,tier:1}}))||[],{data:i}=await s.from("help_requests").select("requester_id, helper_id").eq("class_id",e).eq("status","completed"),r=(null==i?void 0:i.map(e=>({from:e.helper_id,to:e.requester_id,strength:1,type:"help"})))||[];_({students:l,connections:r,stats:{totalConnections:r.length,totalRipples:0,averageHelpPerStudent:l.length>0?l.reduce((e,s)=>e+s.helpGiven,0)/l.length:0}})}catch(e){console.error("Error loading connection map:",e)}},[s]),Y=(0,l.useCallback)(async()=>{F(null);try{let t=localStorage.getItem("leadership_user_id"),l=localStorage.getItem("leadership_user_name"),i=localStorage.getItem("leadership_class_id"),n=t,o=null;if(t&&l&&i){let{data:a}=await s.from("users").select("*").eq("id",t).single();if(a)o=a,n=a.id;else{localStorage.removeItem("leadership_user_id"),localStorage.removeItem("leadership_user_name"),localStorage.removeItem("leadership_class_id"),e.push("/");return}}else{let{data:{user:t}}=await s.auth.getUser();if(!t){e.push("/");return}let{data:a}=await s.from("users").select("*").eq("id",t.id).single();if(!a||"student"!==a.role){e.push("/");return}o=a,n=a.id,localStorage.setItem("leadership_user_id",a.id),localStorage.setItem("leadership_user_name",a.name),localStorage.setItem("leadership_class_id",a.class_id)}a(o),L((null==o?void 0:o.gateway_complete)||!1);let{data:u}=await s.from("classes").select("current_lesson_id").eq("id",o.class_id).single(),m=(null==u?void 0:u.current_lesson_id)||1,{data:h}=await s.from("lessons").select("*").eq("id",m).single();r(h);let{data:f}=await s.from("student_lessons").select("*").eq("student_id",n).eq("lesson_id",m).single();if(!f){let{data:e}=await s.from("student_lessons").insert({student_id:n,lesson_id:m,class_id:o.class_id,status:"available"}).select().single();f=e}c(f);let{data:v}=await s.from("world_states").select("*").eq("student_id",n).single();if(!v){let{data:e}=await s.from("world_states").insert({student_id:n}).select().single();v=e}d(v);let{data:j}=await s.from("help_requests").select("*").eq("class_id",o.class_id).eq("status","open").order("created_at",{ascending:!1}).limit(10);x(j||[]);let{data:b}=await s.from("civic_events").select("*").eq("class_id",o.class_id).order("created_at",{ascending:!1}).limit(10);p(b||[]),await Promise.all([U(o.class_id,n),M(o.class_id,n),G(n),W(o.class_id,n)])}catch(e){console.error("Error loading data:",e),F("Failed to load data. Please refresh.")}finally{O(!1)}},[e,s,U,M,G,W]),J=(0,l.useCallback)(async()=>{localStorage.removeItem("leadership_user_id"),localStorage.removeItem("leadership_user_name"),localStorage.removeItem("leadership_class_id"),localStorage.removeItem("leadership_draft_conversation"),await s.auth.signOut(),e.push("/")},[e,s]),X=(0,l.useCallback)(async()=>{if(!t)return;let{data:e}=await s.from("help_requests").select("*").eq("class_id",t.class_id).eq("status","open").order("created_at",{ascending:!1}).limit(10);x(e||[])},[t,s]),K=(0,l.useCallback)(async()=>{t&&await M(t.class_id,t.id)},[t,M]),V=(0,l.useCallback)(async()=>{n&&t&&i&&(await s.from("student_lessons").update({text_anchor_complete:!0,text_anchor_at:new Date().toISOString(),status:"in_progress"}).eq("student_id",t.id).eq("lesson_id",i.id),await s.from("world_states").update({stones:((null==o?void 0:o.stones)||0)+1,updated_at:new Date().toISOString()}).eq("student_id",t.id),c({...n,text_anchor_complete:!0,status:"in_progress"}),d(e=>e?{...e,stones:(e.stones||0)+1}:null))},[n,t,i,o,s]),Q=(0,l.useCallback)(async()=>{n&&t&&i&&(await s.from("student_lessons").update({media_complete:!0,media_at:new Date().toISOString()}).eq("student_id",t.id).eq("lesson_id",i.id),await s.from("world_states").update({stones:((null==o?void 0:o.stones)||0)+1,updated_at:new Date().toISOString()}).eq("student_id",t.id),c({...n,media_complete:!0}),d(e=>e?{...e,stones:(e.stones||0)+1}:null))},[n,t,i,o,s]),$=(0,l.useCallback)(e=>{d(s=>s?{...s,...e}:null)},[]),ee=(0,l.useCallback)(e=>{c(s=>s?{...s,...e}:null)},[]);return(0,l.useEffect)(()=>{Y()},[Y]),{user:t,lesson:i,progress:n,world:o,helpRequests:u,civicEvents:m,teacherChallenges:h,discoveries:v,journalData:y,connectionMapData:w,placedItems:C,inventoryItems:S,discoveredSecrets:E,gatewayComplete:Z,dailyUnmaskData:q,studentSkills:P,loading:A,isOnline:B,error:R,loadData:Y,handleLogout:J,refreshHelpRequests:X,refreshDiscoveries:K,markTextAnchorComplete:V,markMediaComplete:Q,updateWorld:$,updateProgress:ee}}(),[G,W]=(0,l.useState)("home"),[Y,J]=(0,l.useState)(!1),[X,V]=(0,l.useState)(!1),[Q,$]=(0,l.useState)(!1),[es,et]=(0,l.useState)(!1),[ea,ei]=(0,l.useState)(!1),[ex,ep]=(0,l.useState)(!1),[eh,ef]=(0,l.useState)(!1),ev=((null==y?void 0:y.trees)||0)+((null==y?void 0:y.flowers)||0)+((null==y?void 0:y.tower)||0)+((null==y?void 0:y.bridge)||0);return T?(0,a.jsx)("div",{className:"min-h-screen bg-surface-950 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(i.E.div,{className:"text-5xl mb-4",animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},children:"\uD83C\uDF31"}),(0,a.jsx)("p",{className:"text-surface-400",children:"Loading your journey..."})]})}):z?(0,a.jsx)("div",{className:"min-h-screen bg-surface-950 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"card p-8 max-w-md text-center",children:[(0,a.jsx)("div",{className:"text-4xl mb-4",children:"⚠️"}),(0,a.jsx)("h2",{className:"text-xl font-bold text-white mb-2",children:"Something went wrong"}),(0,a.jsx)("p",{className:"text-surface-400 mb-4",children:z}),(0,a.jsx)("button",{onClick:A,className:"px-6 py-2 bg-primary-600 hover:bg-primary-500 text-white rounded-xl",children:"Try Again"})]})}):(0,a.jsxs)("div",{className:"min-h-screen bg-surface-950",children:[(0,a.jsx)("header",{className:"sticky top-0 z-40 bg-surface-900/95 backdrop-blur-md border-b border-surface-800",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-3 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(i.E.div,{className:"text-3xl",animate:{rotate:[0,10,-10,0]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:"\uD83C\uDF31"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"font-bold text-surface-100 text-lg",children:"Leadership 2.0"}),(0,a.jsxs)("p",{className:"text-xs text-surface-500",children:["Phase ",null==v?void 0:v.phase_id,": ",eu[null==v?void 0:v.phase_id]]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1.5 px-2.5 py-1.5 rounded-lg text-xs font-medium ".concat(P?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"),children:[P?(0,a.jsx)(n.Z,{size:14}):(0,a.jsx)(c.Z,{size:14}),P?"Online":"Offline"]}),(0,a.jsxs)("div",{className:"flex items-center gap-1.5 px-2.5 py-1.5 rounded-lg bg-surface-800 text-xs",children:[(0,a.jsx)(o.Z,{size:14,className:"text-yellow-400"}),(0,a.jsx)("span",{className:"text-surface-200 font-medium",children:ev})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-primary-500 to-purple-500 flex items-center justify-center text-white font-bold text-sm",children:null==t?void 0:null===(s=t.name)||void 0===s?void 0:null===(e=s[0])||void 0===e?void 0:e.toUpperCase()}),(0,a.jsx)("span",{className:"text-sm font-medium text-surface-200 hidden sm:block",children:null==t?void 0:t.name})]}),(0,a.jsx)("button",{onClick:O,className:"p-2 text-surface-400 hover:text-surface-200 rounded-lg hover:bg-surface-800 transition-colors",children:(0,a.jsx)(d.Z,{size:18})})]})]})}),(0,a.jsx)("main",{className:"max-w-6xl mx-auto px-4 py-6 pb-24",children:(0,a.jsxs)(r.M,{mode:"wait",children:["home"===G&&(0,a.jsx)(Z,{lesson:v,progress:g,world:y,onDoNowClick:()=>J(!0),onScenarioClick:()=>$(!0),onChallengeClick:()=>et(!0),onTextAnchorComplete:H,onMediaComplete:F}),"world"===G&&(0,a.jsx)(R,{world:y,userName:(null==t?void 0:t.name)||"Student",placedItems:S,inventoryItems:D,discoveredSecrets:E,onBrainstormOpen:()=>ep(!0)}),"commons"===G&&(0,a.jsx)(K,{helpRequests:N,userId:null==t?void 0:t.id,classId:null==t?void 0:t.class_id,onRefresh:B}),"discover"===G&&(0,a.jsx)(ee,{teacherChallenges:w,discoveries:_,userId:null==t?void 0:t.id,classId:null==t?void 0:t.class_id,onChallengeSubmit:async(e,s,a,l)=>{await fetch("/api/challenges/teacher/response",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({challengeId:e,studentId:null==t?void 0:t.id,classId:null==t?void 0:t.class_id,responseText:s,personalConnection:a,shareWithClass:l})}),A()},onDiscoveryPost:async e=>{await fetch("/api/discoveries",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:null==t?void 0:t.id,classId:null==t?void 0:t.class_id,...e})}),A()},onDiscoveryVote:async e=>{await fetch("/api/discoveries",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({discoveryId:e,studentId:null==t?void 0:t.id,action:"vote"})}),A()}}),"progress"===G&&(0,a.jsx)(el,{world:y,currentLesson:(null==v?void 0:v.id)||1,journalData:C,connectionMapData:k,userId:null==t?void 0:t.id})]})}),(0,a.jsx)("nav",{className:"fixed bottom-0 left-0 right-0 bg-surface-900/95 backdrop-blur-md border-t border-surface-800 z-50",children:(0,a.jsx)("div",{className:"max-w-6xl mx-auto px-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-around py-2",children:[(0,a.jsx)(em,{icon:u.Z,label:"Home",active:"home"===G,onClick:()=>W("home")}),(0,a.jsx)(em,{icon:o.Z,label:"World",active:"world"===G,onClick:()=>W("world")}),(0,a.jsx)(em,{icon:x.Z,label:"Commons",active:"commons"===G,onClick:()=>W("commons"),badge:N.length}),(0,a.jsx)(em,{icon:m.Z,label:"Discover",active:"discover"===G,onClick:()=>W("discover")}),(0,a.jsx)(em,{icon:p.Z,label:"Progress",active:"progress"===G,onClick:()=>W("progress")})]})})}),(0,a.jsxs)(i.E.button,{onClick:()=>V(!0),className:"fixed bottom-20 right-4 px-4 py-2 bg-surface-800 hover:bg-surface-700 text-white rounded-xl shadow-lg z-40 flex items-center gap-2",whileHover:{scale:1.05},whileTap:{scale:.95},children:[(0,a.jsx)(h.Z,{size:16}),"Exit Ticket"]}),(0,a.jsx)(i.E.button,{onClick:()=>ep(!0),className:"fixed bottom-20 left-4 p-3 bg-purple-600 hover:bg-purple-500 text-white rounded-full shadow-lg z-40",whileHover:{scale:1.1},whileTap:{scale:.95},title:"Brainstorm Ideas",children:(0,a.jsx)(f.Z,{size:20})}),(0,a.jsxs)(r.M,{children:[Y&&(0,a.jsx)(er,{type:"do_now",lesson:v,userId:null==t?void 0:t.id,classId:null==t?void 0:t.class_id,userName:null==t?void 0:t.name,onClose:()=>J(!1),onComplete:()=>{M({do_now_complete:!0,status:"in_progress"}),U({flowers:((null==y?void 0:y.flowers)||0)+1}),J(!1)}}),Q&&(0,a.jsx)(er,{type:"scenario",lesson:v,userId:null==t?void 0:t.id,classId:null==t?void 0:t.class_id,userName:null==t?void 0:t.name,onClose:()=>$(!1),onScenarioComplete:()=>{M({scenario_complete:!0}),U({trees:((null==y?void 0:y.trees)||0)+1}),$(!1),et(!0)}}),X&&(0,a.jsx)(er,{type:"exit_ticket",lesson:v,userId:null==t?void 0:t.id,classId:null==t?void 0:t.class_id,userName:null==t?void 0:t.name,onClose:()=>V(!1)}),es&&(0,a.jsx)(en,{lesson:v,userId:null==t?void 0:t.id,classId:null==t?void 0:t.class_id,onClose:()=>{et(!1),A()}})]}),ea&&(0,a.jsx)(ec,{onComplete:async e=>{await fetch("/api/gateway",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:null==t?void 0:t.id,...e})}),ei(!1),A()}}),eh&&L&&(0,a.jsx)(eo,{anonymousName:L.anonymousName,realName:L.realName,reason:L.reason,rippleCount:L.rippleCount,onContinue:()=>ef(!1)}),(0,a.jsx)(ed,{isOpen:ex,onClose:()=>ep(!1),studentSkills:q,onActionPlan:e=>{console.log("Action plan committed:",e),ep(!1)}})]})}function em(e){let{icon:s,label:t,active:l,onClick:i,badge:r}=e;return(0,a.jsxs)("button",{onClick:i,className:"flex flex-col items-center gap-1 px-4 py-2 rounded-xl transition-all relative ".concat(l?"text-primary-400 bg-primary-500/10":"text-surface-500 hover:text-surface-300"),children:[(0,a.jsx)(s,{size:22}),(0,a.jsx)("span",{className:"text-xs font-medium",children:t}),r&&r>0&&(0,a.jsx)("span",{className:"absolute top-1 right-2 w-4 h-4 bg-red-500 text-white text-[10px] rounded-full flex items-center justify-center",children:r})]})}},8933:function(e,s,t){"use strict";t.d(s,{e:function(){return r}});var a=t(6614),l=t(257);let i=null;function r(){if(i)return i;let e=l.env.NEXT_PUBLIC_SUPABASE_URL,s=l.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;if(!e||!s)throw Error("Missing Supabase environment variables. Please ensure NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY are set.");return i=(0,a.createBrowserClient)(e,s)}}},function(e){e.O(0,[818,751,971,117,744],function(){return e(e.s=9617)}),_N_E=e.O()}]);