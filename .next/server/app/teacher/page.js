(()=>{var e={};e.id=941,e.ids=[941],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},8893:e=>{"use strict";e.exports=require("buffer")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2615:e=>{"use strict";e.exports=require("http")},5240:e=>{"use strict";e.exports=require("https")},8216:e=>{"use strict";e.exports=require("net")},8621:e=>{"use strict";e.exports=require("punycode")},6162:e=>{"use strict";e.exports=require("stream")},2452:e=>{"use strict";e.exports=require("tls")},7360:e=>{"use strict";e.exports=require("url")},1568:e=>{"use strict";e.exports=require("zlib")},1508:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>l.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>o,routeModule:()=>u,tree:()=>d}),t(3117),t(5394),t(5629);var a=t(5236),i=t(7665),r=t(729),l=t.n(r),n=t(2185),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);t.d(s,c);let d=["",{children:["teacher",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,3117)),"/workspace/leadership-platform/src/app/teacher/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,5394)),"/workspace/leadership-platform/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5629,23)),"next/dist/client/components/not-found-error"]}],o=["/workspace/leadership-platform/src/app/teacher/page.tsx"],x="/teacher/page",m={require:t,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/teacher/page",pathname:"/teacher",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},7145:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,9036,23)),Promise.resolve().then(t.t.bind(t,4534,23)),Promise.resolve().then(t.t.bind(t,1863,23)),Promise.resolve().then(t.t.bind(t,629,23)),Promise.resolve().then(t.t.bind(t,6610,23)),Promise.resolve().then(t.t.bind(t,4444,23))},3309:(e,s,t)=>{Promise.resolve().then(t.bind(t,2634))},4338:(e,s,t)=>{Promise.resolve().then(t.bind(t,4139))},7122:()=>{},5771:(e,s)=>{"use strict";s.Qc=function(e,s){let t=new n,a=e.length;if(a<2)return t;let i=s?.decode||o,r=0;do{let s=function(e,s,t){let a=e.indexOf("=",s);return a<t?a:-1}(e,r,a);if(-1===s)break;let l=function(e,s,t){let a=e.indexOf(";",s);return -1===a?t:a}(e,r,a);if(s>l){r=e.lastIndexOf(";",s-1)+1;continue}let n=d(e,r,s);void 0===t[n]&&(t[n]=i(d(e,s+1,l))),r=l+1}while(r<a);return t},s.qC=c,s.qC=c;let t=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,a=/^[\u0021-\u003A\u003C-\u007E]*$/,i=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,l=Object.prototype.toString,n=(()=>{let e=function(){};return e.prototype=Object.create(null),e})();function c(e,s,n){let c="object"==typeof e?e:{...n,name:e,value:String(s)},d=("object"==typeof s?s:n)?.encode||encodeURIComponent;if(!t.test(c.name))throw TypeError(`argument name is invalid: ${c.name}`);let o=c.value?d(c.value):"";if(!a.test(o))throw TypeError(`argument val is invalid: ${c.value}`);let x=c.name+"="+o;if(void 0!==c.maxAge){if(!Number.isInteger(c.maxAge))throw TypeError(`option maxAge is invalid: ${c.maxAge}`);x+="; Max-Age="+c.maxAge}if(c.domain){if(!i.test(c.domain))throw TypeError(`option domain is invalid: ${c.domain}`);x+="; Domain="+c.domain}if(c.path){if(!r.test(c.path))throw TypeError(`option path is invalid: ${c.path}`);x+="; Path="+c.path}if(c.expires){var m;if(m=c.expires,"[object Date]"!==l.call(m)||!Number.isFinite(c.expires.valueOf()))throw TypeError(`option expires is invalid: ${c.expires}`);x+="; Expires="+c.expires.toUTCString()}if(c.httpOnly&&(x+="; HttpOnly"),c.secure&&(x+="; Secure"),c.partitioned&&(x+="; Partitioned"),c.priority)switch("string"==typeof c.priority?c.priority.toLowerCase():void 0){case"low":x+="; Priority=Low";break;case"medium":x+="; Priority=Medium";break;case"high":x+="; Priority=High";break;default:throw TypeError(`option priority is invalid: ${c.priority}`)}if(c.sameSite)switch("string"==typeof c.sameSite?c.sameSite.toLowerCase():c.sameSite){case!0:case"strict":x+="; SameSite=Strict";break;case"lax":x+="; SameSite=Lax";break;case"none":x+="; SameSite=None";break;default:throw TypeError(`option sameSite is invalid: ${c.sameSite}`)}return x}function d(e,s,t){let a=s,i=t;do{let s=e.charCodeAt(a);if(32!==s&&9!==s)break}while(++a<i);for(;i>a;){let s=e.charCodeAt(i-1);if(32!==s&&9!==s)break;i--}return e.slice(a,i)}function o(e){if(-1===e.indexOf("%"))return e;try{return decodeURIComponent(e)}catch(s){return e}}},1746:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(1819).Z)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},2634:(e,s,t)=>{"use strict";t.d(s,{ErrorBoundaryWrapper:()=>d});var a=t(9846),i=t(8482),r=t(4855),l=t(969),n=t(4961);class c extends i.Component{constructor(e){super(e),this.handleRetry=()=>{this.setState({hasError:!1,error:null,errorInfo:null})},this.handleGoHome=()=>{window.location.href="/"},this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e,errorInfo:null}}componentDidCatch(e,s){console.error("ErrorBoundary caught an error:",e,s),this.setState({errorInfo:s})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:a.jsx("div",{className:"min-h-screen bg-surface-950 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"max-w-md w-full bg-surface-900 rounded-2xl p-8 text-center border border-surface-800",children:[a.jsx("div",{className:"w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(r.Z,{className:"text-red-400",size:32})}),a.jsx("h1",{className:"text-xl font-bold text-white mb-2",children:"Something went wrong"}),a.jsx("p",{className:"text-surface-400 mb-6",children:"Don't worry - your progress is saved. Try refreshing, or head back to the home page."}),!1,(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)("button",{onClick:this.handleRetry,className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-primary-600 hover:bg-primary-500 text-white rounded-xl transition-colors",children:[a.jsx(l.Z,{size:18}),"Try Again"]}),(0,a.jsxs)("button",{onClick:this.handleGoHome,className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-surface-800 hover:bg-surface-700 text-white rounded-xl transition-colors",children:[a.jsx(n.Z,{size:18}),"Go Home"]})]})]})}):this.props.children}}function d({children:e}){return a.jsx(c,{children:e})}},4139:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>eo});var a=t(9846),i=t(8482),r=t(284),l=t(5695),n=t(1922),c=t(4153),d=t(1819);let o=(0,d.Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);var x=t(4855),m=t(969),u=t(9504);let h=(0,d.Z)("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);var p=t(1697),f=t(8079),j=t(4960);let b=(0,d.Z)("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),g=(0,d.Z)("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),v=(0,d.Z)("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);var y=t(6523),N=t(8809),w=t(513);let _=(0,d.Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var k=t(5626),C=t(2020);let S=(0,d.Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);var z=t(854),D=t(9755),Z=t(5930);let E=(0,d.Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);var M=t(9725);let A=(0,d.Z)("Keyboard",[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]]),I=(0,d.Z)("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),$=(0,d.Z)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),P=(0,d.Z)("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]),q=(0,d.Z)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);function T({classId:e,onSave:s}){let[t,l]=(0,i.useState)({interaction_mode:"typing",ai_difficulty:"standard",ai_persona:"strategist",min_responses:5,streak_enabled:!0,dark_mode_default:!0}),[c,d]=(0,i.useState)(!1),[o,x]=(0,i.useState)(!1),m=(0,r.createClient)(),u=async()=>{d(!0);let{error:a}=await m.from("classes").update(t).eq("id",e);d(!1),a||(x(!0),setTimeout(()=>x(!1),2e3),s?.())},h=[{value:"typing",label:"Typing Only",icon:A,desc:"Students type responses"},{value:"voice",label:"Voice Only",icon:I,desc:"Students speak responses"},{value:"both",label:"Both Options",icon:C.Z,desc:"Students choose method"}];return(0,a.jsxs)("div",{className:"space-y-8 p-6 bg-surface-800 rounded-2xl",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold flex items-center gap-2",children:[a.jsx($,{className:"w-5 h-5 text-primary-500"}),"Class AI Settings"]}),(0,a.jsxs)("section",{className:"space-y-3",children:[a.jsx("h3",{className:"font-semibold text-surface-200",children:"Student Input Method"}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:h.map(e=>(0,a.jsxs)("button",{onClick:()=>l(s=>({...s,interaction_mode:e.value})),className:`p-4 rounded-xl border-2 transition-all ${t.interaction_mode===e.value?"border-primary-500 bg-primary-500/10":"border-surface-600 hover:border-surface-500"}`,children:[a.jsx(e.icon,{className:`w-6 h-6 mx-auto mb-2 ${t.interaction_mode===e.value?"text-primary-500":"text-surface-400"}`}),a.jsx("div",{className:"font-medium",children:e.label}),a.jsx("div",{className:"text-xs text-surface-400 mt-1",children:e.desc})]},e.value))})]}),(0,a.jsxs)("section",{className:"space-y-3",children:[a.jsx("h3",{className:"font-semibold text-surface-200",children:"AI Pushback Level"}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{value:"gentle",label:"Gentle",desc:"Encouraging, accepts shorter responses",color:"bg-green-500"},{value:"standard",label:"Standard",desc:"Pushback on surface answers",color:"bg-yellow-500"},{value:"intense",label:"Intense",desc:"Relentlessly Socratic",color:"bg-red-500"}].map(e=>(0,a.jsxs)("button",{onClick:()=>l(s=>({...s,ai_difficulty:e.value})),className:`p-4 rounded-xl border-2 transition-all ${t.ai_difficulty===e.value?"border-primary-500 bg-primary-500/10":"border-surface-600 hover:border-surface-500"}`,children:[a.jsx("div",{className:`w-3 h-3 rounded-full ${e.color} mx-auto mb-2`}),a.jsx("div",{className:"font-medium",children:e.label}),a.jsx("div",{className:"text-xs text-surface-400 mt-1",children:e.desc})]},e.value))})]}),(0,a.jsxs)("section",{className:"space-y-3",children:[a.jsx("h3",{className:"font-semibold text-surface-200",children:"AI Personality"}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{value:"hype_man",label:"The Hype Man",emoji:"\uD83D\uDD25",desc:"Supportive & energetic"},{value:"strategist",label:"The Strategist",emoji:"\uD83C\uDFAF",desc:"Direct & logical"},{value:"sage",label:"The Sage",emoji:"\uD83E\uDDD8",desc:"Philosophical & calm"}].map(e=>(0,a.jsxs)("button",{onClick:()=>l(s=>({...s,ai_persona:e.value})),className:`p-4 rounded-xl border-2 transition-all ${t.ai_persona===e.value?"border-primary-500 bg-primary-500/10":"border-surface-600 hover:border-surface-500"}`,children:[a.jsx("div",{className:"text-2xl mb-2",children:e.emoji}),a.jsx("div",{className:"font-medium",children:e.label}),a.jsx("div",{className:"text-xs text-surface-400 mt-1",children:e.desc})]},e.value))})]}),(0,a.jsxs)("section",{className:"space-y-3",children:[a.jsx("h3",{className:"font-semibold text-surface-200",children:"Minimum Exchanges Required"}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[a.jsx("input",{type:"range",min:3,max:10,value:t.min_responses,onChange:e=>l(s=>({...s,min_responses:parseInt(e.target.value)})),className:"flex-1"}),a.jsx("span",{className:"text-2xl font-bold text-primary-500 w-12 text-center",children:t.min_responses})]}),a.jsx("p",{className:"text-sm text-surface-400",children:"Students must complete at least this many exchanges before unlocking rewards"})]}),(0,a.jsxs)("section",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-surface-700 rounded-xl",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx(P,{className:"w-5 h-5 text-orange-500"}),(0,a.jsxs)("div",{children:[a.jsx("div",{className:"font-medium",children:"Streak System"}),a.jsx("div",{className:"text-sm text-surface-400",children:"Track daily engagement streaks"})]})]}),a.jsx("button",{onClick:()=>l(e=>({...e,streak_enabled:!e.streak_enabled})),className:`w-12 h-6 rounded-full transition-colors ${t.streak_enabled?"bg-primary-500":"bg-surface-600"}`,children:a.jsx("div",{className:`w-5 h-5 bg-white rounded-full transition-transform ${t.streak_enabled?"translate-x-6":"translate-x-0.5"}`})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-surface-700 rounded-xl",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx(z.Z,{className:"w-5 h-5 text-purple-500"}),(0,a.jsxs)("div",{children:[a.jsx("div",{className:"font-medium",children:"Dark Mode Default"}),a.jsx("div",{className:"text-sm text-surface-400",children:"Students start in dark mode"})]})]}),a.jsx("button",{onClick:()=>l(e=>({...e,dark_mode_default:!e.dark_mode_default})),className:`w-12 h-6 rounded-full transition-colors ${t.dark_mode_default?"bg-primary-500":"bg-surface-600"}`,children:a.jsx("div",{className:`w-5 h-5 bg-white rounded-full transition-transform ${t.dark_mode_default?"translate-x-6":"translate-x-0.5"}`})})]})]}),(0,a.jsxs)(n.E.button,{onClick:u,disabled:c,whileHover:{scale:1.02},whileTap:{scale:.98},className:`w-full py-4 rounded-xl font-semibold flex items-center justify-center gap-2 transition-colors ${o?"bg-green-500 text-white":"bg-primary-600 hover:bg-primary-500 text-white"}`,children:[a.jsx(q,{className:"w-5 h-5"}),c?"Saving...":o?"Settings Saved!":"Save Settings"]})]})}var L=t(5771);L.Qc,L.qC;let R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),O=" 	\n\r=".split("");(()=>{let e=Array(128);for(let s=0;s<e.length;s+=1)e[s]=-1;for(let s=0;s<O.length;s+=1)e[O[s].charCodeAt(0)]=-2;for(let s=0;s<R.length;s+=1)e[R[s].charCodeAt(0)]=s})();var H=t(7122);if("undefined"!=typeof process&&process.env?.npm_package_name){let e=process.env.npm_package_name;["@supabase/auth-helpers-nextjs","@supabase/auth-helpers-react","@supabase/auth-helpers-remix","@supabase/auth-helpers-sveltekit"].includes(e)&&console.warn(`
╔════════════════════════════════════════════════════════════════════════════╗
║ ⚠️  IMPORTANT: Package Consolidation Notice                                ║
║                                                                            ║
║ The ${e.padEnd(35)} package name is deprecated.  ║
║                                                                            ║
║ You are now using @supabase/ssr - a unified solution for all frameworks.  ║
║                                                                            ║
║ The auth-helpers packages have been consolidated into @supabase/ssr       ║
║ to provide better maintenance and consistent APIs across frameworks.      ║
║                                                                            ║
║ Please update your package.json to use @supabase/ssr directly:            ║
║   npm uninstall ${e.padEnd(42)} ║
║   npm install @supabase/ssr                                               ║
║                                                                            ║
║ For more information, visit:                                              ║
║ https://supabase.com/docs/guides/auth/server-side                         ║
╚════════════════════════════════════════════════════════════════════════════╝
    `)}function B({classId:e}){let[s,t]=(0,i.useState)(null),[r,l]=(0,i.useState)("overview");return((0,H.createClientComponentClient)(),s)?(0,a.jsxs)("div",{className:"bg-zinc-900 rounded-2xl p-6 border border-zinc-800",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-xl font-bold text-white",children:"Class Analytics"}),a.jsx("div",{className:"flex gap-2",children:["overview","students","trends"].map(e=>a.jsx("button",{onClick:()=>l(e),className:`px-3 py-1 rounded-lg text-sm capitalize ${r===e?"bg-blue-500 text-white":"bg-zinc-800 text-zinc-400"}`,children:e},e))})]}),"overview"===r&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[a.jsx(W,{label:"Students",value:s.totalStudents,icon:"\uD83D\uDC65"}),a.jsx(W,{label:"Active Today",value:s.activeToday,icon:"✅",color:"green"}),a.jsx(W,{label:"Avg Battery",value:`${s.avgBattery}%`,icon:"\uD83D\uDD0B",color:s.avgBattery>50?"green":"yellow"}),a.jsx(W,{label:"Nexus Health",value:`${s.nexusIntegrity}%`,icon:"\uD83C\uDF10",color:s.nexusIntegrity>70?"green":"red"})]}),s.studentsInCrisis>0&&a.jsx("div",{className:"bg-red-500/10 border border-red-500/30 rounded-xl p-4 mb-6",children:(0,a.jsxs)("p",{className:"text-red-400 font-medium",children:["⚠️ ",s.studentsInCrisis," student(s) below 20% - may need support"]})}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-zinc-800/50 rounded-xl p-4",children:[a.jsx("h3",{className:"text-zinc-400 text-sm mb-3",children:"\uD83C\uDF1F Top Performers"}),s.topPerformers.map((e,s)=>(0,a.jsxs)("div",{className:"flex justify-between py-2 border-b border-zinc-700 last:border-0",children:[a.jsx("span",{className:"text-white",children:e.name}),(0,a.jsxs)("span",{className:"text-green-400",children:[e.battery,"%"]})]},s))]}),(0,a.jsxs)("div",{className:"bg-zinc-800/50 rounded-xl p-4",children:[a.jsx("h3",{className:"text-zinc-400 text-sm mb-3",children:"\uD83D\uDCAC May Need Support"}),s.needsSupport.map((e,s)=>(0,a.jsxs)("div",{className:"flex justify-between py-2 border-b border-zinc-700 last:border-0",children:[a.jsx("span",{className:"text-white",children:e.name}),(0,a.jsxs)("span",{className:"text-red-400",children:[e.battery,"%"]})]},s))]})]})]}),"students"===r&&a.jsx("p",{className:"text-zinc-500 text-center py-8",children:"Detailed student list view coming soon"}),"trends"===r&&a.jsx("p",{className:"text-zinc-500 text-center py-8",children:"Weekly trends visualization coming soon"})]}):a.jsx("div",{className:"animate-pulse bg-zinc-800 h-96 rounded-2xl"})}function W({label:e,value:s,icon:t,color:i="blue"}){return(0,a.jsxs)("div",{className:`rounded-xl p-4 border ${{blue:"bg-blue-500/10 border-blue-500/30",green:"bg-green-500/10 border-green-500/30",yellow:"bg-yellow-500/10 border-yellow-500/30",red:"bg-red-500/10 border-red-500/30"}[i]}`,children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("span",{children:t}),a.jsx("span",{className:"text-zinc-400 text-sm",children:e})]}),a.jsx("p",{className:"text-2xl font-bold text-white",children:s})]})}var F=t(9081),U=t(9696);let V=(0,d.Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);function J({classId:e,teacherId:s}){let[t,l]=(0,i.useState)([]),[d,o]=(0,i.useState)(!1),[m,u]=(0,i.useState)(!0),[h,p]=(0,i.useState)(!1),[f,j]=(0,i.useState)(""),[b,g]=(0,i.useState)(""),[v,y]=(0,i.useState)("normal"),[w,_]=(0,i.useState)(!1),[k,C]=(0,i.useState)(""),S=(0,r.createClient)(),z=async()=>{u(!0);let{data:s}=await S.from("announcements").select("*").eq("class_id",e).order("is_pinned",{ascending:!1}).order("created_at",{ascending:!1});l(s||[]),u(!1)},D=async()=>{f.trim()&&b.trim()&&(p(!0),await S.from("announcements").insert({class_id:e,teacher_id:s,title:f.trim(),content:b.trim(),priority:v,is_pinned:w,expires_at:k||null}),await S.from("student_activity_log").insert({class_id:e,activity_type:"announcement_created",activity_data:{title:f,priority:v}}),j(""),g(""),y("normal"),_(!1),C(""),o(!1),p(!1),z())},E=async e=>{await S.from("announcements").delete().eq("id",e),l(s=>s.filter(s=>s.id!==e))},M=async(e,s)=>{await S.from("announcements").update({is_pinned:!s}).eq("id",e),z()},A={normal:"bg-surface-800 border-surface-700",important:"bg-amber-900/20 border-amber-500/30",urgent:"bg-red-900/20 border-red-500/30"},I={normal:"badge bg-surface-700 text-surface-300",important:"badge bg-amber-500/20 text-amber-400",urgent:"badge bg-red-500/20 text-red-400"};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold text-surface-100 flex items-center gap-2",children:[a.jsx(N.Z,{className:"text-primary-400",size:24}),"Announcements"]}),(0,a.jsxs)("button",{onClick:()=>o(!d),className:"btn btn-primary",children:[a.jsx(F.Z,{size:18})," New Announcement"]})]}),a.jsx(c.M,{children:d&&(0,a.jsxs)(n.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"card p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"font-semibold text-surface-100",children:"Create Announcement"}),a.jsx("button",{onClick:()=>o(!1),className:"text-surface-500 hover:text-surface-300",children:a.jsx(Z.Z,{size:20})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Title"}),a.jsx("input",{type:"text",className:"input",placeholder:"Announcement title...",value:f,onChange:e=>j(e.target.value)})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Content"}),a.jsx("textarea",{className:"input",rows:4,placeholder:"Write your announcement...",value:b,onChange:e=>g(e.target.value)})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Priority"}),(0,a.jsxs)("select",{className:"input",value:v,onChange:e=>y(e.target.value),children:[a.jsx("option",{value:"normal",children:"Normal"}),a.jsx("option",{value:"important",children:"Important"}),a.jsx("option",{value:"urgent",children:"Urgent"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Expires At (optional)"}),a.jsx("input",{type:"datetime-local",className:"input",value:k,onChange:e=>C(e.target.value)})]}),a.jsx("div",{className:"flex items-end",children:(0,a.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:w,onChange:e=>_(e.target.checked),className:"w-5 h-5 rounded"}),a.jsx("span",{className:"text-surface-200",children:"Pin to top"})]})})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>o(!1),className:"btn btn-secondary flex-1",children:"Cancel"}),a.jsx("button",{onClick:D,disabled:h||!f.trim()||!b.trim(),className:"btn btn-primary flex-1",children:h?"Creating...":"Create Announcement"})]})]})]})}),m?a.jsx("div",{className:"card p-8 text-center",children:a.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-primary-500 border-t-transparent rounded-full mx-auto"})}):0===t.length?(0,a.jsxs)("div",{className:"card p-12 text-center",children:[a.jsx(N.Z,{size:48,className:"mx-auto mb-4 text-surface-600"}),a.jsx("h3",{className:"text-xl font-semibold text-surface-300 mb-2",children:"No announcements"}),a.jsx("p",{className:"text-surface-500",children:"Create your first announcement to notify students."})]}):a.jsx("div",{className:"space-y-3",children:t.map(e=>a.jsx("div",{className:`card p-4 border ${A[e.priority]}`,children:(0,a.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[e.is_pinned&&a.jsx(U.Z,{size:14,className:"text-primary-400"}),"urgent"===e.priority&&a.jsx(x.Z,{size:14,className:"text-red-400"}),a.jsx("h3",{className:"font-semibold text-surface-100",children:e.title}),a.jsx("span",{className:I[e.priority],children:e.priority})]}),a.jsx("p",{className:"text-surface-400 text-sm",children:e.content}),(0,a.jsxs)("p",{className:"text-surface-600 text-xs mt-2",children:[new Date(e.created_at).toLocaleString(),e.expires_at&&` | Expires: ${new Date(e.expires_at).toLocaleString()}`]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>M(e.id,e.is_pinned),className:`p-2 rounded-lg transition-colors ${e.is_pinned?"bg-primary-500/20 text-primary-400":"text-surface-500 hover:text-surface-300 hover:bg-surface-800"}`,children:a.jsx(U.Z,{size:16})}),a.jsx("button",{onClick:()=>E(e.id),className:"p-2 text-surface-500 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",children:a.jsx(V,{size:16})})]})]})},e.id))})]})}var G=t(5618),X=t(6441);let Q=(0,d.Z)("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]),Y=(0,d.Z)("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);var K=t(6230),ee=t(4994);function es({classId:e,teacherId:s,studentCount:t}){let[l,d]=(0,i.useState)([]),[o,x]=(0,i.useState)(!1),[m,u]=(0,i.useState)(!0),[h,f]=(0,i.useState)(!1),[b,g]=(0,i.useState)(""),[v,y]=(0,i.useState)(""),[N,_]=(0,i.useState)("individual"),[k,C]=(0,i.useState)(50),[S,z]=(0,i.useState)(10),[D,E]=(0,i.useState)(""),M=(0,r.createClient)(),A=async()=>{u(!0);let{data:s}=await M.from("missions").select("*").eq("class_id",e).order("created_at",{ascending:!1}),{data:t}=await M.from("mission_completions").select("mission_id").in("mission_id",s?.map(e=>e.id)||[]),a={};t?.forEach(e=>{a[e.mission_id]=(a[e.mission_id]||0)+1}),d((s||[]).map(e=>({...e,completion_count:a[e.id]||0}))),u(!1)},I=async()=>{b.trim()&&v.trim()&&(f(!0),await M.from("missions").insert({class_id:e,teacher_id:s,title:b.trim(),description:v.trim(),mission_type:N,xp_reward:k,battery_reward:S,deadline:D||null,is_active:!0}),await M.from("student_activity_log").insert({class_id:e,activity_type:"mission_created",activity_data:{title:b,mission_type:N}}),g(""),y(""),_("individual"),C(50),z(10),E(""),x(!1),f(!1),A())},$=async(e,s)=>{await M.from("missions").update({is_active:!s}).eq("id",e),A()},P=async e=>{await M.from("missions").delete().eq("id",e),d(s=>s.filter(s=>s.id!==e))},q={individual:G.Z,team:p.Z,class:X.Z};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold text-surface-100 flex items-center gap-2",children:[a.jsx(w.Z,{className:"text-teal-400",size:24}),"Missions"]}),(0,a.jsxs)("button",{onClick:()=>x(!o),className:"btn btn-primary",children:[a.jsx(F.Z,{size:18})," New Mission"]})]}),a.jsx(c.M,{children:o&&(0,a.jsxs)(n.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"card p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"font-semibold text-surface-100",children:"Create Mission"}),a.jsx("button",{onClick:()=>x(!1),className:"text-surface-500 hover:text-surface-300",children:a.jsx(Z.Z,{size:20})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Mission Title"}),a.jsx("input",{type:"text",className:"input",placeholder:"e.g., Help 3 classmates today",value:b,onChange:e=>g(e.target.value)})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Description"}),a.jsx("textarea",{className:"input",rows:3,placeholder:"Describe what students need to do...",value:v,onChange:e=>y(e.target.value)})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Type"}),(0,a.jsxs)("select",{className:"input",value:N,onChange:e=>_(e.target.value),children:[a.jsx("option",{value:"individual",children:"Individual"}),a.jsx("option",{value:"team",children:"Team"}),a.jsx("option",{value:"class",children:"Class"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"XP Reward"}),a.jsx("input",{type:"number",className:"input",value:k,onChange:e=>C(parseInt(e.target.value)||0),min:0,max:500})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Battery Reward"}),a.jsx("input",{type:"number",className:"input",value:S,onChange:e=>z(parseInt(e.target.value)||0),min:0,max:50})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Deadline (optional)"}),a.jsx("input",{type:"datetime-local",className:"input",value:D,onChange:e=>E(e.target.value)})]})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>x(!1),className:"btn btn-secondary flex-1",children:"Cancel"}),a.jsx("button",{onClick:I,disabled:h||!b.trim()||!v.trim(),className:"btn btn-primary flex-1",children:h?"Creating...":"Create Mission"})]})]})]})}),m?a.jsx("div",{className:"card p-8 text-center",children:a.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-primary-500 border-t-transparent rounded-full mx-auto"})}):0===l.length?(0,a.jsxs)("div",{className:"card p-12 text-center",children:[a.jsx(w.Z,{size:48,className:"mx-auto mb-4 text-surface-600"}),a.jsx("h3",{className:"text-xl font-semibold text-surface-300 mb-2",children:"No missions"}),a.jsx("p",{className:"text-surface-500",children:"Create missions to motivate and challenge your students."})]}):a.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:l.map(e=>{let s=q[e.mission_type],i=t>0?Math.round((e.completion_count||0)/t*100):0;return(0,a.jsxs)("div",{className:`card p-4 ${e.is_active?"":"opacity-50"}`,children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-3 mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${"individual"===e.mission_type?"bg-blue-500/20 text-blue-400":"team"===e.mission_type?"bg-purple-500/20 text-purple-400":"bg-green-500/20 text-green-400"}`,children:a.jsx(s,{size:20})}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"font-semibold text-surface-100",children:e.title}),a.jsx("span",{className:"text-xs text-surface-500 capitalize",children:e.mission_type})]})]}),a.jsx("button",{onClick:()=>$(e.id,e.is_active),className:`p-2 rounded-lg transition-colors ${e.is_active?"text-green-400":"text-surface-500"}`,children:e.is_active?a.jsx(Q,{size:24}):a.jsx(Y,{size:24})})]}),a.jsx("p",{className:"text-surface-400 text-sm mb-3",children:e.description}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-sm mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 text-yellow-400",children:[a.jsx(j.Z,{size:14}),(0,a.jsxs)("span",{children:[e.xp_reward," XP"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1 text-teal-400",children:[a.jsx(K.Z,{size:14}),(0,a.jsxs)("span",{children:["+",e.battery_reward,"%"]})]}),e.deadline&&(0,a.jsxs)("div",{className:"flex items-center gap-1 text-surface-500",children:[a.jsx(ee.Z,{size:14}),a.jsx("span",{children:new Date(e.deadline).toLocaleDateString()})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1 mr-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-surface-500 mb-1",children:[a.jsx("span",{children:"Completions"}),(0,a.jsxs)("span",{children:[e.completion_count||0,"/",t]})]}),a.jsx("div",{className:"progress-bar",children:a.jsx("div",{className:"progress-fill bg-teal-500",style:{width:`${i}%`}})})]}),a.jsx("button",{onClick:()=>P(e.id),className:"text-surface-500 hover:text-red-400 text-xs",children:"Delete"})]})]},e.id)})})]})}var et=t(4521),ea=t(1746);function ei({classId:e,teacherId:s,studentCount:t}){let[l,d]=(0,i.useState)([]),[o,x]=(0,i.useState)(!1),[m,u]=(0,i.useState)(!0),[h,p]=(0,i.useState)(!1),[j,b]=(0,i.useState)(null),[g,v]=(0,i.useState)(""),[y,N]=(0,i.useState)("video"),[w,_]=(0,i.useState)(""),[k,S]=(0,i.useState)(""),[z,D]=(0,i.useState)(""),[E,M]=(0,i.useState)(""),A=(0,r.createClient)(),I=async()=>{u(!0);let{data:s}=await A.from("media_lessons").select("*").eq("class_id",e).order("created_at",{ascending:!1}),{data:t}=await A.from("media_lesson_completions").select("media_lesson_id, watched_video, read_content, socratic_completed").in("media_lesson_id",s?.map(e=>e.id)||[]),a={};t?.forEach(e=>{a[e.media_lesson_id]||(a[e.media_lesson_id]={watched:0,read:0,discussed:0}),e.watched_video&&a[e.media_lesson_id].watched++,e.read_content&&a[e.media_lesson_id].read++,e.socratic_completed&&a[e.media_lesson_id].discussed++}),d((s||[]).map(e=>({...e,completion_stats:a[e.id]||{watched:0,read:0,discussed:0}}))),u(!1)},$=async()=>{g.trim()&&("video"!==y||w.trim())&&("reading"!==y||k.trim())&&("both"!==y||w.trim()&&k.trim())&&(p(!0),await A.from("media_lessons").insert({class_id:e,teacher_id:s,title:g.trim(),media_type:y,video_url:w.trim()||null,reading_content:k.trim()||null,socratic_prompt:z.trim()||null,due_date:E||null,is_active:!0}),await A.from("student_activity_log").insert({class_id:e,activity_type:"media_lesson_created",activity_data:{title:g,media_type:y}}),v(""),N("video"),_(""),S(""),D(""),M(""),x(!1),p(!1),I())},P=async(e,s)=>{await A.from("media_lessons").update({is_active:!s}).eq("id",e),I()},q=async e=>{await A.from("media_lessons").delete().eq("id",e),d(s=>s.filter(s=>s.id!==e))};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold text-surface-100 flex items-center gap-2",children:[a.jsx(et.Z,{className:"text-purple-400",size:24}),"Media Lessons"]}),(0,a.jsxs)("button",{onClick:()=>x(!o),className:"btn btn-primary",children:[a.jsx(F.Z,{size:18})," New Media Lesson"]})]}),a.jsx(c.M,{children:o&&(0,a.jsxs)(n.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"card p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"font-semibold text-surface-100",children:"Create Media Lesson"}),a.jsx("button",{onClick:()=>x(!1),className:"text-surface-500 hover:text-surface-300",children:a.jsx(Z.Z,{size:20})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Title"}),a.jsx("input",{type:"text",className:"input",placeholder:"Lesson title...",value:g,onChange:e=>v(e.target.value)})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Media Type"}),(0,a.jsxs)("select",{className:"input",value:y,onChange:e=>N(e.target.value),children:[a.jsx("option",{value:"video",children:"Video Only"}),a.jsx("option",{value:"reading",children:"Reading Only"}),a.jsx("option",{value:"both",children:"Video + Reading"})]})]})]}),("video"===y||"both"===y)&&(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Video URL (YouTube/Vimeo)"}),a.jsx("input",{type:"url",className:"input",placeholder:"https://youtube.com/watch?v=...",value:w,onChange:e=>_(e.target.value)})]}),("reading"===y||"both"===y)&&(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Reading Content"}),a.jsx("textarea",{className:"input",rows:6,placeholder:"Enter reading material...",value:k,onChange:e=>S(e.target.value)})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Socratic Prompt (for AI discussion after consuming media)"}),a.jsx("textarea",{className:"input",rows:3,placeholder:"What questions should the AI guide students through after they finish? e.g., 'Help students reflect on how the concepts in this video apply to their leadership journey...'",value:z,onChange:e=>D(e.target.value)})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Due Date (optional)"}),a.jsx("input",{type:"datetime-local",className:"input w-auto",value:E,onChange:e=>M(e.target.value)})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>x(!1),className:"btn btn-secondary flex-1",children:"Cancel"}),a.jsx("button",{onClick:$,disabled:h||!g.trim(),className:"btn btn-primary flex-1",children:h?"Creating...":"Create Lesson"})]})]})]})}),m?a.jsx("div",{className:"card p-8 text-center",children:a.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-primary-500 border-t-transparent rounded-full mx-auto"})}):0===l.length?(0,a.jsxs)("div",{className:"card p-12 text-center",children:[a.jsx(et.Z,{size:48,className:"mx-auto mb-4 text-surface-600"}),a.jsx("h3",{className:"text-xl font-semibold text-surface-300 mb-2",children:"No media lessons"}),a.jsx("p",{className:"text-surface-500",children:"Create video or reading lessons with AI-powered discussions."})]}):a.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:l.map(e=>(0,a.jsxs)("div",{className:`card p-4 ${e.is_active?"":"opacity-50"}`,children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-3 mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${"video"===e.media_type?"bg-red-500/20 text-red-400":"reading"===e.media_type?"bg-blue-500/20 text-blue-400":"bg-purple-500/20 text-purple-400"}`,children:"video"===e.media_type?a.jsx(et.Z,{size:20}):"reading"===e.media_type?a.jsx(f.Z,{size:20}):(0,a.jsxs)(a.Fragment,{children:[a.jsx(et.Z,{size:14}),a.jsx(f.Z,{size:14})]})}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"font-semibold text-surface-100",children:e.title}),a.jsx("span",{className:"text-xs text-surface-500 capitalize",children:e.media_type})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:()=>b(e),className:"p-2 text-surface-500 hover:text-surface-300 rounded-lg transition-colors",children:a.jsx(ea.Z,{size:16})}),a.jsx("button",{onClick:()=>P(e.id,e.is_active),className:`p-2 rounded-lg transition-colors ${e.is_active?"text-green-400":"text-surface-500"}`,children:e.is_active?a.jsx(Q,{size:24}):a.jsx(Y,{size:24})})]})]}),e.socratic_prompt&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-purple-400 mb-3",children:[a.jsx(C.Z,{size:14}),a.jsx("span",{children:"AI Discussion Enabled"})]}),e.due_date&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-surface-500 mb-3",children:[a.jsx(ee.Z,{size:14}),(0,a.jsxs)("span",{children:["Due: ",new Date(e.due_date).toLocaleDateString()]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-center text-xs mb-3",children:[("video"===e.media_type||"both"===e.media_type)&&(0,a.jsxs)("div",{className:"p-2 bg-surface-800 rounded-lg",children:[a.jsx("div",{className:"text-lg font-bold text-red-400",children:e.completion_stats?.watched||0}),a.jsx("div",{className:"text-surface-500",children:"Watched"})]}),("reading"===e.media_type||"both"===e.media_type)&&(0,a.jsxs)("div",{className:"p-2 bg-surface-800 rounded-lg",children:[a.jsx("div",{className:"text-lg font-bold text-blue-400",children:e.completion_stats?.read||0}),a.jsx("div",{className:"text-surface-500",children:"Read"})]}),(0,a.jsxs)("div",{className:"p-2 bg-surface-800 rounded-lg",children:[a.jsx("div",{className:"text-lg font-bold text-purple-400",children:e.completion_stats?.discussed||0}),a.jsx("div",{className:"text-surface-500",children:"Discussed"})]})]}),a.jsx("button",{onClick:()=>q(e.id),className:"text-surface-500 hover:text-red-400 text-xs",children:"Delete"})]},e.id))}),a.jsx(c.M,{children:j&&a.jsx(n.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",onClick:()=>b(null),children:(0,a.jsxs)(n.E.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-surface-900 rounded-2xl w-full max-w-2xl max-h-[80vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"p-4 border-b border-surface-800 flex items-center justify-between sticky top-0 bg-surface-900",children:[a.jsx("h2",{className:"font-semibold text-surface-100",children:j.title}),a.jsx("button",{onClick:()=>b(null),className:"text-surface-500 hover:text-surface-300",children:a.jsx(Z.Z,{size:20})})]}),(0,a.jsxs)("div",{className:"p-6 space-y-4",children:[j.video_url&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-semibold text-surface-200 mb-2 flex items-center gap-2",children:[a.jsx(et.Z,{size:16,className:"text-red-400"})," Video"]}),a.jsx("p",{className:"text-surface-400 text-sm break-all",children:j.video_url})]}),j.reading_content&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-semibold text-surface-200 mb-2 flex items-center gap-2",children:[a.jsx(f.Z,{size:16,className:"text-blue-400"})," Reading Content"]}),a.jsx("div",{className:"p-4 bg-surface-800 rounded-lg text-surface-300 text-sm whitespace-pre-wrap max-h-60 overflow-y-auto",children:j.reading_content})]}),j.socratic_prompt&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-semibold text-surface-200 mb-2 flex items-center gap-2",children:[a.jsx(C.Z,{size:16,className:"text-purple-400"})," Socratic Prompt"]}),a.jsx("div",{className:"p-4 bg-purple-500/10 border border-purple-500/20 rounded-lg text-surface-300 text-sm",children:j.socratic_prompt})]})]})]})})})]})}let er=(0,d.Z)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),el=(0,d.Z)("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);function en({classId:e}){let[s,t]=(0,i.useState)([]),[l,d]=(0,i.useState)(""),[o,x]=(0,i.useState)(!0),[u,h]=(0,i.useState)(!1),[f,j]=(0,i.useState)(""),[b,g]=(0,i.useState)(!1),[v,y]=(0,i.useState)([]),[N,w]=(0,i.useState)(null),[_,k]=(0,i.useState)(null),C=(0,r.createClient)(),S=async()=>{x(!0);let{data:s}=await C.from("users").select("id, name, pin_hash, created_at").eq("class_id",e).eq("role","student").order("name"),{data:a}=await C.from("student_cores").select("student_id, battery_level, streak_count, last_active").in("student_id",s?.map(e=>e.id)||[]),i={};a?.forEach(e=>{i[e.student_id]=e}),t((s||[]).map(e=>({...e,battery_level:i[e.id]?.battery_level||0,streak:i[e.id]?.streak_count||0,last_active:i[e.id]?.last_active}))),x(!1)},z=()=>Math.floor(1e3+9e3*Math.random()).toString(),M=async e=>{let s=new TextEncoder().encode(e);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",s))).map(e=>e.toString(16).padStart(2,"0")).join("")},A=async()=>{let s=f.split("\n").map(e=>e.trim()).filter(e=>e.length>0);if(0===s.length)return;g(!0);let t=[];for(let a of s){let s=z(),i=await M(s);await C.from("users").insert({name:a,class_id:e,role:"student",pin_hash:i}),t.push({name:a,pin:s})}y(t),g(!1),j(""),S()},I=async e=>{w(e);let s=z(),t=await M(s);await C.from("users").update({pin_hash:t}).eq("id",e),k(s),w(null),S()},$=async(e,s)=>{confirm(`Are you sure you want to remove ${s} from the class?`)&&(await C.from("users").delete().eq("id",e),t(s=>s.filter(s=>s.id!==e)))},q=s.filter(e=>e.name.toLowerCase().includes(l.toLowerCase())),T=e=>{if(!e)return"Never";let s=Math.floor((Date.now()-new Date(e).getTime())/6e4);if(s<60)return`${s}m ago`;let t=Math.floor(s/60);return t<24?`${t}h ago`:`${Math.floor(t/24)}d ago`};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold text-surface-100 flex items-center gap-2",children:[a.jsx(p.Z,{className:"text-blue-400",size:24}),"Student Roster (",s.length,")"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:S,className:"btn btn-secondary",children:a.jsx(m.Z,{size:16})}),(0,a.jsxs)("button",{onClick:()=>h(!0),className:"btn btn-primary",children:[a.jsx(er,{size:18})," Bulk Add"]})]})]}),(0,a.jsxs)("div",{className:"relative",children:[a.jsx(E,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-surface-500",size:18}),a.jsx("input",{type:"text",placeholder:"Search students...",className:"input pl-10 w-full md:w-64",value:l,onChange:e=>d(e.target.value)})]}),o?a.jsx("div",{className:"card p-8 text-center",children:a.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-primary-500 border-t-transparent rounded-full mx-auto"})}):0===q.length?(0,a.jsxs)("div",{className:"card p-12 text-center",children:[a.jsx(p.Z,{size:48,className:"mx-auto mb-4 text-surface-600"}),a.jsx("h3",{className:"text-xl font-semibold text-surface-300 mb-2",children:"No students found"}),a.jsx("p",{className:"text-surface-500",children:"Add students using the Bulk Add button above."})]}):a.jsx("div",{className:"card overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full min-w-[700px]",children:[a.jsx("thead",{className:"bg-surface-800",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"text-left px-4 py-3 text-surface-400 font-medium text-sm",children:"Student"}),a.jsx("th",{className:"text-center px-4 py-3 text-surface-400 font-medium text-sm",children:"Battery"}),a.jsx("th",{className:"text-center px-4 py-3 text-surface-400 font-medium text-sm",children:"Streak"}),a.jsx("th",{className:"text-center px-4 py-3 text-surface-400 font-medium text-sm",children:"Last Active"}),a.jsx("th",{className:"text-center px-4 py-3 text-surface-400 font-medium text-sm",children:"Actions"})]})}),a.jsx("tbody",{children:q.map(e=>(0,a.jsxs)("tr",{className:"border-t border-surface-800 hover:bg-surface-800/50",children:[a.jsx("td",{className:"px-4 py-3",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-primary-500 to-purple-500 flex items-center justify-center text-white font-bold",children:e.name[0]?.toUpperCase()}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-surface-200 font-medium",children:e.name}),(0,a.jsxs)("p",{className:"text-xs text-surface-500",children:["Joined ",new Date(e.created_at).toLocaleDateString()]})]})]})}),a.jsx("td",{className:"px-4 py-3 text-center",children:(0,a.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[a.jsx(K.Z,{size:16,className:e.battery_level>50?"text-green-400":e.battery_level>20?"text-yellow-400":"text-red-400"}),(0,a.jsxs)("span",{className:"text-surface-200",children:[e.battery_level||0,"%"]})]})}),a.jsx("td",{className:"px-4 py-3 text-center",children:(0,a.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[a.jsx(P,{size:16,className:"text-orange-400"}),a.jsx("span",{className:"text-surface-200",children:e.streak||0})]})}),a.jsx("td",{className:"px-4 py-3 text-center",children:(0,a.jsxs)("div",{className:"flex items-center justify-center gap-1 text-surface-400",children:[a.jsx(D.Z,{size:14}),a.jsx("span",{className:"text-sm",children:T(e.last_active)})]})}),a.jsx("td",{className:"px-4 py-3",children:(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[a.jsx("button",{onClick:()=>I(e.id),disabled:N===e.id,className:"p-2 text-surface-500 hover:text-yellow-400 hover:bg-yellow-500/10 rounded-lg transition-colors",title:"Reset PIN",children:a.jsx(el,{size:16})}),a.jsx("button",{onClick:()=>$(e.id,e.name),className:"p-2 text-surface-500 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",title:"Remove Student",children:a.jsx(V,{size:16})})]})})]},e.id))})]})}),a.jsx(c.M,{children:_&&a.jsx(n.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",onClick:()=>k(null),children:(0,a.jsxs)(n.E.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-surface-900 rounded-2xl p-6 max-w-sm text-center",onClick:e=>e.stopPropagation(),children:[a.jsx(el,{size:48,className:"mx-auto mb-4 text-yellow-400"}),a.jsx("h3",{className:"text-xl font-bold text-surface-100 mb-2",children:"New PIN Generated"}),a.jsx("p",{className:"text-surface-400 mb-4",children:"Share this PIN with the student:"}),a.jsx("div",{className:"text-4xl font-mono font-bold text-primary-400 bg-surface-800 rounded-xl py-4 mb-4",children:_}),a.jsx("button",{onClick:()=>k(null),className:"btn btn-primary w-full",children:"Done"})]})})}),a.jsx(c.M,{children:u&&a.jsx(n.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",onClick:()=>{h(!1),y([])},children:(0,a.jsxs)(n.E.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-surface-900 rounded-2xl w-full max-w-lg max-h-[80vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"p-4 border-b border-surface-800 flex items-center justify-between sticky top-0 bg-surface-900",children:[a.jsx("h2",{className:"font-semibold text-surface-100",children:"Bulk Add Students"}),a.jsx("button",{onClick:()=>{h(!1),y([])},className:"text-surface-500 hover:text-surface-300",children:a.jsx(Z.Z,{size:20})})]}),a.jsx("div",{className:"p-6 space-y-4",children:0===v.length?(0,a.jsxs)(a.Fragment,{children:[a.jsx("p",{className:"text-surface-400 text-sm",children:"Enter one student name per line. PINs will be auto-generated."}),a.jsx("textarea",{className:"input",rows:8,placeholder:"John Smith Jane Doe Alex Johnson",value:f,onChange:e=>j(e.target.value)}),(0,a.jsxs)("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>h(!1),className:"btn btn-secondary flex-1",children:"Cancel"}),a.jsx("button",{onClick:A,disabled:b||!f.trim(),className:"btn btn-primary flex-1",children:b?"Adding...":"Add Students"})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"p-4 bg-green-500/10 border border-green-500/30 rounded-lg",children:[a.jsx("p",{className:"text-green-400 font-semibold",children:"Students Added Successfully!"}),a.jsx("p",{className:"text-surface-400 text-sm mt-1",children:"Save these PINs - they cannot be recovered later."})]}),a.jsx("div",{className:"space-y-2",children:v.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-surface-800 rounded-lg",children:[a.jsx("span",{className:"text-surface-200",children:e.name}),a.jsx("span",{className:"font-mono text-primary-400 font-bold",children:e.pin})]},s))}),a.jsx("button",{onClick:()=>{h(!1),y([])},className:"btn btn-primary w-full",children:"Done"})]})})]})})})]})}let ec={do_now_started:{icon:t(6596).Z,color:"text-blue-400",label:()=>"started Do Now"},do_now_complete:{icon:C.Z,color:"text-green-400",label:()=>"completed Do Now"},mission_completed:{icon:w.Z,color:"text-teal-400",label:e=>`completed mission "${e?.title||"Unknown"}"`},media_lesson_started:{icon:et.Z,color:"text-red-400",label:e=>`started media lesson "${e?.title||"Unknown"}"`},media_lesson_complete:{icon:M.Z,color:"text-green-400",label:e=>`finished media lesson "${e?.title||"Unknown"}"`},socratic_complete:{icon:C.Z,color:"text-purple-400",label:()=>"completed Socratic discussion"},battery_update:{icon:K.Z,color:"text-yellow-400",label:e=>`battery at ${e?.level||0}%`},scenario_complete:{icon:j.Z,color:"text-orange-400",label:()=>"completed Scenario"},challenge_submitted:{icon:w.Z,color:"text-pink-400",label:()=>"submitted Real-World Challenge"},announcement_created:{icon:N.Z,color:"text-primary-400",label:e=>`New announcement: "${e?.title||"Unknown"}"`},mission_created:{icon:w.Z,color:"text-teal-400",label:e=>`New mission created: "${e?.title||"Unknown"}"`},media_lesson_created:{icon:et.Z,color:"text-purple-400",label:e=>`New media lesson: "${e?.title||"Unknown"}"`}};function ed({classId:e,students:s}){let[t,l]=(0,i.useState)([]),[d,o]=(0,i.useState)(!0),[x,u]=(0,i.useState)(!0),[h,p]=(0,i.useState)(new Date),f=(0,r.createClient)(),j=(0,i.useCallback)(async()=>{let{data:t}=await f.from("student_activity_log").select("*").eq("class_id",e).order("created_at",{ascending:!1}).limit(50),a=new Map(s.map(e=>[e.id,e.name]));l((t||[]).map(e=>({...e,student_name:a.get(e.student_id)||"System"}))),p(new Date),o(!1)},[e,s,f]),b=e=>{let s=Math.floor((Date.now()-new Date(e).getTime())/1e3);if(s<60)return"just now";let t=Math.floor(s/60);if(t<60)return`${t}m ago`;let a=Math.floor(t/60);return a<24?`${a}h ago`:`${Math.floor(a/24)}d ago`};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold text-surface-100 flex items-center gap-2",children:[a.jsx(v,{className:"text-green-400",size:24}),"Live Activity Feed"]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("label",{className:"flex items-center gap-2 text-sm text-surface-400 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:x,onChange:e=>u(e.target.checked),className:"w-4 h-4 rounded"}),"Auto-refresh (30s)"]}),(0,a.jsxs)("button",{onClick:j,className:"btn btn-secondary btn-sm",children:[a.jsx(m.Z,{size:16})," Refresh"]})]})]}),(0,a.jsxs)("div",{className:"text-xs text-surface-500 flex items-center gap-2",children:[a.jsx(D.Z,{size:12}),"Last updated: ",h.toLocaleTimeString()]}),d?a.jsx("div",{className:"card p-8 text-center",children:a.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-primary-500 border-t-transparent rounded-full mx-auto"})}):0===t.length?(0,a.jsxs)("div",{className:"card p-12 text-center",children:[a.jsx(v,{size:48,className:"mx-auto mb-4 text-surface-600"}),a.jsx("h3",{className:"text-xl font-semibold text-surface-300 mb-2",children:"No activity yet"}),a.jsx("p",{className:"text-surface-500",children:"Student activity will appear here in real-time."})]}):a.jsx("div",{className:"space-y-2",children:a.jsx(c.M,{children:t.map((e,s)=>{let t=ec[e.activity_type]||{icon:v,color:"text-surface-400",label:()=>e.activity_type},i=t.icon;return(0,a.jsxs)(n.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.02*s},className:"card p-3 flex items-center gap-3",children:[a.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${t.color.replace("text-","bg-").replace("-400","-500/20")}`,children:a.jsx(i,{size:16,className:t.color})}),a.jsx("div",{className:"flex-1 min-w-0",children:(0,a.jsxs)("p",{className:"text-surface-200 text-sm",children:[a.jsx("span",{className:"font-semibold",children:e.student_name})," ",a.jsx("span",{className:"text-surface-400",children:t.label(e.activity_data)})]})}),a.jsx("span",{className:"text-xs text-surface-500 whitespace-nowrap",children:b(e.created_at)})]},e.id)})})})]})}function eo(){let[e,s]=(0,i.useState)(null),[t,d]=(0,i.useState)([]),[k,C]=(0,i.useState)(null),[S,z]=(0,i.useState)([]),[D,Z]=(0,i.useState)(null),[E,M]=(0,i.useState)([]),[A,I]=(0,i.useState)([]),[$,P]=(0,i.useState)({completed:0,total:0}),[q,T]=(0,i.useState)(!0),[L,R]=(0,i.useState)("overview"),[O,H]=(0,i.useState)(!1),[B,W]=(0,i.useState)(!1),F=(0,l.useRouter)(),U=(0,r.createClient)(),V=async e=>{W(!0);try{let{data:s}=await U.from("users").select("*").eq("class_id",e).eq("role","student").order("name");z(s||[]);let a=t.find(s=>s.id===e);if(a){let{data:e}=await U.from("lessons").select("*").eq("id",a.current_lesson_id).single();Z(e)}let{data:i}=await U.from("challenge_submissions").select("*").eq("class_id",e).eq("review_status","pending").order("submitted_at",{ascending:!1}),r=await Promise.all((i||[]).map(async e=>{let{data:s}=await U.from("users").select("id, name").eq("id",e.student_id).single(),{data:t}=await U.from("lessons").select("id, skill_name, phase_id").eq("id",e.lesson_id).single();return{...e,student:s,lesson:t}}));M(r);let{data:l}=await U.from("crisis_alerts").select("*").eq("class_id",e).eq("status","unread").order("created_at",{ascending:!1}),n=await Promise.all((l||[]).map(async e=>{let{data:s}=await U.from("users").select("id, name").eq("id",e.student_id).single();return{...e,student:s}}));I(n);let c=new Date().toISOString().split("T")[0],{data:d}=await U.from("do_now_sessions").select("id").eq("class_id",e).eq("date",c);P({completed:d?.length||0,total:s?.length||0})}catch(e){console.error("Error loading class data:",e)}finally{W(!1)}},G=async()=>{if(!k||!D)return;let e=Math.min(D.id+1,45);await U.from("classes").update({current_lesson_id:e}).eq("id",k.id);let s=S.map(s=>({student_id:s.id,lesson_id:e,class_id:k.id,status:"available"}));await U.from("student_lessons").upsert(s,{onConflict:"student_id,lesson_id"}),C({...k,current_lesson_id:e}),V(k.id)},X=async()=>{await U.auth.signOut(),F.push("/")},Q=async e=>{await U.from("crisis_alerts").update({status:"read"}).eq("id",e),I(s=>s.filter(s=>s.id!==e))};return q?a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-surface-950",children:a.jsx(n.E.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"w-16 h-16 border-4 border-primary-500 border-t-transparent rounded-full"})}):(0,a.jsxs)("div",{className:"min-h-screen bg-surface-950",children:[(0,a.jsxs)("header",{className:"bg-surface-900/95 backdrop-blur-md border-b border-surface-800 sticky top-0 z-50",children:[(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-3 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"text-3xl",children:"\uD83D\uDCDA"}),(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"font-bold text-surface-100 text-lg",children:"Teacher Dashboard"}),a.jsx("p",{className:"text-xs text-surface-500",children:e?.name})]})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>H(!O),className:"flex items-center gap-2 px-4 py-2 bg-surface-800 rounded-xl hover:bg-surface-700 transition-colors",children:[a.jsx("span",{className:"text-surface-200 font-medium",children:k?.name}),a.jsx(o,{size:16,className:"text-surface-400"})]}),a.jsx(c.M,{children:O&&a.jsx(n.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute top-full mt-2 left-0 bg-surface-800 rounded-xl border border-surface-700 shadow-xl overflow-hidden min-w-[200px] z-50",children:t.map(e=>(0,a.jsxs)("button",{onClick:()=>{C(e),H(!1)},className:`w-full px-4 py-3 text-left hover:bg-surface-700 transition-colors flex items-center justify-between ${k?.id===e.id?"bg-primary-500/10 text-primary-400":"text-surface-200"}`,children:[a.jsx("span",{children:e.name}),a.jsx("span",{className:"text-xs text-surface-500 font-mono",children:e.code})]},e.id))})})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[A.length>0&&(0,a.jsxs)(n.E.button,{onClick:()=>R("alerts"),className:"flex items-center gap-2 px-3 py-2 bg-courage/20 border border-courage/30 rounded-xl text-courage",animate:{scale:[1,1.05,1]},transition:{duration:2,repeat:1/0},children:[a.jsx(x.Z,{size:18}),(0,a.jsxs)("span",{className:"font-semibold",children:[A.length," Alert",1!==A.length?"s":""]})]}),a.jsx("button",{onClick:()=>k&&V(k.id),className:`p-2 text-surface-400 hover:text-surface-200 rounded-lg hover:bg-surface-800 transition-all ${B?"animate-spin":""}`,children:a.jsx(m.Z,{size:20})}),a.jsx("button",{onClick:X,className:"p-2 text-surface-400 hover:text-surface-200 rounded-lg hover:bg-surface-800 transition-colors",children:a.jsx(u.Z,{size:20})})]})]}),a.jsx("div",{className:"max-w-7xl mx-auto px-4",children:(0,a.jsxs)("div",{className:"flex gap-1 -mb-px overflow-x-auto",children:[a.jsx(ex,{active:"overview"===L,onClick:()=>R("overview"),icon:h,label:"Overview"}),a.jsx(ex,{active:"students"===L,onClick:()=>R("students"),icon:p.Z,label:"Students"}),a.jsx(ex,{active:"curriculum"===L,onClick:()=>R("curriculum"),icon:f.Z,label:"Curriculum"}),a.jsx(ex,{active:"donow"===L,onClick:()=>R("donow"),icon:j.Z,label:"Do Now"}),a.jsx(ex,{active:"conversations"===L,onClick:()=>R("conversations"),icon:b,label:"AI Chats"}),a.jsx(ex,{active:"worlds"===L,onClick:()=>R("worlds"),icon:g,label:"Worlds"}),a.jsx(ex,{active:"metrics"===L,onClick:()=>R("metrics"),icon:v,label:"Metrics"}),a.jsx(ex,{active:"reviews"===L,onClick:()=>R("reviews"),icon:y.Z,label:"Reviews",badge:E.length}),a.jsx(ex,{active:"alerts"===L,onClick:()=>R("alerts"),icon:x.Z,label:"Alerts",badge:A.length,urgent:A.length>0}),a.jsx(ex,{active:"announcements"===L,onClick:()=>R("announcements"),icon:N.Z,label:"Announcements"}),a.jsx(ex,{active:"missions"===L,onClick:()=>R("missions"),icon:w.Z,label:"Missions"}),a.jsx(ex,{active:"media"===L,onClick:()=>R("media"),icon:et.Z,label:"Media"}),a.jsx(ex,{active:"roster"===L,onClick:()=>R("roster"),icon:p.Z,label:"Roster"}),a.jsx(ex,{active:"activity"===L,onClick:()=>R("activity"),icon:v,label:"Activity"}),a.jsx(ex,{active:"settings"===L,onClick:()=>R("settings"),icon:_,label:"Settings"})]})})]}),a.jsx("main",{className:"max-w-7xl mx-auto px-4 py-6",children:(0,a.jsxs)(c.M,{mode:"wait",children:["overview"===L&&a.jsx(em,{currentLesson:D,students:S,doNowStats:$,pendingReviews:E.length,selectedClass:k,onAdvanceLesson:G}),"reviews"===L&&a.jsx(eh,{reviews:E,onReviewComplete:()=>k&&V(k.id)}),"students"===L&&a.jsx(ef,{students:S,classId:k?.id,currentLessonId:D?.id||1}),"curriculum"===L&&a.jsx(eg,{classId:k?.id,currentLessonId:D?.id||1}),"donow"===L&&a.jsx(ev,{classId:k?.id,students:S}),"conversations"===L&&a.jsx(ey,{classId:k?.id,students:S}),"worlds"===L&&a.jsx(eN,{classId:k?.id,students:S}),"metrics"===L&&a.jsx(ew,{classId:k?.id,students:S,currentLessonId:D?.id||1}),"alerts"===L&&a.jsx(eb,{alerts:A,onMarkRead:Q}),"settings"===L&&a.jsx(e_,{selectedClass:k,classes:t}),"announcements"===L&&k&&e&&a.jsx(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:a.jsx(J,{classId:k.id,teacherId:e.id})},"announcements"),"missions"===L&&k&&e&&a.jsx(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:a.jsx(es,{classId:k.id,teacherId:e.id,studentCount:S.length})},"missions"),"media"===L&&k&&e&&a.jsx(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:a.jsx(ei,{classId:k.id,teacherId:e.id,studentCount:S.length})},"media"),"roster"===L&&k&&a.jsx(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:a.jsx(en,{classId:k.id})},"roster"),"activity"===L&&k&&a.jsx(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:a.jsx(ed,{classId:k.id,students:S})},"activity")]})})]})}function ex({active:e,onClick:s,icon:t,label:i,badge:r,urgent:l}){return(0,a.jsxs)("button",{onClick:s,className:`flex items-center gap-2 px-4 py-3 font-medium transition-all border-b-2 ${e?"text-primary-400 border-primary-500 bg-primary-500/5":"text-surface-400 border-transparent hover:text-surface-200 hover:bg-surface-800/50"}`,children:[a.jsx(t,{size:18}),i,void 0!==r&&r>0&&a.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full font-semibold ${l?"bg-courage text-white":"bg-surface-700 text-surface-300"}`,children:r})]})}function em({currentLesson:e,students:s,doNowStats:t,pendingReviews:i,selectedClass:r,onAdvanceLesson:l}){return(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[a.jsx("div",{className:`card p-6 phase-${e?.phase_id}`,children:(0,a.jsxs)("div",{className:"flex items-start justify-between gap-4 flex-wrap",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-[300px]",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2 flex-wrap",children:[(0,a.jsxs)("span",{className:`badge badge-${{1:"care",2:"creation",3:"courage",4:"community"}[e?.phase_id]}`,children:["Phase ",e?.phase_id,": ",{1:"Hardware",2:"Direction",3:"Toolbelt",4:"Blueprint"}[e?.phase_id]]}),(0,a.jsxs)("span",{className:"text-surface-500 text-sm",children:["Lesson ",e?.id," of 45"]})]}),a.jsx("h2",{className:"text-2xl font-bold text-surface-100 mb-2",children:e?.skill_name}),(0,a.jsxs)("p",{className:"text-surface-400 italic",children:['"',e?.compelling_question,'"']})]}),(0,a.jsxs)(n.E.button,{onClick:l,className:"btn btn-primary",whileHover:{scale:1.05},whileTap:{scale:.95},disabled:e?.id===45,children:["Advance to Next Lesson ",a.jsx(k.Z,{size:18})]})]})}),(0,a.jsxs)("div",{className:"grid md:grid-cols-4 gap-4",children:[a.jsx(eu,{icon:p.Z,label:"Students",value:s.length,color:"primary"}),a.jsx(eu,{icon:C.Z,label:"Do Now Today",value:`${t.completed}/${t.total}`,color:"care",progress:t.completed/Math.max(t.total,1)*100}),a.jsx(eu,{icon:y.Z,label:"Pending Reviews",value:i,color:"creation"}),a.jsx(eu,{icon:S,label:"Course Progress",value:`${Math.round((e?.id||1)/45*100)}%`,color:"community",progress:(e?.id||1)/45*100})]}),r&&a.jsx(B,{classId:r.id}),(0,a.jsxs)("div",{className:"card p-6",children:[(0,a.jsxs)("h3",{className:"font-semibold text-surface-100 mb-4 flex items-center gap-2",children:[a.jsx(z.Z,{className:"text-primary-400",size:20}),"Class Join Code"]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 flex-wrap",children:[a.jsx("div",{className:"px-6 py-4 bg-surface-800 rounded-xl border-2 border-dashed border-surface-600",children:a.jsx("span",{className:"text-4xl font-mono font-bold tracking-widest text-primary-400",children:r?.code})}),(0,a.jsxs)("div",{className:"text-surface-400 text-sm",children:[a.jsx("p",{children:"Share this code with students to join the class."}),a.jsx("p",{className:"mt-1",children:"Students enter their name + this code + create a PIN."})]})]})]})]},"overview")}function eu({icon:e,label:s,value:t,color:i,progress:r}){return(0,a.jsxs)(n.E.div,{className:"card p-5",whileHover:{scale:1.02},children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:`w-10 h-10 rounded-xl bg-${i}/20 flex items-center justify-center`,children:a.jsx(e,{className:`text-${i}`,size:20})}),a.jsx("span",{className:"text-surface-400 text-sm",children:s})]}),a.jsx("div",{className:"text-3xl font-bold text-surface-100",children:t}),void 0!==r&&a.jsx("div",{className:"mt-3 progress-bar",children:a.jsx("div",{className:`progress-fill bg-${i}`,style:{width:`${r}%`}})})]})}function eh({reviews:e,onReviewComplete:s}){let[t,r]=(0,i.useState)(null);return(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("h2",{className:"text-2xl font-bold text-surface-100",children:"Pending Reviews"}),(0,a.jsxs)("span",{className:"badge badge-creation",children:[e.length," pending"]})]}),0===e.length?(0,a.jsxs)("div",{className:"card p-12 text-center",children:[a.jsx(y.Z,{size:48,className:"mx-auto mb-4 text-surface-600"}),a.jsx("h3",{className:"text-xl font-semibold text-surface-300 mb-2",children:"All caught up!"}),a.jsx("p",{className:"text-surface-500",children:"No challenge submissions waiting for review."})]}):a.jsx("div",{className:"grid lg:grid-cols-2 gap-4",children:e.map(e=>(0,a.jsxs)(n.E.div,{className:"card p-5 cursor-pointer hover:border-primary-500/30",onClick:()=>r(e),whileHover:{scale:1.01},children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"font-semibold text-surface-100",children:e.student?.name}),(0,a.jsxs)("p",{className:"text-sm text-surface-500",children:["Lesson ",e.lesson_id,": ",e.lesson?.skill_name]})]}),(0,a.jsxs)("span",{className:"badge badge-primary",children:[a.jsx(D.Z,{size:12,className:"mr-1"}),new Date(e.submitted_at).toLocaleDateString()]})]}),a.jsx("p",{className:"text-surface-400 text-sm line-clamp-2",children:e.reflections?.["What I did"]||"No description provided"}),(0,a.jsxs)("button",{className:"btn btn-primary btn-sm mt-3",children:["Review ",a.jsx(k.Z,{size:16})]})]},e.id))}),a.jsx(c.M,{children:t&&a.jsx(ep,{review:t,onClose:()=>r(null),onComplete:()=>{r(null),s()}})})]},"reviews")}function ep({review:e,onClose:s,onComplete:t}){let[l,c]=(0,i.useState)(3),[d,o]=(0,i.useState)(""),[x,m]=(0,i.useState)(""),[u,h]=(0,i.useState)(!1),[p,f]=(0,i.useState)(!1),j=(0,r.createClient)(),b=async()=>{f(!0);try{await j.from("challenge_submissions").update({review_status:"reviewed",review_score:l,review_feedback:d,reviewed_at:new Date().toISOString(),approved_for_civic:u,civic_description:u?x:null}).eq("id",e.id),await j.from("world_states").update({trees:l>=3?1:0,tower:4===l?1:0}).eq("student_id",e.student_id),u&&x&&await j.from("civic_events").insert({class_id:e.class_id,phase_id:e.lesson?.phase_id||1,skill_name:e.lesson?.skill_name||"Unknown",skill_category:["care","creation","courage","community"][(e.lesson?.phase_id||1)-1],anonymized_description:x,event_type:"challenge_complete"}),t()}catch(e){console.error("Error submitting review:",e)}finally{f(!1)}};return a.jsx(n.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",onClick:s,children:(0,a.jsxs)(n.E.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-surface-900 rounded-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"p-4 border-b border-surface-800 flex items-center justify-between sticky top-0 bg-surface-900 z-10",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"font-semibold text-surface-100",children:[e.student?.name,"'s Challenge"]}),(0,a.jsxs)("p",{className:"text-sm text-surface-500",children:["Lesson ",e.lesson_id,": ",e.lesson?.skill_name]})]}),a.jsx("button",{onClick:s,className:"text-surface-500 hover:text-surface-300 p-1",children:a.jsx(Z.Z,{size:20})})]}),(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"font-semibold text-surface-200 mb-3",children:"Student's Response"}),(0,a.jsxs)("div",{className:"card p-4 bg-surface-800/50",children:[a.jsx("p",{className:"text-surface-300 whitespace-pre-wrap",children:e.reflections?.["What I did"]||"No description provided"}),e.reflections?.["Evidence/Proof"]&&(0,a.jsxs)("div",{className:"mt-3 pt-3 border-t border-surface-700",children:[a.jsx("span",{className:"text-xs text-surface-500 uppercase tracking-wide",children:"Evidence"}),a.jsx("p",{className:"text-surface-400 mt-1",children:e.reflections["Evidence/Proof"]})]})]})]}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"font-semibold text-surface-200 mb-3",children:"Mastery Score"}),a.jsx("div",{className:"grid grid-cols-4 gap-2",children:[1,2,3,4].map(e=>a.jsx("button",{onClick:()=>c(e),className:`p-4 rounded-xl text-center transition-all ${l===e?"bg-primary-500 text-white ring-2 ring-primary-400":"bg-surface-800 text-surface-400 hover:bg-surface-700"}`,children:a.jsx("div",{className:"text-2xl font-bold",children:e})},e))}),a.jsx("p",{className:"text-sm text-surface-400 mt-2 text-center",children:{1:"Developing - Needs more effort and depth",2:"Approaching - Shows understanding but incomplete",3:"Meeting - Solid demonstration of skill",4:"Exceeding - Exceptional application of skill"}[l]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Feedback for Student"}),a.jsx("textarea",{className:"input",rows:3,placeholder:"What did they do well? What could they improve?",value:d,onChange:e=>o(e.target.value)})]}),(0,a.jsxs)("div",{className:"card p-4 bg-community/10 border-community/30",children:[(0,a.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:u,onChange:e=>h(e.target.checked),className:"w-5 h-5 rounded bg-surface-800 border-surface-600"}),a.jsx("span",{className:"text-surface-200",children:"Share anonymized version in Civic World"})]}),u&&(0,a.jsxs)("div",{className:"mt-4",children:[a.jsx("label",{className:"label",children:"Write an anonymized description"}),a.jsx("textarea",{className:"input",rows:2,placeholder:"A student demonstrated active listening by...",value:x,onChange:e=>m(e.target.value)})]})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:s,className:"btn btn-secondary flex-1",children:"Cancel"}),a.jsx("button",{onClick:b,disabled:p,className:"btn btn-primary flex-1",children:p?"Submitting...":"Submit Review"})]})]})]})})}function ef({students:e,classId:s,currentLessonId:t}){let[l,c]=(0,i.useState)({}),[d,o]=(0,i.useState)("");(0,r.createClient)();let x=e.filter(e=>e.name.toLowerCase().includes(d.toLowerCase()));return(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold text-surface-100",children:["Students (",e.length,")"]}),(0,a.jsxs)("div",{className:"relative",children:[a.jsx(E,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-surface-500",size:18}),a.jsx("input",{type:"text",placeholder:"Search students...",className:"input pl-10 w-64",value:d,onChange:e=>o(e.target.value)})]})]}),0===x.length?(0,a.jsxs)("div",{className:"card p-12 text-center",children:[a.jsx(p.Z,{size:48,className:"mx-auto mb-4 text-surface-600"}),a.jsx("h3",{className:"text-xl font-semibold text-surface-300 mb-2",children:"No students yet"}),a.jsx("p",{className:"text-surface-500",children:"Share your class code with students to get started."})]}):a.jsx("div",{className:"card overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full min-w-[600px]",children:[a.jsx("thead",{className:"bg-surface-800",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"text-left px-4 py-3 text-surface-400 font-medium text-sm",children:"Student"}),a.jsx("th",{className:"text-center px-4 py-3 text-surface-400 font-medium text-sm",children:"Do Now"}),a.jsx("th",{className:"text-center px-4 py-3 text-surface-400 font-medium text-sm",children:"Text"}),a.jsx("th",{className:"text-center px-4 py-3 text-surface-400 font-medium text-sm",children:"Scenario"}),a.jsx("th",{className:"text-center px-4 py-3 text-surface-400 font-medium text-sm",children:"Challenge"}),a.jsx("th",{className:"text-center px-4 py-3 text-surface-400 font-medium text-sm",children:"Status"})]})}),a.jsx("tbody",{children:x.map(e=>{let s=l[e.id]||{};return(0,a.jsxs)("tr",{className:"border-t border-surface-800 hover:bg-surface-800/50",children:[a.jsx("td",{className:"px-4 py-3",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-primary-500 to-community flex items-center justify-center text-white font-bold text-sm",children:e.name[0]}),a.jsx("span",{className:"text-surface-200 font-medium",children:e.name})]})}),a.jsx("td",{className:"px-4 py-3 text-center",children:a.jsx(ej,{complete:s.do_now_complete})}),a.jsx("td",{className:"px-4 py-3 text-center",children:a.jsx(ej,{complete:s.text_anchor_complete})}),a.jsx("td",{className:"px-4 py-3 text-center",children:a.jsx(ej,{complete:s.scenario_complete})}),a.jsx("td",{className:"px-4 py-3 text-center",children:a.jsx(ej,{complete:s.challenge_complete})}),a.jsx("td",{className:"px-4 py-3 text-center",children:a.jsx("span",{className:`badge ${"complete"===s.status?"badge-care":"in_progress"===s.status?"badge-creation":"bg-surface-800 text-surface-500"}`,children:s.status||"Not started"})})]},e.id)})})]})})]},"students")}function ej({complete:e}){return a.jsx("div",{className:`w-6 h-6 rounded-full mx-auto flex items-center justify-center ${e?"bg-care/20":"bg-surface-800"}`,children:e?a.jsx(M.Z,{size:14,className:"text-care"}):a.jsx("div",{className:"w-2 h-2 rounded-full bg-surface-600"})})}function eb({alerts:e,onMarkRead:s}){let t={self_harm:{label:"Self-Harm Concern",color:"courage"},helplessness:{label:"Helplessness",color:"creation"},rage:{label:"Intense Anger",color:"courage"},abuse:{label:"Possible Abuse",color:"courage"}};return(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("h2",{className:"text-2xl font-bold text-surface-100",children:"Crisis Alerts"}),e.length>0&&(0,a.jsxs)("span",{className:"badge bg-courage text-white",children:[e.length," unread"]})]}),a.jsx("div",{className:"card p-4 bg-surface-800/50 border-surface-700",children:(0,a.jsxs)("p",{className:"text-surface-300 text-sm",children:[a.jsx("strong",{className:"text-surface-100",children:"Important:"})," These alerts are triggered when a student's conversation indicates they may be struggling. Reach out privately and consider involving school counselors."]})}),0===e.length?(0,a.jsxs)("div",{className:"card p-12 text-center",children:[a.jsx(M.Z,{size:48,className:"mx-auto mb-4 text-care"}),a.jsx("h3",{className:"text-xl font-semibold text-surface-300 mb-2",children:"No active alerts"}),a.jsx("p",{className:"text-surface-500",children:"All students appear to be doing well."})]}):a.jsx("div",{className:"space-y-4",children:e.map(e=>a.jsx(n.E.div,{className:"card p-5 border-courage/50 bg-courage/5",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:(0,a.jsxs)("div",{className:"flex items-start justify-between gap-4 flex-wrap",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2 flex-wrap",children:[a.jsx(x.Z,{className:"text-courage",size:20}),a.jsx("span",{className:`badge badge-${t[e.trigger_type]?.color||"courage"}`,children:t[e.trigger_type]?.label||e.trigger_type}),a.jsx("span",{className:"text-surface-500 text-sm",children:new Date(e.created_at).toLocaleString()})]}),a.jsx("h3",{className:"font-semibold text-surface-100 mb-2",children:e.student?.name}),a.jsx("div",{className:"bg-surface-900 rounded-xl p-4 border border-surface-700",children:(0,a.jsxs)("p",{className:"text-surface-300 text-sm italic",children:['"',e.trigger_text,'"']})})]}),a.jsx("button",{onClick:()=>s(e.id),className:"btn btn-secondary btn-sm",children:"Mark as Read"})]})},e.id))})]},"alerts")}function eg({classId:e,currentLessonId:s}){let[t,l]=(0,i.useState)([]),[d,o]=(0,i.useState)({}),[x,m]=(0,i.useState)({}),[u,h]=(0,i.useState)(null),[p,f]=(0,i.useState)(null),[j,b]=(0,i.useState)(""),[g,v]=(0,i.useState)(!1),[y,N]=(0,i.useState)(null),w=(0,r.createClient)(),_=async()=>{let{data:e}=await w.from("lessons").select("*").order("id");l(e||[]);let{data:s}=await w.from("scenarios").select("*"),t={};s?.forEach(e=>{t[e.lesson_id]=e}),o(t);let{data:a}=await w.from("challenges").select("*"),i={};a?.forEach(e=>{i[e.lesson_id]=e}),m(i)},k=(e,s)=>{h(e),f(s),"scenario"===s?b(d[e.id]?.situation_prompt||""):b(x[e.id]?.description||"")},C=async()=>{if(u&&p){v(!0);try{if("scenario"===p){let e=d[u.id];e?await w.from("scenarios").update({situation_prompt:j}).eq("id",e.id):await w.from("scenarios").insert({lesson_id:u.id,situation_prompt:j,reflection_questions:["What did you learn?","How can you apply this?"]})}else{let e=x[u.id];e?await w.from("challenges").update({description:j}).eq("id",e.id):await w.from("challenges").insert({lesson_id:u.id,description:j,difficulty:"medium",xp_reward:50,building_block_reward:"flower"})}await _(),f(null),h(null)}catch(e){console.error("Error saving:",e)}finally{v(!1)}}},S={1:"care",2:"creation",3:"courage",4:"community"},z={1:"Hardware",2:"Direction",3:"Toolbelt",4:"Blueprint"},D=y?t.filter(e=>e.phase_id===y):t;return(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[a.jsx("h2",{className:"text-2xl font-bold text-surface-100",children:"Curriculum Manager"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>N(null),className:`btn btn-sm ${y?"btn-secondary":"btn-primary"}`,children:"All"}),[1,2,3,4].map(e=>(0,a.jsxs)("button",{onClick:()=>N(e),className:`btn btn-sm ${y===e?"btn-primary":"btn-secondary"}`,children:["Phase ",e]},e))]})]}),a.jsx("div",{className:"grid gap-4",children:D.map(e=>{let t=!!d[e.id]?.situation_prompt,i=!!x[e.id]?.description,r=e.id===s;return(0,a.jsxs)("div",{className:`card p-4 ${r?"ring-2 ring-primary-500":""}`,children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-4 flex-wrap",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2 flex-wrap",children:[a.jsx("span",{className:`badge badge-${S[e.phase_id]}`,children:z[e.phase_id]}),(0,a.jsxs)("span",{className:"text-surface-500 text-sm",children:["Lesson ",e.id]}),r&&a.jsx("span",{className:"badge bg-primary-500 text-white",children:"Current"})]}),a.jsx("h3",{className:"font-semibold text-surface-100 mb-1",children:e.skill_name}),(0,a.jsxs)("p",{className:"text-surface-400 text-sm italic",children:['"',e.compelling_question,'"']})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>k(e,"scenario"),className:`btn btn-sm ${t?"btn-secondary":"bg-courage/20 text-courage border border-courage/30"}`,children:t?"✓ Scenario":"+ Scenario"}),a.jsx("button",{onClick:()=>k(e,"challenge"),className:`btn btn-sm ${i?"btn-secondary":"bg-creation/20 text-creation border border-creation/30"}`,children:i?"✓ Challenge":"+ Challenge"})]})]}),(t||i)&&(0,a.jsxs)("div",{className:"mt-4 pt-4 border-t border-surface-700 grid md:grid-cols-2 gap-4",children:[t&&(0,a.jsxs)("div",{className:"p-3 bg-surface-800/50 rounded-lg",children:[a.jsx("span",{className:"text-xs text-surface-500 uppercase tracking-wide",children:"Scenario"}),a.jsx("p",{className:"text-surface-300 text-sm mt-1 line-clamp-2",children:d[e.id]?.situation_prompt})]}),i&&(0,a.jsxs)("div",{className:"p-3 bg-surface-800/50 rounded-lg",children:[a.jsx("span",{className:"text-xs text-surface-500 uppercase tracking-wide",children:"Challenge"}),a.jsx("p",{className:"text-surface-300 text-sm mt-1 line-clamp-2",children:x[e.id]?.description})]})]})]},e.id)})}),a.jsx(c.M,{children:p&&u&&a.jsx(n.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",onClick:()=>f(null),children:(0,a.jsxs)(n.E.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-surface-900 rounded-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"p-4 border-b border-surface-800 flex items-center justify-between sticky top-0 bg-surface-900 z-10",children:[(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"font-semibold text-surface-100",children:"scenario"===p?"Edit Scenario":"Edit Challenge"}),(0,a.jsxs)("p",{className:"text-sm text-surface-500",children:["Lesson ",u.id,": ",u.skill_name]})]}),a.jsx("button",{onClick:()=>f(null),className:"text-surface-500 hover:text-surface-300 p-1",children:a.jsx(Z.Z,{size:20})})]}),(0,a.jsxs)("div",{className:"p-6 space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"scenario"===p?"Situation Prompt":"Challenge Description"}),a.jsx("textarea",{className:"input",rows:8,placeholder:"scenario"===p?"Describe a real-world situation that tests this skill...":"Describe the real-life challenge students should complete...",value:j,onChange:e=>b(e.target.value)}),a.jsx("p",{className:"text-xs text-surface-500 mt-2",children:"scenario"===p?"This situation will be presented to students in the Scenario pathway for them to analyze and respond to.":"This challenge encourages students to practice the skill in their real life and submit evidence of completion."})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>f(null),className:"btn btn-secondary flex-1",children:"Cancel"}),a.jsx("button",{onClick:C,disabled:g||!j.trim(),className:"btn btn-primary flex-1",children:g?"Saving...":"Save"})]})]})]})})})]},"curriculum")}function ev({classId:e,students:s}){let[t,l]=(0,i.useState)([]),[d,o]=(0,i.useState)(new Date().toISOString().split("T")[0]),[x,m]=(0,i.useState)(null),[u,h]=(0,i.useState)(!0);(0,r.createClient)(),s.map(e=>[e.id,e]);let p=new Set(t.map(e=>e.student_id));return(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[a.jsx("h2",{className:"text-2xl font-bold text-surface-100",children:"Do Now Manager"}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("input",{type:"date",value:d,onChange:e=>o(e.target.value),className:"input"}),(0,a.jsxs)("span",{className:"badge badge-care",children:[t.length,"/",s.length," completed"]})]})]}),(0,a.jsxs)("div",{className:"card p-4",children:[a.jsx("h3",{className:"font-semibold text-surface-100 mb-3",children:"Completion Status"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(e=>(0,a.jsxs)("div",{className:`px-3 py-2 rounded-lg text-sm ${p.has(e.id)?"bg-care/20 text-care border border-care/30":"bg-surface-800 text-surface-500"}`,children:[e.name," ",p.has(e.id)&&"✓"]},e.id))})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("h3",{className:"font-semibold text-surface-100",children:["Conversations (",t.length,")"]}),u?a.jsx("div",{className:"card p-8 text-center",children:a.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-primary-500 border-t-transparent rounded-full mx-auto"})}):0===t.length?(0,a.jsxs)("div",{className:"card p-8 text-center",children:[a.jsx(j.Z,{size:48,className:"mx-auto mb-4 text-surface-600"}),a.jsx("p",{className:"text-surface-400",children:"No Do Now sessions for this date"})]}):a.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:t.map(e=>(0,a.jsxs)("div",{className:"card p-4 cursor-pointer hover:border-primary-500/30",onClick:()=>m(e),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"font-semibold text-surface-100",children:e.student?.name}),a.jsx("span",{className:"text-xs text-surface-500",children:new Date(e.created_at).toLocaleTimeString()})]}),a.jsx("p",{className:"text-surface-400 text-sm line-clamp-2",children:e.messages?.[0]?.content||"No content"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsxs)("span",{className:"text-xs text-surface-500",children:[e.messages?.length||0," messages"]}),e.completed&&a.jsx("span",{className:"badge badge-care text-xs",children:"Complete"})]})]},e.id))})]}),a.jsx(c.M,{children:x&&a.jsx(n.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",onClick:()=>m(null),children:(0,a.jsxs)(n.E.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-surface-900 rounded-2xl w-full max-w-2xl max-h-[80vh] overflow-hidden",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"p-4 border-b border-surface-800 flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"font-semibold text-surface-100",children:[x.student?.name,"'s Do Now"]}),a.jsx("p",{className:"text-sm text-surface-500",children:new Date(x.created_at).toLocaleString()})]}),a.jsx("button",{onClick:()=>m(null),className:"text-surface-500 hover:text-surface-300",children:a.jsx(Z.Z,{size:20})})]}),a.jsx("div",{className:"p-4 overflow-y-auto max-h-[60vh] space-y-3",children:x.messages?.map((e,s)=>a.jsxs("div",{className:`p-3 rounded-xl ${"assistant"===e.role?"bg-primary-500/10 border border-primary-500/20":"bg-surface-800"}`,children:[a.jsx("span",{className:"text-xs text-surface-500 uppercase",children:"assistant"===e.role?"\uD83E\uDD16 AI":"\uD83D\uDC64 Student"}),a.jsx("p",{className:"text-surface-200 mt-1 whitespace-pre-wrap",children:e.content})]},s))})]})})})]},"donow")}function ey({classId:e,students:s}){let[t,l]=(0,i.useState)([]),[d,o]=(0,i.useState)(null),[x,m]=(0,i.useState)("all"),[u,h]=(0,i.useState)(!0);(0,r.createClient)();let p="all"===x?t:t.filter(e=>e.type===x);return(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[a.jsx("h2",{className:"text-2xl font-bold text-surface-100",children:"AI Conversations"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>m("all"),className:`btn btn-sm ${"all"===x?"btn-primary":"btn-secondary"}`,children:"All"}),a.jsx("button",{onClick:()=>m("do_now"),className:`btn btn-sm ${"do_now"===x?"btn-primary":"btn-secondary"}`,children:"Do Now"}),a.jsx("button",{onClick:()=>m("scenario"),className:`btn btn-sm ${"scenario"===x?"btn-primary":"btn-secondary"}`,children:"Scenarios"})]})]}),u?a.jsx("div",{className:"card p-12 text-center",children:a.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-primary-500 border-t-transparent rounded-full mx-auto"})}):0===p.length?(0,a.jsxs)("div",{className:"card p-12 text-center",children:[a.jsx(b,{size:48,className:"mx-auto mb-4 text-surface-600"}),a.jsx("h3",{className:"text-xl font-semibold text-surface-300 mb-2",children:"No conversations yet"}),a.jsx("p",{className:"text-surface-500",children:"Student AI conversations will appear here."})]}):a.jsx("div",{className:"space-y-3",children:p.map(e=>(0,a.jsxs)("div",{className:"card p-4 cursor-pointer hover:border-primary-500/30",onClick:()=>o(e),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-primary-500 to-community flex items-center justify-center text-white font-bold",children:e.student?.name?.[0]||"?"}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"font-semibold text-surface-100",children:e.student?.name||"Unknown"}),(0,a.jsxs)("p",{className:"text-sm text-surface-500",children:[e.messages?.length||0," messages • ",new Date(e.created_at).toLocaleDateString()]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:`badge ${"do_now"===e.type?"badge-care":"badge-courage"}`,children:"do_now"===e.type?"Do Now":"Scenario"}),a.jsx(k.Z,{size:16,className:"text-surface-500"})]})]}),e.messages?.[e.messages.length-1]&&a.jsx("p",{className:"text-surface-400 text-sm mt-3 line-clamp-2 pl-13",children:e.messages[e.messages.length-1].content})]},e.id))}),a.jsx(c.M,{children:d&&a.jsx(n.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",onClick:()=>o(null),children:(0,a.jsxs)(n.E.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-surface-900 rounded-2xl w-full max-w-2xl max-h-[80vh] overflow-hidden",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"p-4 border-b border-surface-800 flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"font-semibold text-surface-100",children:[d.student?.name,"'s Conversation"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx("span",{className:`badge text-xs ${"do_now"===d.type?"badge-care":"badge-courage"}`,children:"do_now"===d.type?"Do Now":"Scenario"}),a.jsx("span",{className:"text-xs text-surface-500",children:new Date(d.created_at).toLocaleString()})]})]}),a.jsx("button",{onClick:()=>o(null),className:"text-surface-500 hover:text-surface-300",children:a.jsx(Z.Z,{size:20})})]}),a.jsx("div",{className:"p-4 overflow-y-auto max-h-[60vh] space-y-3",children:d.messages?.map((e,s)=>a.jsxs("div",{className:`p-3 rounded-xl ${"assistant"===e.role?"bg-primary-500/10 border border-primary-500/20":"bg-surface-800"}`,children:[a.jsx("span",{className:"text-xs text-surface-500 uppercase",children:"assistant"===e.role?"\uD83E\uDD16 Socratic AI":"\uD83D\uDC64 Student"}),a.jsx("p",{className:"text-surface-200 mt-1 whitespace-pre-wrap",children:e.content})]},s))})]})})})]},"conversations")}function eN({classId:e,students:s}){let[t,l]=(0,i.useState)({}),[d,o]=(0,i.useState)({}),[x,u]=(0,i.useState)(null),[h,p]=(0,i.useState)(!0),f=(0,r.createClient)(),j=async()=>{if(!e)return;p(!0);let t=s.map(e=>e.id),[a,i]=await Promise.all([f.from("world_states").select("*").in("student_id",t),f.from("student_inventory").select("*").in("student_id",t)]),r={};a.data?.forEach(e=>{r[e.student_id]=e}),l(r);let n={};i.data?.forEach(e=>{n[e.student_id]||(n[e.student_id]=[]),n[e.student_id].push(e)}),o(n),p(!1)},b=e=>{let s=t[e]||{},a=d[e]||[];return(s.trees||0)+(s.tower||0)+a.length};return(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[a.jsx("h2",{className:"text-2xl font-bold text-surface-100",children:"Student Worlds"}),(0,a.jsxs)("button",{onClick:j,className:"btn btn-secondary btn-sm",children:[a.jsx(m.Z,{size:16})," Refresh"]})]}),h?a.jsx("div",{className:"card p-12 text-center",children:a.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-primary-500 border-t-transparent rounded-full mx-auto"})}):a.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(e=>{let s=t[e.id]||{},i=d[e.id]||[],r=b(e.id);return(0,a.jsxs)("div",{className:"card p-4 cursor-pointer hover:border-primary-500/30",onClick:()=>u(e),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-primary-500 to-community flex items-center justify-center text-white font-bold",children:e.name[0]}),a.jsx("span",{className:"font-semibold text-surface-100",children:e.name})]}),(0,a.jsxs)("span",{className:"badge badge-primary",children:[r," items"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-2 text-center",children:[(0,a.jsxs)("div",{className:"p-2 bg-surface-800 rounded-lg",children:[a.jsx("span",{className:"text-xl",children:"\uD83C\uDF33"}),a.jsx("p",{className:"text-xs text-surface-500 mt-1",children:s.trees||0})]}),(0,a.jsxs)("div",{className:"p-2 bg-surface-800 rounded-lg",children:[a.jsx("span",{className:"text-xl",children:"\uD83C\uDFDB️"}),a.jsx("p",{className:"text-xs text-surface-500 mt-1",children:s.tower||0})]}),(0,a.jsxs)("div",{className:"p-2 bg-surface-800 rounded-lg",children:[a.jsx("span",{className:"text-xl",children:"\uD83C\uDF38"}),a.jsx("p",{className:"text-xs text-surface-500 mt-1",children:i.filter(e=>"flower"===e.item_type).length})]}),(0,a.jsxs)("div",{className:"p-2 bg-surface-800 rounded-lg",children:[a.jsx("span",{className:"text-xl",children:"\uD83D\uDCE6"}),a.jsx("p",{className:"text-xs text-surface-500 mt-1",children:i.length})]})]})]},e.id)})}),a.jsx(c.M,{children:x&&a.jsx(n.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",onClick:()=>u(null),children:(0,a.jsxs)(n.E.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-surface-900 rounded-2xl w-full max-w-lg max-h-[80vh] overflow-hidden",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"p-4 border-b border-surface-800 flex items-center justify-between",children:[(0,a.jsxs)("h2",{className:"font-semibold text-surface-100",children:[x.name,"'s World"]}),a.jsx("button",{onClick:()=>u(null),className:"text-surface-500 hover:text-surface-300",children:a.jsx(Z.Z,{size:20})})]}),(0,a.jsxs)("div",{className:"p-4 space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"font-semibold text-surface-200 mb-2",children:"World State"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{className:"p-3 bg-surface-800 rounded-lg flex items-center gap-3",children:[a.jsx("span",{className:"text-2xl",children:"\uD83C\uDF33"}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-surface-400 text-xs",children:"Trees"}),a.jsx("p",{className:"text-surface-100 font-bold",children:t[x.id]?.trees||0})]})]}),(0,a.jsxs)("div",{className:"p-3 bg-surface-800 rounded-lg flex items-center gap-3",children:[a.jsx("span",{className:"text-2xl",children:"\uD83C\uDFDB️"}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-surface-400 text-xs",children:"Towers"}),a.jsx("p",{className:"text-surface-100 font-bold",children:t[x.id]?.tower||0})]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-semibold text-surface-200 mb-2",children:["Inventory (",d[x.id]?.length||0," items)"]}),(0,a.jsxs)("div",{className:"max-h-48 overflow-y-auto space-y-2",children:[(d[x.id]||[]).map((e,s)=>(0,a.jsxs)("div",{className:"p-2 bg-surface-800 rounded-lg flex items-center justify-between",children:[a.jsx("span",{className:"text-surface-200",children:e.item_type}),(0,a.jsxs)("span",{className:"text-xs text-surface-500",children:["x",e.quantity||1]})]},s)),(!d[x.id]||0===d[x.id].length)&&a.jsx("p",{className:"text-surface-500 text-center py-4",children:"No items in inventory"})]})]})]})]})})})]},"worlds")}function ew({classId:e,students:s,currentLessonId:t}){let[l,c]=(0,i.useState)({}),[d,o]=(0,i.useState)(!0),u=(0,r.createClient)(),h=async()=>{if(!e)return;o(!0);let a=s.map(e=>e.id),i=new Date().toISOString().split("T")[0],r=new Date(Date.now()-6048e5).toISOString().split("T")[0],[l,n,d,x,m,h]=await Promise.all([u.from("do_now_sessions").select("id").eq("class_id",e).gte("created_at",`${i}T00:00:00`),u.from("do_now_sessions").select("id").eq("class_id",e).gte("created_at",`${r}T00:00:00`),u.from("challenge_submissions").select("id, review_status, review_score").eq("class_id",e),u.from("student_lessons").select("*").eq("class_id",e),u.from("crisis_alerts").select("id").eq("class_id",e).eq("status","unread"),u.from("world_states").select("*").in("student_id",a)]),p=(x.data||[]).filter(e=>"complete"===e.status).length,f=s.length*t,j=(d.data||[]).filter(e=>e.review_score).reduce((e,s,t,a)=>e+(s.review_score||0)/a.length,0);c({doNowToday:l.data?.length||0,doNowWeek:n.data?.length||0,totalChallenges:d.data?.length||0,pendingChallenges:(d.data||[]).filter(e=>"pending"===e.review_status).length,reviewedChallenges:(d.data||[]).filter(e=>"reviewed"===e.review_status).length,avgScore:j.toFixed(1),completedLessons:p,totalPossibleLessons:f,completionRate:f>0?Math.round(p/f*100):0,activeAlerts:m.data?.length||0,totalWorlds:h.data?.length||0}),o(!1)};return d?a.jsx(n.E.div,{className:"flex items-center justify-center py-20",children:a.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-primary-500 border-t-transparent rounded-full"})},"metrics"):(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[a.jsx("h2",{className:"text-2xl font-bold text-surface-100",children:"Class Metrics"}),(0,a.jsxs)("button",{onClick:h,className:"btn btn-secondary btn-sm",children:[a.jsx(m.Z,{size:16})," Refresh"]})]}),(0,a.jsxs)("div",{className:"grid md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"card p-5",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl bg-care/20 flex items-center justify-center",children:a.jsx(j.Z,{className:"text-care",size:20})}),a.jsx("span",{className:"text-surface-400 text-sm",children:"Do Now Today"})]}),(0,a.jsxs)("div",{className:"text-3xl font-bold text-surface-100",children:[l.doNowToday,"/",s.length]}),a.jsx("div",{className:"mt-2 progress-bar",children:a.jsx("div",{className:"progress-fill bg-care",style:{width:`${l.doNowToday/Math.max(s.length,1)*100}%`}})})]}),(0,a.jsxs)("div",{className:"card p-5",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl bg-creation/20 flex items-center justify-center",children:a.jsx(y.Z,{className:"text-creation",size:20})}),a.jsx("span",{className:"text-surface-400 text-sm",children:"Avg Score"})]}),a.jsx("div",{className:"text-3xl font-bold text-surface-100",children:l.avgScore||"-"}),a.jsx("p",{className:"text-surface-500 text-sm mt-1",children:"of 4.0 mastery"})]}),(0,a.jsxs)("div",{className:"card p-5",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl bg-primary/20 flex items-center justify-center",children:a.jsx(w.Z,{className:"text-primary-400",size:20})}),a.jsx("span",{className:"text-surface-400 text-sm",children:"Completion Rate"})]}),(0,a.jsxs)("div",{className:"text-3xl font-bold text-surface-100",children:[l.completionRate,"%"]}),a.jsx("div",{className:"mt-2 progress-bar",children:a.jsx("div",{className:"progress-fill bg-primary-500",style:{width:`${l.completionRate}%`}})})]}),(0,a.jsxs)("div",{className:"card p-5",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl bg-courage/20 flex items-center justify-center",children:a.jsx(x.Z,{className:"text-courage",size:20})}),a.jsx("span",{className:"text-surface-400 text-sm",children:"Active Alerts"})]}),a.jsx("div",{className:"text-3xl font-bold text-surface-100",children:l.activeAlerts}),a.jsx("p",{className:"text-surface-500 text-sm mt-1",children:"need attention"})]})]}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"card p-6",children:[(0,a.jsxs)("h3",{className:"font-semibold text-surface-100 mb-4 flex items-center gap-2",children:[a.jsx(C.Z,{size:20,className:"text-care"}),"Engagement This Week"]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-surface-400",children:"Do Now Sessions"}),a.jsx("span",{className:"font-semibold text-surface-100",children:l.doNowWeek})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-surface-400",children:"Challenge Submissions"}),a.jsx("span",{className:"font-semibold text-surface-100",children:l.totalChallenges})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-surface-400",children:"Pending Reviews"}),a.jsx("span",{className:"font-semibold text-creation",children:l.pendingChallenges})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-surface-400",children:"Reviewed"}),a.jsx("span",{className:"font-semibold text-care",children:l.reviewedChallenges})]})]})]}),(0,a.jsxs)("div",{className:"card p-6",children:[(0,a.jsxs)("h3",{className:"font-semibold text-surface-100 mb-4 flex items-center gap-2",children:[a.jsx(g,{size:20,className:"text-community"}),"World Building"]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-surface-400",children:"Active Worlds"}),a.jsx("span",{className:"font-semibold text-surface-100",children:l.totalWorlds})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-surface-400",children:"Students"}),a.jsx("span",{className:"font-semibold text-surface-100",children:s.length})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-surface-400",children:"Current Lesson"}),(0,a.jsxs)("span",{className:"font-semibold text-primary-400",children:["#",t]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-surface-400",children:"Course Progress"}),(0,a.jsxs)("span",{className:"font-semibold text-surface-100",children:[Math.round(t/45*100),"%"]})]})]})]})]}),(0,a.jsxs)("div",{className:"card p-6",children:[(0,a.jsxs)("h3",{className:"font-semibold text-surface-100 mb-4 flex items-center gap-2",children:[a.jsx(S,{size:20,className:"text-creation"}),"Student Progress Overview"]}),a.jsx("p",{className:"text-surface-400 text-sm mb-4",children:"Track individual student engagement and completion across all activities."}),(0,a.jsxs)("div",{className:"text-center py-8 text-surface-500",children:[a.jsx(v,{size:32,className:"mx-auto mb-2 opacity-50"}),a.jsx("p",{children:"Detailed student analytics coming soon"})]})]})]},"metrics")}function e_({selectedClass:e,classes:s}){return(0,a.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-surface-100",children:"Settings"}),e&&a.jsx(T,{classId:e.id}),(0,a.jsxs)("div",{className:"card p-6",children:[a.jsx("h3",{className:"font-semibold text-surface-100 mb-4",children:"Class Codes"}),a.jsx("div",{className:"space-y-3",children:s.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-surface-800/50 rounded-xl",children:[a.jsx("span",{className:"text-surface-200",children:e.name}),a.jsx("span",{className:"font-mono text-xl font-bold text-primary-400",children:e.code})]},e.id))})]}),(0,a.jsxs)("div",{className:"card p-6",children:[a.jsx("h3",{className:"font-semibold text-surface-100 mb-4",children:"Curriculum Overview"}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"p-4 bg-care/10 rounded-xl border border-care/30",children:[a.jsx("h4",{className:"font-semibold text-care mb-2",children:"Phase 1: Hardware"}),a.jsx("p",{className:"text-surface-400 text-sm",children:"Lessons 1-10: Self-Awareness, Attention, Impulse Control"})]}),(0,a.jsxs)("div",{className:"p-4 bg-creation/10 rounded-xl border border-creation/30",children:[a.jsx("h4",{className:"font-semibold text-creation mb-2",children:"Phase 2: Direction"}),a.jsx("p",{className:"text-surface-400 text-sm",children:"Lessons 11-22: Values, Resilience, Standards"})]}),(0,a.jsxs)("div",{className:"p-4 bg-courage/10 rounded-xl border border-courage/30",children:[a.jsx("h4",{className:"font-semibold text-courage mb-2",children:"Phase 3: Toolbelt"}),a.jsx("p",{className:"text-surface-400 text-sm",children:"Lessons 23-32: Strategy, Risk, Agency"})]}),(0,a.jsxs)("div",{className:"p-4 bg-community/10 rounded-xl border border-community/30",children:[a.jsx("h4",{className:"font-semibold text-community mb-2",children:"Phase 4: Blueprint"}),a.jsx("p",{className:"text-surface-400 text-sm",children:"Lessons 33-45: Leadership, Service, Legacy"})]})]})]}),(0,a.jsxs)("div",{className:"card p-6",children:[a.jsx("h3",{className:"font-semibold text-surface-100 mb-4",children:"About Leadership 2.0"}),a.jsx("p",{className:"text-surface-400 mb-4",children:"A research-backed leadership development platform that builds real skills through real action. Students develop executive function, resilience, and leadership capacity through daily practice."}),(0,a.jsxs)("p",{className:"text-surface-500 text-sm",children:[a.jsx("strong",{children:"Principle:"}),' "The 51/49 Rule" — Master yourself before leading others. Consistency over intensity. Deeds not words.']})]})]},"settings")}},284:(e,s,t)=>{"use strict";t.r(s),t.d(s,{createClient:()=>r});var a=t(6815);let i=null;function r(){if(i)return i;let e="https://apakkhzuydsfzvypewwa.supabase.co",s="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFwYWtraHp1eWRzZnp2eXBld3dhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg1MDEyODQsImV4cCI6MjA4NDA3NzI4NH0.c3hiZOEKMIXMP7aB0SVgrbQH58nwxseycVmeH23KsNQ";if(!e||!s)throw Error("Missing Supabase environment variables. Please ensure NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY are set.");return i=(0,a.createBrowserClient)(e,s)}},5394:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>l,metadata:()=>r});var a=t(9726);t(6010);let i=(0,t(3106).createProxy)(String.raw`/workspace/leadership-platform/src/app/error-boundary-wrapper.tsx#ErrorBoundaryWrapper`),r={title:"Leadership 2.0 | Build Real Skills Through Real Action",description:"A revolutionary leadership development platform for high school students",keywords:["leadership","education","skills","development","high school"],authors:[{name:"Leadership 2.0"}],viewport:"width=device-width, initial-scale=1, maximum-scale=1"};function l({children:e}){return a.jsx("html",{lang:"en",className:"dark",children:a.jsx("body",{className:"antialiased",children:a.jsx(i,{children:e})})})}},3117:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(3106).createProxy)(String.raw`/workspace/leadership-platform/src/app/teacher/page.tsx#default`)},6010:()=>{}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[469,645,805,279],()=>t(1508));module.exports=a})();